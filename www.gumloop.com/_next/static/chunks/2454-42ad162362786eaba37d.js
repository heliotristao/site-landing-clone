"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2454],{72130:function(e,r,n){n.d(r,{vP:function(){return H},hk:function(){return l},Zo:function(){return B},ZP:function(){return V}});var a,t,o,l,i=n(85893),s=n(50652),d=n(28059),c=n(48491),u=n(53985),p=n(94364),m=n(69696),x=n(67294),v=n(74598),h=n(41248),g=n(64712),f=n(44614),j=n(73587),_=n(45837),b=n(50855),y=n(56312),N=n(87536),w=n(13472),C=n(92437),E=n(29876),A=n(7161),I=n(49200),O=n(81687),T=n(20479),R=n(54178),k=n(18998);let D=w.z.object({exitReason:w.z.string().min(1).optional(),reasonDescription:w.z.string().optional()});(a=o||(o={})).LACK_OF_UNDERSTANDING="lack-of-understanding",a.MISSING_FEATURE="missing-feature",a.ERROR_ENCOUNTERED="error-encountered",a.OTHER="other";let P={"lack-of-understanding":{label:"I don't understand how to use it",moreDetailsLabel:"What do you need help with?"},"missing-feature":{label:"It's missing a feature I need",moreDetailsLabel:"What feature are you missing?"},"error-encountered":{label:"I ran into an error",moreDetailsLabel:"What error did you encounter?"},other:{label:"Other",moreDetailsLabel:"Describe your experience"}};var S=e=>{var r;let{open:n,onOpenChange:a,setReportGummieOpen:t,handleCleanupAndExit:o}=e,{userProfile:l}=(0,_.H)(),s=(0,h.v9)(c.P9),d=(0,h.v9)(c.d5),[u,p]=(0,R.P)({open:n,onOpenChange:a}),m=Object.entries(P).map(e=>{let[r,{label:n}]=e;return{label:n,value:r}}),v=(0,x.useCallback)(async e=>{if("error-encountered"===e.exitReason){t(!0);return}e.exitReason&&(0,b.rB)(j.z.CHAT_EXITED,{exit_reason:e.exitReason,reason_description:e.reasonDescription,interaction_id:null==s?void 0:s.id,user_id:null==l?void 0:l.user_id,gummie_mode:d}),o()},[null==s?void 0:s.id,d,null==l?void 0:l.user_id,o,t]),g=(0,N.cI)({resolver:(0,y.F)(D),defaultValues:{exitReason:"",reasonDescription:""},mode:"onChange",reValidateMode:"onChange"});return(0,i.jsx)(A.Vq,{open:u,onOpenChange:p,children:(0,i.jsx)(A.cZ,{children:(0,i.jsx)(I.l0,{...g,children:(0,i.jsxs)("form",{onSubmit:g.handleSubmit(v),children:[(0,i.jsxs)(A.a7,{children:[(0,i.jsxs)(A.fK,{children:[(0,i.jsx)(A.$N,{children:"Why are you leaving?"}),(0,i.jsx)(A.Be,{children:"Help us improve the experience by telling us why you're leaving."})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,i.jsx)(I.Wi,{control:g.control,name:"exitReason",render:e=>{let{field:r}=e;return(0,i.jsx)(I.xJ,{children:(0,i.jsx)(I.NI,{children:(0,i.jsx)(C.E,{className:"flex flex-col gap-2",onValueChange:r.onChange,value:r.value,children:m.map(e=>(0,i.jsxs)(O._,{className:(0,k.cn)("flex cursor-pointer items-center gap-2 rounded-lg border p-4","border-input","data-[state=checked]:border-accent-foreground data-[state=checked]:bg-accent"),children:[(0,i.jsx)(C.m,{value:e.value},e.value),(0,i.jsx)("span",{children:e.label})]},e.value))})})})}}),g.watch("exitReason")&&"error-encountered"!==g.watch("exitReason")&&(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)(O._,{className:"px-1.5",children:null==P?void 0:null===(r=P[g.watch("exitReason")])||void 0===r?void 0:r.moreDetailsLabel}),(0,i.jsx)(I.Wi,{control:g.control,name:"reasonDescription",render:e=>{let{field:r}=e;return(0,i.jsx)(I.xJ,{children:(0,i.jsx)(I.NI,{children:(0,i.jsx)(T.g,{...r,placeholder:"I am...",className:"field-sizing-content max-h-[200px]"})})})}})]})]})]}),(0,i.jsxs)(A.cN,{children:[(0,i.jsx)(E.zx,{variant:"outline",onClick:()=>p(!1),type:"button",children:"Cancel"}),(0,i.jsx)(E.zx,{type:"submit",children:"Continue"})]})]})})})})},z=n(98150),G=n(75290),L=n(83001);(t=l||(l={}))[t.EXIT=0]="EXIT",t[t.ARCHIVE=1]="ARCHIVE";let B=async e=>{let{operatorId:r,dispatch:n,userProfile:a,idToken:t,customOperators:o}=e,l=o.find(e=>e.operator_id===r);if(l){let e=g.Am.loading("Archiving node...");try{(await n((0,d.lA)({customOperator:l,userProfile:a,idToken:t}))).payload&&n((0,p.Qb)(l.operator_id)),g.Am.success("Node successfully archived",{id:e})}catch(r){console.error("Failed to archive node:",r),g.Am.error("Failed to archive node",{id:e})}}},Z=()=>{let e=(0,h.I0)(),r=(0,h.v9)(c.bc),n=(0,h.v9)(c.zd),a=(0,h.v9)(c.d5),t=(0,h.v9)(e=>(0,s.tY)(e)),{userProfile:o,idTokenRef:l}=(0,_.H)(),{abortCoreGummieCompletion:i}=(0,f.J)();return{cleanupMegaNode:async function(){let s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i();let d=null==n?void 0:n.operator_id;s&&n&&d&&await B({operatorId:d,dispatch:e,userProfile:o,idToken:l.current,customOperators:t}),e((0,c.nz)()),d&&((0,b.rB)(j.z.CHAT_EXITED,{chat_id:r,mode:a===u.Cn.AGENT?"pipeline_builder":"custom_operator_builder"}),e((0,m.IK)(d))),(0,L.WH)()},customOperator:n}},H=e=>{let{isOpen:r,setIsOpen:n,setGummieActive:a}=e,t=(0,h.v9)(c.P9),[o,l]=(0,x.useState)(!1),[s,d]=(0,x.useState)(!1),{cleanupMegaNode:u}=Z(),p=(0,x.useCallback)(async()=>{await u(!1),a(!1),l(!1)},[u,a,l]);return(0,i.jsxs)(x.Fragment,{children:[(0,i.jsx)(z.Z,{title:"Are you sure?",description:"Exiting Gummie mode will abort any changes you've made. Any unsaved progress will be lost. Do you want to continue?",confirmButtonProps:{text:"Exit Anyway",variant:"destructive-gradient"},onConfirm:p,open:r,setOpen:n,tertiaryButtonProps:{text:"Provide Feedback",variant:"ghost",onClick:()=>l(!0),Icon:v.Z}}),(0,i.jsx)(G.Z,{open:s,onOpenChange:d,chatMessages:(null==t?void 0:t.msgs)||[],onSuccess:()=>p()}),(0,i.jsx)(S,{open:o,onOpenChange:l,setReportGummieOpen:d,handleCleanupAndExit:p})]})},M=e=>{let{isOpen:r,setIsOpen:n,setGummieActive:a}=e,{cleanupMegaNode:t}=Z(),o=async()=>{await t(!0),a(!1)};return(0,i.jsx)(z.Z,{title:"Archive Node",description:"Are you sure you want to archive this node? This will permanently delete it from your library and remove it from the canvas.",confirmButtonProps:{text:"Archive",variant:"destructive-gradient"},onConfirm:o,open:r,setOpen:n})};var V=e=>{let{isOpen:r,setIsOpen:n,setGummieActive:a,mode:t=0}=e;return 1===t?(0,i.jsx)(M,{isOpen:r,setIsOpen:n,setGummieActive:a}):(0,i.jsx)(H,{isOpen:r,setIsOpen:n,setGummieActive:a})}},56696:function(e,r,n){var a=n(85893),t=n(67294),o=n(18998);let l=(0,t.forwardRef)((e,r)=>{let{children:n,colorShades:t,cssVariables:l,className:i}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("custom-node group/custom-node div-wrapper bg-elevated relative flex w-[500px] flex-col gap-2 rounded-2xl p-2 transition-transform duration-300 active:cursor-grabbing",i),style:{boxShadow:"\n            0 0px 0px 3px color-mix(in srgb, var(--node-color-light), transparent 60%),\n            0 2px 8px -0.5px color-mix(in srgb, var(--node-color-light), transparent 70%),\n            0 6px 16px -1.5px color-mix(in srgb, var(--node-color-light), transparent 80%),\n            0 12px 32px -3px color-mix(in srgb, var(--node-color-light), transparent 85%),\n            0 20px 50px -6px color-mix(in srgb, var(--node-color-light), transparent 90%),\n            0 40px 90px -12px color-mix(in srgb, var(--node-color-light), transparent 94%),\n            8px 0 32px 0 color-mix(in srgb, var(--node-color-light), transparent 83%),\n            -8px 0 32px 0 color-mix(in srgb, var(--node-color-light), transparent 83%)\n          ",outline:"2px solid color-mix(in srgb, var(--node-color-light), transparent 40%)",background:"\n          radial-gradient(\n            circle at 50% -50%,\n            ".concat(t.light," 0%,\n            var(--color-elevated) 80%\n          ),\n          var(--elevated)\n        "),...l},children:n})});l.displayName="CustomNodeBuilderContainer",r.Z=l},61632:function(e,r,n){var a=n(85893),t=n(48491),o=n(53985),l=n(22495),i=n(69696),s=n(67294),d=n(62190),c=n(25675),u=n.n(c),p=n(29876),m=n(5295),x=n(18998),v=n(72130);r.Z=e=>{var r,n,c,h,g;let{customOperator:f,customNodeData:j,customNodeId:_,colorShades:b,hasActiveCreation:y}=e,N=(0,l.CG)(t.$g),w=(0,l.CG)(t.d5),C=(0,l.TL)(),[E,A]=(0,s.useState)(!1),I=(0,s.useMemo)(()=>{var e,r;return(null==f?void 0:null===(e=f.operator_declaration)||void 0===e?void 0:e.short_description)||j.declaration.short_description||(null==f?void 0:null===(r=f.operator_declaration)||void 0===r?void 0:r.description)||j.declaration.description},[f,j]);return(0,a.jsxs)("div",{className:(0,x.cn)("group-wrapper relative flex flex-col gap-2 rounded-xl px-2 pt-3"),children:[(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2.5",children:[(0,a.jsx)("div",{className:"flex size-14 flex-none flex-col items-center justify-center rounded-lg",children:(0,a.jsx)("div",{className:"relative flex size-10 flex-none items-center justify-center",children:(0,a.jsx)(u(),{src:(null==f?void 0:null===(r=f.operator_declaration)||void 0===r?void 0:r.icon)?null==f?void 0:null===(n=f.operator_declaration)||void 0===n?void 0:n.icon:(0,m.F1)((null===(h=j.declaration)||void 0===h?void 0:null===(c=h.mcp_server_declaration)||void 0===c?void 0:c.category)||""),alt:j.name,fill:!0,className:"object-contain"})})}),(0,a.jsxs)("div",{className:"flex flex-grow flex-col pr-7",children:[(0,a.jsx)("p",{className:"text-foreground font-medium",children:(null==f?void 0:null===(g=f.operator_declaration)||void 0===g?void 0:g.name)||j.name}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:I})]})]}),(0,a.jsx)(p.zx,{variant:"ghost",size:"icon-sm",style:{color:b.light},className:"nodrag absolute top-3 right-3 !text-[var(--node-color-dark)] hover:!bg-[var(--node-color-medium)]/20",onClick:e=>{e.preventDefault(),w===o.Cn.AGENT&&N?C((0,i.IK)(_)):y?A(!0):(C((0,i.IK)(_)),C((0,t.ij)()),C((0,t.yg)(o.IG.IDLE)))},children:(0,a.jsx)(d.Z,{size:20})}),(0,a.jsx)(v.ZP,{isOpen:E,setIsOpen:A,setGummieActive:()=>C((0,t.ym)(!1)),mode:v.hk.EXIT})]})}},35510:function(e,r,n){var a=n(85893),t=n(48491),o=n(56109),l=n(41248),i=n(23040),s=n(22352),d=n(83001),c=n(18998),u=n(75111);let p=e=>{let{show:r}=e;return r?(0,a.jsxs)("p",{className:"text-muted-foreground flex flex-row items-center gap-2 p-1 text-xs font-medium",children:[(0,a.jsx)(o.Z,{className:"size-3 flex-none"})," Expects List"]}):null},m=e=>{let{name:r,dataType:n}=e;return n===d.Sg.BOOLEAN?null:(0,a.jsxs)("div",{className:"flex flex-row justify-between",children:[(0,a.jsx)("p",{className:"p-1 text-sm font-medium",children:r}),(0,a.jsx)(p,{show:n===d.Sg.STRING_ARRAY})]})},x=e=>{let{parameter:r,parameters:n}=e,t=(0,d.KQ)(r.data_type);return(0,a.jsxs)("div",{className:(0,c.cn)("pointer-events-none flex cursor-not-allowed",t===d.Sg.BOOLEAN?"flex-grow flex-row justify-between":"flex-col"),children:[(0,a.jsx)(m,{name:r.name,dataType:t}),(0,a.jsx)(s.C,{parameter:r,dataType:r.data_type,parameters:n,handleParameterChanges:()=>{},className:(0,c.cn)(t===d.Sg.BOOLEAN?"flex-grow flex-row-reverse justify-between":"flex-col")})]},r.name)},v=e=>{let{parameter:r,parameters:n,declarationData:t}=e,o=(0,d.KQ)(r.data_type),l=d.$T[o];return l?(0,a.jsxs)("div",{className:"pointer-events-none cursor-not-allowed",children:[(0,a.jsx)("p",{className:"p-1 text-sm font-medium",children:r.name}),(0,a.jsx)(l,{parameter:r,optionsParameterName:r.dynamic_options_parameter_key,dependencyParameterName:r.dynamic_options_parameter_dependents,parameters:n,id:"parameter-".concat(r.name),name:r.name,data:{declaration:null==t?void 0:t.operator_declaration,parameters:n},nodeData:{declaration:null==t?void 0:t.operator_declaration,parameters:n},declarationParameter:r,handleParameterChanges:()=>{},endpoint:i.U0.DYNAMIC_GUMCP_ATTRIBUTES,className:"w-full"})]}):null},h=e=>{let{parameter:r,parameters:n}=e,t=(0,d.KQ)(r.data_type);return(0,a.jsxs)("div",{className:"pointer-events-none cursor-not-allowed",children:[(0,a.jsx)(m,{name:r.name,dataType:t}),(0,a.jsx)(s.C,{parameter:r,dataType:r.data_type,parameters:n,handleParameterChanges:()=>{},className:(0,c.cn)("w-full",t===d.Sg.BOOLEAN?"flex-row-reverse justify-between":"")})]})};r.Z=e=>{var r,n,o;let{customOperator:i}=e,s=(0,l.v9)(t.S5),c=(null==i?void 0:null===(r=i.operator_declaration)||void 0===r?void 0:r.parameters)||[],p=(null==i?void 0:null===(n=i.operator_declaration)||void 0===n?void 0:n.inputs)||[],g=null==i?void 0:null===(o=i.operator_declaration)||void 0===o?void 0:o.required_environment_variables,f=(null==g?void 0:g.length)?{data_type:"EnvironmentVariablesPicker",description:"Map environment variables used by this node's code to your Gumloop variables/secrets.",name:"Environment variables to use",value:g.reduce((e,r)=>({...e,[r]:""}),{})}:void 0,j=[...c,{name:"credentials_to_use",value:s}],_=c.filter(e=>!!e.dynamic_options_parameter_key&&!e.is_hidden),b=c.filter(e=>!e.dynamic_options_parameter_key&&!e.is_hidden);return(0,a.jsxs)("div",{className:"flex !cursor-not-allowed flex-col gap-4 rounded-xl p-2 transition-all duration-300",children:[p.map(e=>(0,a.jsx)(x,{parameter:e,parameters:c},e.name)),[...b,..._].length>0&&(0,a.jsx)("hr",{className:"border-border"}),_.map(e=>(0,a.jsx)(v,{parameter:e,parameters:j,declarationData:i},e.name)),b.map(e=>(0,a.jsx)(h,{parameter:e,parameters:c},e.name)),f&&(0,a.jsxs)("div",{className:"pointer-events-none cursor-not-allowed",children:[(0,a.jsx)(m,{name:f.name,dataType:d.Sg.ENVIRONMENT_VARIABLES}),(0,a.jsx)(u.bH,{parameter:f,declaration:i.operator_declaration,declarationParameter:f,handleParameterChanges:()=>{},isDisabled:!0})]})]})}}}]);