"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9345],{19345:function(e,t,l){var s=l(85893),n=l(53985),a=l(88953),r=l(67294),i=l(42171),c=l(33058),u=l(89427),o=l(13114),m=l(29876),d=l(42414),x=l(41584),f=l(51750),h=l(13785),p=l(8597),g=l(18998);let v=e=>{if(!e)return"";let t=new Date(e),l=new Date;return t.toDateString()===l.toDateString()?t.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}):t.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0})},j=e=>{let{content:t,speed:l,onComplete:n,isActive:a}=e,[i,c]=(0,r.useState)(""),u=(0,r.useRef)(0),o=(0,r.useRef)(null);return(0,r.useEffect)(()=>{if(!a){c(t);return}u.current=0,c("");let e=1e3/l;return o.current=setInterval(()=>{u.current<t.length?(c(t.slice(0,u.current+1)),u.current+=1):(o.current&&clearInterval(o.current),n())},e),()=>{o.current&&clearInterval(o.current)}},[t,l,a,n]),(0,s.jsx)(h.Z,{content:i})},N=e=>{var t;let{message:l,prevMessageRole:i,assistantMessageProps:c,typewriterSpeed:o,onTypingComplete:m,onPartComplete:d}=e,x=i===n.lB.ASSISTANT,h=(0,r.useRef)(!1),[p,N]=(0,r.useState)(-1),S=(0,r.useRef)(null),y=(0,r.useMemo)(()=>l.parts||[],[l.parts]),T=(0,r.useCallback)(e=>{let t=e+1;if(d(),t>=y.length)h.current||(h.current=!0,null==m||m());else{N(e);let l=y[t];l&&l.type!==a.S.TEXT&&(S.current=setTimeout(()=>{T(t)},300))}},[y,m,d]);(0,r.useEffect)(()=>(h.current=!1,N(-1),y.length>0?y[0].type!==a.S.TEXT&&(S.current=setTimeout(()=>{T(0)},300)):h.current||(h.current=!0,null==m||m()),()=>{S.current&&clearTimeout(S.current)}),[l.id,y,T,m]);let w=(0,r.useMemo)(()=>y.map((e,t)=>()=>{T(t)}),[y,T]);return(0,s.jsx)(u.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,ease:"easeOut"},className:(0,g.cn)("group/assistant-message flex w-full flex-col gap-2",x&&"-mt-3 mb-1"),children:(0,s.jsx)("div",{className:"group flex w-full flex-grow flex-col transition-all ease-in-out",children:(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[!x&&(0,s.jsx)("div",{className:"-mb-2 flex items-center gap-2",children:(0,s.jsxs)("div",{className:"flex flex-grow items-baseline gap-2 transition-all ease-in-out",children:[(0,s.jsx)("span",{className:"text-muted-foreground text-sm font-medium",children:(null==c?void 0:null===(t=c.avatar)||void 0===t?void 0:t.name)||"Gummie"}),(0,s.jsx)("span",{className:"text-muted-foreground text-xs opacity-0 transition-all duration-300 ease-in-out group-hover:opacity-100",children:v(null==l?void 0:l.timestamp)})]})}),y.map((e,t)=>t<=p+1?e.type===a.S.TEXT&&e.text?(0,s.jsx)(j,{content:e.text,speed:o,isActive:t===p+1,onComplete:w[t]},e.id):e.type===a.S.TOOL_INVOCATION?(0,s.jsx)(f.Z,{part:e,message:l,isMostRecentMessage:!1,gummieMode:n.Cn.CUSTOM_GUMMIE,hideToolResult:!0},e.id):null:null)]})})})};t.Z=e=>{let{className:t,chat:l,userMessageProps:a,assistantMessageProps:f,typewriterSpeed:h=250,messageDelay:v=250,agentName:j="Agent",additionalActions:S}=e,[y,T]=(0,r.useState)(-1),[w,b]=(0,r.useState)(!1),[M,C]=(0,r.useState)(!1),E=(0,r.useRef)(null),k=(0,r.useRef)(y);(0,r.useEffect)(()=>{k.current=y},[y]);let{contentRef:R,scrollRef:I,scrollToBottom:A,isAtBottom:O}=(0,p.W)({resize:"instant"}),[z,_]=(0,r.useState)(0),U=(0,r.useCallback)(()=>{_(e=>e+1)},[]);(0,r.useEffect)(()=>{y>=0&&O&&A()},[y,w,z,O,A]);let Z=(0,r.useMemo)(()=>l.slice(0,y+1),[l,y]),B=(0,r.useCallback)(()=>{let e=k.current+1;if(e>=l.length){C(!0);return}T(e),k.current=e,l[e].role===n.lB.ASSISTANT?b(!0):E.current=setTimeout(()=>{B()},v)},[l,v]),D=(0,r.useCallback)(()=>{b(!1),E.current=setTimeout(()=>{B()},v)},[v,B]);(0,r.useEffect)(()=>{-1!==y||M||B()},[y,M,B]),(0,r.useEffect)(()=>()=>{E.current&&clearTimeout(E.current)},[]);let L=()=>{E.current&&clearTimeout(E.current),T(-1),k.current=-1,b(!1),C(!1),E.current=setTimeout(()=>{var e;T(0),k.current=0,(null===(e=l[0])||void 0===e?void 0:e.role)===n.lB.ASSISTANT&&b(!0)},100)},G=()=>{E.current&&clearTimeout(E.current),T(l.length-1),b(!1),C(!0)};return 0===l.length?(0,s.jsx)("div",{className:(0,g.cn)("flex h-full items-center justify-center",t),children:(0,s.jsx)("p",{className:"text-muted-foreground text-sm",children:"No messages to replay"})}):(0,s.jsxs)("div",{className:"relative flex h-full w-full flex-col",children:[(0,s.jsx)("div",{ref:I,className:"relative min-h-0 flex-1 overflow-x-hidden overflow-y-auto overscroll-y-contain",children:(0,s.jsx)("div",{className:"relative mx-auto flex max-w-3xl flex-col",children:(0,s.jsxs)("div",{className:"mx-auto flex w-full flex-col gap-4 overflow-x-hidden px-4 pt-8 lg:overflow-visible",ref:R,children:[(0,s.jsx)(o.M,{mode:"popLayout",children:Z.map((e,t)=>{let l=t>0?Z[t-1]:void 0,r=null==l?void 0:l.role,i=t===Z.length-1;return i&&w&&e.role===n.lB.ASSISTANT?(0,s.jsx)(u.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,ease:"easeOut"},className:"flex h-max w-full justify-start gap-2",children:(0,s.jsx)(N,{message:e,prevMessageRole:r,assistantMessageProps:f,typewriterSpeed:h,onTypingComplete:D,onPartComplete:U})},e.id):(0,s.jsx)(u.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,ease:"easeOut"},children:(0,s.jsx)(x.Z,{message:e,prevMessageRole:null!=r?r:n.lB.USER,isMostRecentMessage:i,userMessageProps:a,assistantMessageProps:f,gummieMode:n.Cn.CUSTOM_GUMMIE,gummieStatus:n.IG.IDLE,hideToolResult:!0})},e.id)})}),(0,s.jsx)("div",{className:"h-0 flex-none"})]})})}),(0,s.jsxs)("div",{className:"relative w-full shrink-0",children:[!O&&(0,s.jsx)("div",{className:"from-background/80 pointer-events-none absolute inset-x-0 -top-4 h-4 bg-gradient-to-t to-transparent"}),(0,s.jsxs)("div",{className:"mx-auto max-w-3xl",children:[!O&&Z.length>1&&(0,s.jsx)("div",{className:"absolute -top-12 left-1/2 z-10 -translate-x-1/2",children:(0,s.jsxs)(d.u,{children:[(0,s.jsx)(d.aJ,{asChild:!0,children:(0,s.jsx)(m.zx,{variant:"outline",size:"icon",className:"button-bounce shadow-floating border-none",onClick:()=>A(),children:(0,s.jsx)(i.Z,{size:20})})}),(0,s.jsx)(d._v,{children:"Scroll to bottom"})]})}),(0,s.jsxs)("div",{className:"mx-auto flex w-full flex-col gap-3 p-4",children:[(0,s.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Z,{size:18,className:"text-foreground"}),(0,s.jsx)("span",{className:"text-foreground text-sm",children:M?"".concat(j," chat replay completed."):"Replaying ".concat(j," chat...")})]}),(0,s.jsxs)("div",{className:"hidden items-center gap-2 md:flex",children:[(0,s.jsx)(m.zx,{variant:"outline",onClick:M?L:G,children:M?"Watch again":"Skip to end"}),S]})]}),(0,s.jsxs)("div",{className:"flex w-full flex-col gap-2 md:hidden",children:[(0,s.jsx)(m.zx,{variant:"outline",className:"w-full",onClick:M?L:G,children:M?"Watch again":"Skip to end"}),S&&(0,s.jsx)("div",{className:"w-full [&>*]:w-full",children:S})]})]})]})]}),(0,s.jsx)("style",{children:".button-bounce {\n          animation: bounce 1s ease-in-out infinite;\n        }\n        \n        @keyframes bounce {\n          0%, 100% { transform: translateY(0); }\n          50% { transform: translateY(-3px); }\n        }\n        "})]})}}}]);