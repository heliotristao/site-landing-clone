"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1693],{93495:function(e,i,r){var a=r(85893),o=r(67294),n=r(18998);i.Z=e=>{let{videoSrc:i,title:r,className:s,...t}=e,l=(0,o.useMemo)(()=>i&&i.includes("player.vimeo.com"),[i]);return(0,a.jsx)("div",{className:(0,n.cn)("aspect-video w-full overflow-hidden",s),...t,children:l?(0,a.jsx)("iframe",{src:i,className:"h-full w-full rounded-none",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:r}):(0,a.jsx)("video",{controls:!0,className:"h-full w-full object-cover",src:i,autoPlay:!0})})}},46858:function(e,i,r){r.d(i,{Z:function(){return _}});var a=r(85893),o=r(67294),n=r(78551),s=r(7161),t=r(97387),l=r(54178),d=r(97257),c=r(64712),u=r(81687),m=r(30671);let h=(0,o.memo)(e=>{let{customOperator:i,userProfile:r,idToken:n,isSharedWithOrganization:s,isSharedWithProject:t,organizationRole:l,projectRole:h,sharedProject:v,refetchAccessData:g,isLoading:f}=e,{currentProject:_}=(0,d.d2)(),[p,w]=(0,o.useState)(!1),[x,j]=(0,o.useState)(!1),[y,S]=(0,o.useState)(!1),[A,z]=(0,o.useState)(!1),N="editor"===h||(null==v?void 0:v.role)==="editor";v&&(v.project_id,null==_||_.project_id);let k=async e=>{if(!i)return;w(!0);let a=c.Am.loading(e?"Sharing with organization...":"Unsharing with organization...");try{var o,s,t,l;e?await i.add_shared_organization(r,null!==(s=null===(o=r.organization)||void 0===o?void 0:o.organization_id)&&void 0!==s?s:"",n,"viewer"):await i.remove_shared_organization(r,null!==(l=null===(t=r.organization)||void 0===t?void 0:t.organization_id)&&void 0!==l?l:"",n),c.Am.success(e?"Shared with organization":"Stopped sharing with organization",{id:a})}catch(e){c.Am.error("".concat(e instanceof Error?e.message:String(e)),{id:a})}finally{w(!1),g()}},b=async e=>{if(!i||!s)return;j(!0);let a=c.Am.loading(e?"Granting edit access...":"Removing edit access...");try{var o,t;await i.add_shared_organization(r,null!==(t=null===(o=r.organization)||void 0===o?void 0:o.organization_id)&&void 0!==t?t:"",n,e?"editor":"viewer"),c.Am.success(e?"Organization can now edit":"Organization can now only view",{id:a})}catch(e){c.Am.error("".concat(e instanceof Error?e.message:String(e)),{id:a})}finally{j(!1),g()}},C=async e=>{if(!i||!_)return;S(!0);let a=c.Am.loading(e?"Sharing with workspace...":"Unsharing with workspace...");try{e?await i.add_shared_project(r,_.project_id,n,"viewer"):await i.remove_shared_project(r,_.project_id,n),c.Am.success(e?"Shared with workspace":"Stopped sharing with workspace",{id:a})}catch(e){c.Am.error("".concat(e instanceof Error?e.message:String(e)),{id:a})}finally{S(!1),g()}},E=async e=>{if(!i)return;let a=(null==_?void 0:_.project_id)||(null==v?void 0:v.project_id);if(!a)return;z(!0);let o=c.Am.loading(e?"Granting edit access...":"Removing edit access...");try{await i.add_shared_project(r,a,n,e?"editor":"viewer"),c.Am.success(e?"Workspace can now edit":"Workspace can now only view",{id:o})}catch(e){c.Am.error("".concat(e instanceof Error?e.message:String(e)),{id:o})}finally{z(!1),g()}},M=p||x||y||A||f;return(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[_&&(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)(u._,{className:"text-muted-foreground",children:"Workspace"}),(0,a.jsxs)(u._,{className:"flex flex-row items-center gap-2",children:[(0,a.jsxs)("span",{className:"flex-1 truncate text-sm font-normal",children:["Share this custom node with ",_.name,"?"]}),(0,a.jsx)(m.r,{disabled:M,checked:t,onCheckedChange:C})]}),t&&(0,a.jsxs)(u._,{className:"flex flex-row items-center gap-2",children:[(0,a.jsx)("span",{className:"flex-1 truncate text-sm font-normal",children:"Allow workspace members to edit this custom node?"}),(0,a.jsx)(m.r,{disabled:M,checked:N,onCheckedChange:E})]})]}),r.organization&&(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)(u._,{className:"text-muted-foreground",children:"Organization"}),(0,a.jsxs)(u._,{className:"flex flex-row items-center gap-2",children:[(0,a.jsxs)("span",{className:"flex-1 truncate text-sm font-normal",children:["Share this custom node with ",r.organization.name,"?"]}),(0,a.jsx)(m.r,{disabled:M,checked:s,onCheckedChange:k})]}),s&&(0,a.jsxs)(u._,{className:"flex flex-row items-center gap-2",children:[(0,a.jsx)("span",{className:"flex-1 truncate text-sm font-normal",children:"Allow organization members to edit this custom node?"}),(0,a.jsx)(m.r,{disabled:M,checked:"editor"===l,onCheckedChange:b})]})]})]})});h.displayName="CustomNodeAccessManager";var v=r(30202),g=r(58067);let f=(0,o.memo)(e=>{var i,r;let{sharedUsers:n,setSharedUsers:s,searchableItemsLoading:t,customOperator:l,userProfile:d,idToken:m}=e,[h,f]=(0,o.useState)(!1),[_,p]=(0,o.useState)(!1),[w,x]=(0,o.useState)(""),[j,y]=(0,o.useState)(null),S=(0,v.NL)(),A=(0,o.useMemo)(()=>{var e,i,r;return null!==(r=null==d?void 0:null===(i=d.organization)||void 0===i?void 0:null===(e=i.members)||void 0===e?void 0:e.map(e=>{var i,r;return e.user_email===d.user_email?null:{value:null!==(i=e.user_email)&&void 0!==i?i:"",label:null!==(r=e.user_email)&&void 0!==r?r:""}}).filter(e=>null!==e))&&void 0!==r?r:[]},[null===(i=d.organization)||void 0===i?void 0:i.members,d.user_email]),z=(0,o.useMemo)(()=>l.creator_user_id===d.user_id,[l.creator_user_id,d.user_id]);return(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsxs)(u._,{className:"text-muted-foreground",children:["Users â€¢ ",null!==(r=null==n?void 0:n.length)&&void 0!==r?r:0]}),(0,a.jsx)(g.Z,{searchableItems:A,searchableItemsLoading:t,onConfirm:{label:"Share",action:async e=>{let i=c.Am.loading("Adding user...");f(!0);try{await l.add_shared_user(d,e,m,"viewer"),x(""),y(null),s([{user_email:e,role:"viewer"},...n]),c.Am.success("User added",{id:i}),S.invalidateQueries({queryKey:["custom-node-share-dialog",l.operator_id]})}catch(e){c.Am.error("".concat(e instanceof Error?e.message:String(e)),{id:i})}finally{f(!1)}},loading:h},entities:n.map(e=>{var i,r;return{id:null!==(i=e.user_email)&&void 0!==i?i:"",name:null!==(r=e.user_email)&&void 0!==r?r:""}}),selectedValue:j,onSelectedValueChange:y,showEntityActions:e=>{let i=e.name===d.user_email||z,r=e.name!==l.creator_user_email;return i&&r},entityActions:[{label:"Make a Viewer",description:"Allow this user to view this custom node",action:async e=>{if(!l)return;let i=c.Am.loading("Making ".concat(e," a viewer..."));p(!0);try{await l.add_shared_user(d,e,m,"viewer"),c.Am.success("Successfully made ".concat(e," a viewer"),{id:i}),s(i=>i.map(i=>i.user_email===e?{...i,role:"viewer"}:i))}catch(e){c.Am.error("".concat(e instanceof Error?e.message:String(e)),{id:i})}finally{p(!1),S.invalidateQueries({queryKey:["custom-node-share-dialog",l.operator_id]})}},loading:_,disabled:_,condition:e=>{var i;return(null===(i=n.find(i=>i.user_email===e))||void 0===i?void 0:i.role)==="editor"&&z},destructive:!1},{label:"Make an Editor",description:"Allow this user to edit this custom node, creating a new version",action:async e=>{if(!l)return;let i=c.Am.loading("Making ".concat(e," an editor..."));p(!0);try{await l.add_shared_user(d,e,m,"editor"),c.Am.success("Successfully made ".concat(e," an editor"),{id:i}),s(i=>i.map(i=>i.user_email===e?{...i,role:"editor"}:i))}catch(e){c.Am.error("".concat(e instanceof Error?e.message:String(e)),{id:i})}finally{p(!1),S.invalidateQueries({queryKey:["custom-node-share-dialog",l.operator_id]})}},loading:_,disabled:_,condition:e=>{var i;return(null===(i=n.find(i=>i.user_email===e))||void 0===i?void 0:i.role)==="viewer"&&z},destructive:!1},{label:"Remove",description:e=>e.name===d.user_email?"Remove yourself from the custom node":"Don't allow this user to access this custom node",action:async e=>{if(!l)return;let i=c.Am.loading("Removing ".concat(e,"..."));if(p(!0),n.find(i=>i.user_email===e))try{await l.remove_shared_user(d,e,m),s(i=>i.filter(i=>i.user_email!==e)),c.Am.success("Successfully removed ".concat(e),{id:i})}catch(e){c.Am.error("".concat(e instanceof Error?e.message:String(e)),{id:i})}finally{p(!1),S.invalidateQueries({queryKey:["custom-node-share-dialog",l.operator_id]})}else c.Am.error("".concat(e," is not a shared user!"))},disabled:_,loading:_,destructive:!0}],searchValue:w,onSearchValueChange:x,placeholder:"Share with a user",requireSelection:!1})]})});f.displayName="CustomNodeUserAccessManager";var _=e=>{var i,r;let{customOperator:c,open:u,onOpenChange:m,userProfile:v,idToken:g}=e,[_,p]=(0,l.P)({open:u,onOpenChange:m}),[w,x]=(0,o.useState)([]),{data:j,isLoading:y,refetch:S,isRefetching:A}=(0,n.a)({queryKey:["custom-node-share-dialog",c.operator_id],queryFn:()=>c.fetch_access(v,g),enabled:_});(0,o.useEffect)(()=>{(null==j?void 0:j.users)&&x(j.users)},[null==j?void 0:j.users]);let{currentProject:z}=(0,d.d2)(),N=(0,o.useMemo)(()=>{var e,i;if(!(null===(e=v.organization)||void 0===e?void 0:e.organization_id))return{isShared:!1,role:void 0};let r=null==j?void 0:null===(i=j.organizations)||void 0===i?void 0:i.find(e=>{var i;return e.organization_id===(null===(i=v.organization)||void 0===i?void 0:i.organization_id)});return{isShared:!!r,role:null==r?void 0:r.role}},[null==j?void 0:j.organizations,null===(i=v.organization)||void 0===i?void 0:i.organization_id]),k=(0,o.useMemo)(()=>{var e;if(!(null==z?void 0:z.project_id))return{isShared:!1,role:void 0};let i=null==j?void 0:null===(e=j.projects)||void 0===e?void 0:e.find(e=>e.project_id===z.project_id);return{isShared:!!i,role:null==i?void 0:i.role}},[null==j?void 0:j.projects,null==z?void 0:z.project_id]);return(0,a.jsx)(s.Vq,{open:_,onOpenChange:p,children:(0,a.jsx)(s.cZ,{children:(0,a.jsxs)(s.a7,{children:[(0,a.jsxs)(s.fK,{children:[(0,a.jsx)(s.$N,{children:"Share This Custom Node"}),(0,a.jsx)(s.Be,{children:"Sharing this custom node will allow other users to use it in their flows and create copies."})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,a.jsx)(f,{sharedUsers:w,setSharedUsers:x,searchableItemsLoading:y||!j,customOperator:c,userProfile:v,idToken:g}),((null==v?void 0:v.organization)||z)&&(!y||j)&&(0,a.jsxs)(o.Fragment,{children:[(0,a.jsx)(t.Z,{}),(0,a.jsx)(h,{customOperator:c,userProfile:v,idToken:g,isSharedWithOrganization:N.isShared,isSharedWithProject:k.isShared,organizationRole:N.role,projectRole:k.role,sharedProject:null==j?void 0:null===(r=j.projects)||void 0===r?void 0:r[0],refetchAccessData:S,isLoading:(y||A)&&!j})]})]})]})})})}},358:function(e,i,r){r.d(i,{o:function(){return n}});var a=r(78551),o=r(90273);function n(e,i,r,n){return(0,a.a)({queryKey:["can-edit-custom-operator",e],enabled:!!(e&&(null==i?void 0:i.isLoggedIn())),queryFn:async()=>e?await (0,o.eN)("custom_operator/".concat(e,"/can_edit"),i,r,"GET"):{can_edit:!1},staleTime:3e5,...n})}}}]);