"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{20026:function(e,t,l){l.d(t,{Z:function(){return tO}});var s,n,r,i,a=l(85893),o=l(48491),d=l(22495),c=l(67294),u=l(34849),m=l(53985),x=l(69245),h=l(56312),p=l(87536),v=l(50855),f=l(13472);(s=r||(r={})).Solo="Solo",s.Team="Team";let g=f.z.object({firstName:f.z.string().min(1),lastName:f.z.string(),profilePicture:f.z.any().optional(),timezone:f.z.string().optional()}),j=e=>{if(!e)return e;let t=e.trim();if(!t)return t;if(!/[./:]/.test(t))return"https://www.linkedin.com/in/".concat(t);if(/^\/in\//i.test(t))return"https://www.linkedin.com".concat(t.replace(/[?#].*$/,"").replace(/\/+$/,""));let l=/^https?:\/\//i.test(t)?t:"https://".concat(t);try{let e=new URL(l);if(/^(www\.)?linkedin\.com$/i.test(e.hostname)){let t=e.pathname.replace(/\/+$/,"");return"https://www.linkedin.com".concat(t)}}catch(e){}return l},b=f.z.object({linkedinUrl:f.z.string().transform(j).pipe(f.z.string().url("Please enter a valid LinkedIn profile URL (e.g. linkedin.com/in/yourprofile)").or(f.z.literal(""))).optional()});(n=i||(i={})).UserProfileDetails="User Profile Details",n.RoleSelection="Role Selection",n.IntegrationsSelection="Integrations Selection",n.SoloOrTeamSelection="Solo Or Team Selection",n.StartTeamTrial="Start Team Trial",n.InviteTeamMembers="Invite Team Members",n.RepetitiveOrAdhocTasks="Repetitive Or Adhoc Tasks",n.WorkflowCreationOverview="Workflow Creation Overview",n.WorkflowCreation="Workflow Creation",n.AgentCreationOverview="Agent Creation Overview",n.AgentCreation="Agent Creation",n.LinkedIn="LinkedIn",n.DemoComplete="Demo Complete";var N=l(49200),y=l(64127),C=e=>{let{form:t}=e;return(0,a.jsx)(c.Fragment,{children:(0,a.jsx)(N.l0,{...t,children:(0,a.jsx)("form",{onSubmit:e=>e.preventDefault(),children:(0,a.jsx)("div",{className:"flex flex-col gap-5",children:(0,a.jsx)(N.Wi,{control:t.control,name:"linkedinUrl",render:e=>{let{field:t}=e;return(0,a.jsxs)(N.xJ,{children:[(0,a.jsx)(N.lX,{children:"LinkedIn Profile URL"}),(0,a.jsx)(N.NI,{children:(0,a.jsx)(y.I,{placeholder:"https://linkedin.com/in/yourprofile",...t})}),(0,a.jsx)(N.zG,{})]})}})})})})})},_=l(54348),w=l(92437),S=l(11158);let k=e=>{let{option:t,selectedRole:l}=e;return(0,a.jsxs)("label",{htmlFor:t.title,className:"group/role-selection-item flex cursor-pointer items-center gap-2 rounded-md border p-2 pr-4",style:(0,S.BP)(t.title),"data-checked":l===t.title,children:[(0,a.jsx)("div",{className:"grid size-6 shrink-0 place-items-center rounded-md bg-[var(--department-color-dark)]",children:(0,a.jsx)(t.Icon,{className:"dark:text-background size-4 shrink-0 stroke-[1.5] text-[var(--department-color-light)]"})}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm font-medium",children:t.title})}),(0,a.jsx)(w.m,{value:t.title,id:t.title,className:"ml-auto"},t.title)]},t.title)};var I=e=>{let{onSelect:t,selectedRole:l}=e;return(0,a.jsx)(w.E,{className:"gap-1.5",value:l,onValueChange:e=>{t(e)},children:S.So.map(e=>(0,a.jsx)(k,{option:e,selectedRole:l},e.title))})},E=l(53071),O=l(7526),T=l(44614),M=l(82141),R=l(45837),L=l(14625),A=l(194);let G=async(e,t,l,s,n,r,i,a)=>{let o=new A.S;return(0,L.L)(e,async n=>(0,O.a8)(l,t,s,e,n,r,i),o,n,l,a)},z=()=>{let{userProfile:e,idTokenRef:t,refreshIdToken:l}=(0,R.H)(),s=(0,d.CG)(o.bc),n=(0,d.CG)(M.gf),r=(0,d.TL)(),i=(0,T.J)();return{triggerOnboardingDemo:(0,c.useCallback)(async a=>{let d=(0,E.EQ)({content:JSON.stringify(a),role:m.lB.HIDDEN_USER});r((0,o.n3)(d)),i.startCoreGummieCompletion();try{let o=u.Z.getState().gummie.core.chat.msgs,d={interaction_id:s,gummie_id:null!=n?n:void 0,messages:o,onboarding_user_details:{name:a.name,email:a.email,role:a.role,linkedin_url:a.linkedinUrl}};await G(r,e,d,t,{operatorDeclarations:[],dispatch:r,userProfile:e,idTokenRef:t,personalSecretTypes:[],continuationRef:{current:null},chatId:s},i.getTurnstileToken,l)}catch(e){console.error("[triggerOnboardingDemo] Error:",e),r((0,o.yg)(m.IG.ERROR))}},[r,e,s,n,t,l,i])}};var P=l(821),Z=l(8232),D=l(99577),U=l(23430),F=l(14009),V=l(32025),B=l(11926),H=l(14212);let W=e=>(0,E.EQ)({..."string"==typeof e?{content:e}:e,role:m.lB.ASSISTANT}),J=(0,c.createContext)(null),Y=()=>{let e=(0,c.useContext)(J);if(!e)throw Error("useOnboardingContext must be used within a OnboardingProvider");return e},K=e=>{var t;let{children:l}=e,[s,n]=(0,c.useState)(0),r=(0,U.Z)(),{onProfileUpdate:d}=(0,D.Z)(),{userProfile:f,idTokenRef:N}=(0,R.H)(),{addCoreGummieMessage:y}=(0,T.J)(),[w,S]=(0,Z.Z)(r),k=(0,c.useRef)(!1),M=(0,c.useRef)(new Set),[L,A]=(0,c.useState)(!1),{triggerOnboardingDemo:G}=z(),[Y,K]=(0,c.useState)(!1),{mutate:$}=(0,F.Z)();(0,x.Y)({userProfile:f,idToken:null!==(t=N.current)&&void 0!==t?t:void 0},{skip:null==f?void 0:f.isLoading()});let q=(0,c.useMemo)(()=>({firstName:(null==f?void 0:f.first_name)||"",lastName:(null==f?void 0:f.last_name)||"",profilePicture:(null==f?void 0:f.profile_picture)||void 0}),[f]),Q=(0,p.cI)({resolver:(0,h.F)(g),defaultValues:q,mode:"onSubmit",reValidateMode:"onSubmit"});(0,c.useEffect)(()=>{f&&Q.reset(q)},[f,Q,q]);let X=(0,p.cI)({resolver:(0,h.F)(b),defaultValues:{linkedinUrl:""},mode:"onChange",reValidateMode:"onChange"}),ee=(0,P.QH)({path:"/survey_response"}),et=(0,c.useCallback)(async()=>{(0,V.u)(B.Z.ONBOARDING_COMPLETED,{user_email:f.user_email,first_name:f.first_name,last_name:f.last_name},{selectedRole:w,tags:["marketing","activation"]}),u.Z.dispatch((0,o.pj)({mode:m.Cn.GENERAL,resetChat:!1})),document.body.removeAttribute("data-onboarding");let e=u.Z.getState().gummie.core.chat.id,t="/chat/".concat(e);window.history.replaceState({...window.history.state,as:t,url:t},"",t)},[w,f]),el=(0,c.useMemo)(()=>[{id:i.UserProfileDetails,assistantMessage:"First, tell me a bit about yourself.",getUserMessage:()=>{let{firstName:e,lastName:t}=Q.getValues();return"My name is ".concat(e," ").concat(t)},title:"Tell us about yourself",description:"We want to get to know you better.",content:(0,a.jsx)(_.Z,{form:Q}),onSubmit:async()=>{let e=Q.getValues();Q.formState.isValid&&await d(e),(null==e?void 0:e.profilePicture)&&(0,v.rB)(B.Z.UPDATED_PROFILE_PICTURE),(0,v.rB)(B.Z.PROFILE_DETAILS_ADDED)},validation:()=>Q.formState.isValid},{id:i.LinkedIn,assistantMessage:"Perfect! Can you give me your LinkedIn profile url?<br/><br/>\uD83E\uDE84 I'd love to personalize your experience and also show you some of the magic of Gumloop.",getUserMessage:()=>{let e=X.getValues().linkedinUrl;return e?"My LinkedIn is ".concat(j(e)):""},isSkippable:!0,skipButtonText:"Skip",onSkip:()=>X.reset(),content:(0,a.jsx)(C,{form:X}),validation:()=>!!X.watch("linkedinUrl")&&X.formState.isValid,onSubmit:async()=>{let e=X.getValues().linkedinUrl;e&&await $.mutate(H.m.LINKEDIN_URL,j(e))}},{id:i.RoleSelection,assistantMessage:"What's your role?",getUserMessage:()=>"My role is ".concat(w),shouldSkip:()=>!k.current,title:"What's your role?",description:"We want to get to know you better.",content:(0,a.jsx)(I,{onSelect:S,selectedRole:w}),onSubmit:async()=>{(0,v.rB)(B.Z.ROLE_SELECTION_COMPLETED,{role:w})}},{id:i.DemoComplete,assistantMessage:"",content:null,onSubmit:et}],[Q,X,w,S,d,$,et]),es=(0,c.useMemo)(()=>el[s],[s,el]),en=(0,c.useMemo)(()=>s>0,[s]),er=(0,c.useMemo)(()=>s<el.length-1,[s,el]),ei=(0,c.useCallback)(async()=>{var e;A(!0);let t=X.getValues().linkedinUrl,l=t?j(t):void 0,{firstName:s,lastName:n}=Q.getValues();await G({name:"".concat(s," ").concat(n),email:null!==(e=f.user_email)&&void 0!==e?e:"",role:w,linkedinUrl:l}),A(!1)},[G,X,Q,f,w]),ea=(0,c.useCallback)(()=>{let e=u.Z.getState().gummie.core.chat.id;try{(0,O.FB)(m.kr.MANUAL,e)}catch(e){console.error("[onboarding] abort failed:",e)}et()},[et]),eo=(0,c.useCallback)(async()=>{var e,t;let l=s+1;for(;l<el.length&&(null===(e=(t=el[l]).shouldSkip)||void 0===e?void 0:e.call(t));)M.current.add(el[l].id),l++;if(l<el.length){let e=el[l];e.id===i.DemoComplete?await ei():y(W(e.assistantMessage)),n(l)}},[s,el,y,ei]),ed=(0,c.useCallback)(async()=>{var e,t;K(!0),k.current=!1,es.getUserMessage&&y((0,E.EQ)({content:es.getUserMessage(),role:m.lB.USER})),null===(t=es.onSubmit)||void 0===t||null===(e=t.call(es))||void 0===e||e.catch(e=>{console.error("[onboarding] step onSubmit failed:",e)}),await eo(),K(!1)},[es,y,eo]),ec=(0,c.useCallback)(async()=>{var e,t;es.isSkippable&&(K(!0),k.current=!0,M.current.add(es.id),null===(t=es.onSkip)||void 0===t||null===(e=t.call(es))||void 0===e||e.catch(e=>{console.error("[onboarding] step onSkip failed:",e)}),await eo(),K(!1))},[es,eo]),eu=(0,c.useCallback)(()=>{if(en){var e;null===(e=es.onPrevious)||void 0===e||e.call(es),n(s-1)}},[en,es,s]),em=el.filter((e,t)=>{var l;return!(M.current.has(e.id)||t>s&&(null===(l=e.shouldSkip)||void 0===l?void 0:l.call(e)))}),ex=em.findIndex(e=>e.id===es.id),eh=em.length,ep=Y||ee.isPending,ev=(0,c.useMemo)(()=>({stepIndex:s,displayStepIndex:ex,onboardingSteps:el,currentStep:es,hasPreviousStep:en,hasNextStep:er,handleNext:ed,handleSkip:ec,handlePrevious:eu,handleSkipDemo:ea,isDemoRunning:L,isLoading:ep,totalSteps:eh}),[s,ex,el,es,en,er,ed,ec,eu,ea,L,ep,eh]);return(0,a.jsx)(J.Provider,{value:ev,children:l})};var $=l(18998),q=l(35577),Q=()=>(0,a.jsxs)("div",{className:"flex w-full flex-col items-center gap-2 pt-4",children:[(0,a.jsx)(q.Z,{height:56,width:156,noLink:!0,className:"hidden opacity-16 sm:block"}),(0,a.jsx)(q.Z,{height:40,width:104,noLink:!0,className:"block opacity-16 sm:hidden"})]}),X=l(27379),ee=l(3192),et=l(35595),el=l(29876),es=l(37112),en=l(76344),er=l(5357),ei=l(83989),ea=l(74743),eo=l(73883),ed=l(12950),ec=l(85512);let eu=e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"bg-background dark:bg-muted shadow-floating w-full rounded-xl p-4 py-5 md:p-6",children:t})};var em=e=>{var t,l,s;let{currentStep:n,stepIndex:r,totalSteps:i,handleNext:o,handleSkip:d}=e,c=null===(l=null===(t=n.validation)||void 0===t?void 0:t.call(n))||void 0===l||l;(0,ea.y1)("mod+enter",o,{preventDefault:!0,enabled:c,enableOnFormTags:!0});let u=n.content?"div":eu;return(0,a.jsxs)("div",{className:"flex w-full flex-col gap-4 pb-2",children:[n.content&&(0,a.jsx)(eu,{children:n.content}),(0,a.jsx)(u,{children:(0,a.jsxs)("div",{className:(0,$.cn)("flex flex-row items-center gap-8",n.content&&"px-4"),children:[(0,a.jsxs)("div",{className:"flex flex-1 flex-row gap-4",children:[(0,a.jsx)(ec.Z,{className:"mx-0",currentStepIndex:r,totalSteps:i}),(0,a.jsxs)("span",{className:"text-muted-foreground w-full text-start text-xs font-medium uppercase",children:["Step ",r+1,"/",i]})]}),(0,a.jsxs)("div",{className:"flex flex-row gap-2",children:[n.isSkippable&&(0,a.jsx)(el.zx,{size:"sm",variant:"outline",type:"button",className:(0,$.cn)("text-muted-foreground flex items-center justify-center gap-1 overflow-clip rounded-full"),onClick:d,children:(0,a.jsx)("span",{children:null!==(s=n.skipButtonText)&&void 0!==s?s:"Skip"})}),(0,a.jsxs)(el.zx,{size:"sm",variant:"unstyled",type:"button",disabled:!c,className:(0,$.cn)("gap-1","shadow-floating border-background! relative flex items-center justify-center overflow-clip rounded-full border transition-colors outline-none","focus-visible:ring-offset-background focus-visible:ring-ring/50 focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:outline-none","!text-background dark:text-foreground!"),onClick:o,children:[(0,a.jsx)(ed.Z,{className:"z-1",variant:"unstyled",children:"⌘"}),(0,a.jsx)(ed.Z,{className:"z-1",variant:"unstyled",size:"xs",children:"Enter"}),(0,a.jsx)(ei.Z,{className:"z-1"}),(0,a.jsx)(eo.wg,{isLoading:!1,size:"size-20"})]})]})]})})]})},ex=l(67912),eh=l(72610),ep=l(59100),ev=l(36127),ef=l(41664),eg=l.n(ef),ej=l(61857),eb=l(66519),eN=l(86453),ey=l(59433),eC=l(7656),e_=l(92706);let ew=(0,c.memo)(e=>{let{name:t,fallback:l="message-circle",...s}=e,n=ey[e_.Z_.pascalCase(t||l)];if(!n){let e=ey[e_.Z_.pascalCase(l)]||eC.Z;return(0,a.jsx)(e,{...s})}return(0,a.jsx)(n,{...s})});ew.displayName="AppDynamicLucideIcon";var eS=()=>{let{userProfile:e}=(0,R.H)(),t=(0,d.CG)(M.gf),{chats:l,isLoading:s,isUninitialized:n,isFetching:r,isSearchPending:i,searchQuery:o,setSearchQuery:u}=(0,eb.Z)(t,!0),m=s||n&&e.isLoggedIn()||r&&0===l.length,[x,h]=(0,c.useState)(!1),p=(0,c.useRef)(null);return((0,c.useEffect)(()=>{var e;x&&(null===(e=p.current)||void 0===e||e.focus())},[x]),0!==l.length||o||m||r||i)?(0,a.jsxs)("div",{className:"mt-4 flex w-full max-w-3xl flex-col gap-4 px-4 md:px-0",children:[(0,a.jsxs)("div",{className:"group flex w-full items-center justify-between gap-2 border-b pb-2 opacity-80","data-mobile-search-expanded":x,children:[(0,a.jsx)("span",{className:"text-muted-foreground shrink-0 px-0.5 text-sm font-medium group-data-[mobile-search-expanded=true]:hidden group-data-[mobile-search-expanded=true]:sm:inline-block",children:"Recent Chats"}),(0,a.jsx)(y.I,{ref:p,placeholder:"Search chats",className:(0,$.cn)("px-0","hidden md:ml-auto md:block md:max-w-sm md:text-right","group-data-[mobile-search-expanded=true]:block group-data-[mobile-search-expanded=true]:w-full group-data-[mobile-search-expanded=true]:md:ml-auto group-data-[mobile-search-expanded=true]:md:max-w-sm group-data-[mobile-search-expanded=true]:md:text-right"),type:"text",autoComplete:"off",variant:"transparent",value:o,onChange:e=>u(e.target.value)}),(0,a.jsx)(el.zx,{variant:"ghost",size:"unset",className:"text-muted-foreground hover:text-foreground size-8 shrink-0 p-0 group-data-[mobile-search-expanded=true]:hidden md:hidden",onClick:()=>h(!0),"aria-label":"Search chats",children:(0,a.jsx)(ev.Z,{className:"size-4"})})]}),(0,a.jsx)("div",{className:"flex w-full flex-col",children:m?Array.from({length:5}).map((e,t)=>(0,a.jsx)(eI,{},t)):l.length>0?l.map(e=>(0,a.jsx)(ek,{item:e},e.interaction_id)):(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:"No chats found"})})]}):null};let ek=e=>{let{item:t}=e;return(0,a.jsxs)(eg(),{href:"/chat/".concat(t.interaction_id),className:"group/chat-timeline-item flex w-full items-center gap-2 py-1.5 transition-all duration-300 ease-in-out hover:pl-1",children:[(0,a.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,a.jsx)("div",{className:"group-hover/chat-timeline-item:text-foreground text-muted-foreground grid size-7 shrink-0 place-items-center overflow-clip rounded-full border",children:(0,a.jsx)(ew,{name:t.icon,className:"size-3.5"})}),(0,a.jsx)("span",{className:"text-muted-foreground group-hover/chat-timeline-item:text-foreground line-clamp-1 text-sm",children:t.name})]}),(0,a.jsx)("span",{className:"text-muted-foreground group-hover/chat-timeline-item:text-foreground text-sm",children:t.created_ts?eN.hT.relative(t.created_ts):""})]})},eI=()=>(0,a.jsxs)("div",{className:"flex w-full items-center gap-2 py-1.5",children:[(0,a.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,a.jsx)(ej.O,{className:"size-7 shrink-0 rounded-full"}),(0,a.jsx)(ej.O,{className:"h-4 w-32"})]}),(0,a.jsx)(ej.O,{className:"h-4 w-16"})]});var eE=()=>(0,a.jsx)(c.Fragment,{children:(0,a.jsx)(eS,{})}),eO=l(10869);let eT=()=>{let{userProfile:e,idTokenRef:t}=(0,R.H)(),[l,s]=(0,eO.uv)();return{updateCustomAgent:(0,c.useCallback)((s,n)=>l({userProfile:e,idToken:t.current,gummie_id:s,updates:n}),[e,t,l]),...s}};var eM=l(80686),eR=l(45788),eL=l(87111),eA=l(4270),eG=l(25675),ez=l.n(eG),eP=l(18591),eZ=l(18272),eD=l(30671),eU=l(42414),eF=l(47640),eV=l(77118),eB=l(5295),eH=l(22455),eW=l(28643),eJ=l(67763),eY=l(74238),eK=l(13889),e$=l(22896),eq=l(21250),eQ=e=>{var t,l;let{open:s,onOpenChange:n,server_id:r}=e,i=(0,d.CG)(e=>eK.SN.selectMCPDeclarationById(e,r)),o=(0,d.CG)(M.SO),{updateCustomAgent:u,isLoading:m}=eT(),x=(0,eB.F1)(null!==(t=null==i?void 0:i.category)&&void 0!==t?t:""),h=(0,c.useMemo)(()=>{var e,t,l;return null!==(l=null==o?void 0:null===(t=o.tools)||void 0===t?void 0:null===(e=t.find(e=>e.server_id===r))||void 0===e?void 0:e.restricted_tools)&&void 0!==l?l:[]},[null==o?void 0:o.tools,r]),p=(0,c.useCallback)((e,t,l)=>{var s,n;if(!(null==o?void 0:o.gummie_id))return;let r=new Set(h);l?r.add(t):r.delete(t);let i=Array.from(r),a=null===(s=o.tools)||void 0===s?void 0:s.findIndex(t=>t.server_id===e);if(void 0!==a&&a>=0&&o.tools){let e=o.tools.map((e,t)=>t===a?{...e,restricted_tools:i}:e);u(o.gummie_id,{tools:e})}else{let t=[...null!==(n=o.tools)&&void 0!==n?n:[],{server_id:e,type:eW.y.GUMCP_SERVER,restricted_tools:i}];u(o.gummie_id,{tools:t})}},[null==o?void 0:o.gummie_id,null==o?void 0:o.tools,h,u]),v=(0,c.useCallback)(()=>{var e,t;if(!(null==o?void 0:o.gummie_id))return;let l=null===(e=o.tools)||void 0===e?void 0:e.findIndex(e=>e.server_id===r);if(void 0!==l&&l>=0&&o.tools){let e=o.tools.map((e,t)=>t===l?{...e,restricted_tools:[]}:e);u(o.gummie_id,{tools:e})}else{let e=[...null!==(t=o.tools)&&void 0!==t?t:[],{server_id:r,type:eW.y.GUMCP_SERVER,restricted_tools:[]}];u(o.gummie_id,{tools:e})}},[null==o?void 0:o.gummie_id,null==o?void 0:o.tools,r,u]),f=(0,c.useCallback)(e=>{var t,l;if(!(null==o?void 0:o.gummie_id))return;let s=null===(t=o.tools)||void 0===t?void 0:t.findIndex(e=>e.server_id===r);if(void 0!==s&&s>=0&&o.tools){let t=o.tools.map((t,l)=>l===s?{...t,restricted_tools:e}:t);u(o.gummie_id,{tools:t})}else{let t=[...null!==(l=o.tools)&&void 0!==l?l:[],{server_id:r,type:eW.y.GUMCP_SERVER,restricted_tools:e}];u(o.gummie_id,{tools:t})}},[null==o?void 0:o.gummie_id,null==o?void 0:o.tools,r,u]);return(0,a.jsx)(e$.yo,{open:s,onOpenChange:n,children:(0,a.jsxs)(e$.ue,{className:"flex h-full flex-grow flex-col gap-3",children:[(0,a.jsxs)(e$.Tu,{children:[(0,a.jsxs)(e$.bC,{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"text-foreground dot-pattern dot-pattern-dark border-border grid size-10 place-content-center rounded-full border",children:(0,a.jsx)(ez(),{src:x,alt:null!==(l=null==i?void 0:i.category)&&void 0!==l?l:"",width:20,height:20,className:"shrink-0"})}),null==i?void 0:i.category]}),(0,a.jsx)(e$.Ei,{children:"Select the tools you'd like to enable from your ".concat(null==i?void 0:i.category," server")})]}),(0,a.jsx)("div",{className:"flex h-full flex-col overflow-hidden",children:(0,a.jsx)(eq.ZP,{serverId:r,onToggleTool:p,onSelectAll:v,onClearAll:f,isUpdating:m})})]})})},eX=l(71424),e0=e=>{let{name:t,description:l,iconPath:s,tools:n,footer:r,headerBadge:i}=e;return(0,a.jsxs)("div",{className:"flex flex-col gap-0",children:[i&&(0,a.jsx)(eX.C,{...i,className:"w-full justify-center !rounded-none ".concat(i.className||""),children:i.text}),(0,a.jsxs)("div",{className:"bg-background flex w-64 flex-col",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1 p-4 pb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s&&(0,a.jsx)("div",{className:"bg-muted grid size-6 shrink-0 place-items-center rounded",children:(0,a.jsx)(ez(),{src:s,alt:t,width:16,height:16})}),(0,a.jsx)("span",{className:"text-sm font-medium",children:t})]}),l&&(0,a.jsx)("span",{className:"text-muted-foreground text-xs",children:l})]}),n&&n.length>0&&(0,a.jsxs)(c.Fragment,{children:[(0,a.jsx)("hr",{className:"border-border"}),(0,a.jsxs)("div",{className:"flex max-h-48 flex-col gap-1.5 overflow-y-auto px-4 py-3",children:[(0,a.jsxs)("span",{className:"text-muted-foreground text-xs font-medium",children:["Available Tools (",n.length,")"]}),n.map(e=>(0,a.jsx)("div",{className:"flex items-start gap-2",children:(0,a.jsx)("span",{className:"text-xs",children:e_.Z_.toolName(e.name)})},e.name))]})]}),r&&(0,a.jsxs)(c.Fragment,{children:[(0,a.jsx)("hr",{className:"border-border"}),r]})]})]})};let e1=e=>{var t;return!!(!(null===(t=e.secretTypes)||void 0===t?void 0:t.length)||(0,eJ.gM)(e.secretTypes,e.optionalSecrets))},e2=(e,t)=>{var l,s;return!!e1(e)||null!==(s=null===(l=e.secretTypes)||void 0===l?void 0:l.every(e=>t.some(t=>t.secret_type===e)))&&void 0!==s&&s},e5=e=>{var t;return{iconPath:(0,eB.F1)(null!==(t=e.category)&&void 0!==t?t:"")||e.icon,displayName:e.category||e.name}};var e4=()=>{let[e,t]=(0,c.useState)(!1),[l,s]=(0,c.useState)(""),[n,r]=(0,c.useState)(!1),[i,o]=(0,c.useState)(),[u,m]=(0,c.useState)(!1),[x,h]=(0,c.useState)(),p=e=>{o(e),r(!0),t(!1)},v=e=>{h(e),m(!0)},f=(0,d.CG)(M.SO),{updateCustomAgent:g,isLoading:j}=eT(),{userProfile:b,idTokenRef:N}=(0,R.H)(),y=b.isLoggedIn(),{data:C,isLoading:_}=(0,eF.Z)({filters:["agents"]}),{data:w=[]}=(0,eR.jL)({userProfile:b,idToken:N.current}),S=(0,c.useMemo)(()=>{var e;let t=new Map;return null==f||null===(e=f.tools)||void 0===e||e.forEach(e=>{e.server_id&&e.type===eW.y.GUMCP_SERVER&&t.set(e.server_id,{is_disabled:e.is_disabled})}),t},[null==f?void 0:f.tools]),{connectedServers:k,unconnectedServers:I}=(0,c.useMemo)(()=>{var e;let t=(null!==(e=null==C?void 0:C.servers)&&void 0!==e?e:[]).map(e=>({...e,isAlwaysAvailable:e1(e),isConnected:e2(e,w)})),l=(e,t)=>{var l,s;return e.isRestricted!==t.isRestricted?e.isRestricted?1:-1:(null!==(l=e.name)&&void 0!==l?l:e.id).localeCompare(null!==(s=t.name)&&void 0!==s?s:t.id)};return y?{connectedServers:t.filter(e=>e.isConnected).sort(l),unconnectedServers:t.filter(e=>!e.isConnected).filter(e=>{var t;let l=null===(t=e.secretTypes)||void 0===t?void 0:t[0];return!l||eH.ZP.some(e=>e.secret_type===l)}).sort(l)}:{connectedServers:[...t].sort(l),unconnectedServers:[]}},[null==C?void 0:C.servers,w,y]),E=(0,c.useMemo)(()=>{if(!l)return k;let e=l.toLowerCase();return k.filter(t=>{var l,s;return(null===(l=t.name)||void 0===l?void 0:l.toLowerCase().includes(e))||(null===(s=t.category)||void 0===s?void 0:s.toLowerCase().includes(e))})},[k,l]),O=(0,c.useMemo)(()=>{if(!l)return I;let e=l.toLowerCase();return I.filter(t=>{var l,s;return(null===(l=t.name)||void 0===l?void 0:l.toLowerCase().includes(e))||(null===(s=t.category)||void 0===s?void 0:s.toLowerCase().includes(e))})},[I,l]),T=e=>{let t=S.get(e);return!(null==t?void 0:t.is_disabled)},L=(e,t)=>{var l;let s;if(!(null==f?void 0:f.gummie_id))return;let n=null!==(l=f.tools)&&void 0!==l?l:[],r=n.findIndex(t=>t.server_id===e&&t.type===eW.y.GUMCP_SERVER);if(t){if(!(r>=0))return;s=n.filter((e,t)=>t!==r)}else s=r>=0?n.map((e,t)=>t===r?{...e,is_disabled:!0}:e):[...n,{server_id:e,type:eW.y.GUMCP_SERVER,is_disabled:!0}];g(f.gummie_id,{tools:s})},A=k.filter(e=>T(e.id)).length;return(0,a.jsxs)(c.Fragment,{children:[(0,a.jsxs)(eZ.J2,{open:e,onOpenChange:t,children:[(0,a.jsx)(eZ.xo,{asChild:!0,children:(0,a.jsxs)(el.zx,{variant:"ghost",accent:"outline",size:"xs",className:"gap-1.5 px-1 text-xs",loading:_,children:[(0,a.jsx)(eL.Z,{}),(0,a.jsx)("span",{className:"font-normal",children:e_.Z_.countOf({count:A,singular:"app"})})]})}),(0,a.jsx)(eZ.yk,{className:"w-80 p-0",align:"start",children:(0,a.jsxs)(eP.mY,{shouldFilter:!1,children:[(0,a.jsx)(eP.sZ,{placeholder:"Search apps",value:l,onValueChange:s}),(0,a.jsxs)(eP.e8,{className:"max-h-72",children:[(0,a.jsx)(eP.rb,{children:"No apps found."}),E.length>0&&(0,a.jsx)(eP.fu,{heading:y?"Connected":"Apps",children:E.map(e=>(0,a.jsx)(e3,{server:e,isEnabled:T(e.id),isUpdating:j,onToggle:t=>L(e.id,t),onOpenToolDetails:v,showSwitch:y},e.id))}),O.length>0&&(0,a.jsx)(eP.fu,{heading:"Not Connected",children:O.map(e=>(0,a.jsx)(e7,{server:e,onOpenDialog:p,userSecretTypes:w,onOpenToolDetails:v},e.id))}),_&&(0,a.jsx)("div",{className:"text-muted-foreground p-4 text-center text-sm",children:"Loading apps..."})]})]})})]}),(0,a.jsx)(eY.ZP,{open:n,onOpenChange:e=>{r(e),e||o(void 0)},defaultSecretType:i}),x&&(0,a.jsx)(eQ,{open:u,onOpenChange:m,server_id:x})]})};let e8=e=>{let{onClick:t}=e;return(0,a.jsx)("button",{onClick:t,className:"hover:bg-muted text-primary w-full px-4 py-2 text-left text-xs font-medium transition-colors",children:"Manage tools →"})},e9=e=>{var t;let{server:l,item:s,showFooter:n,onOpenToolDetails:r,headerBadge:i}=e,{iconPath:o,displayName:d}=e5(l);return(null===(t=l.tools)||void 0===t?void 0:t.length)?(0,a.jsxs)(eU.u,{delayDuration:200,children:[(0,a.jsx)(eU.aJ,{asChild:!0,children:(0,a.jsx)("div",{children:s})}),(0,a.jsx)(eU._v,{side:"right",className:"z-[10000] !p-0",variant:"outline",sideOffset:18,children:(0,a.jsx)(e0,{name:null!=d?d:l.id,description:l.description,iconPath:o,tools:l.tools,headerBadge:i,footer:n&&r?(0,a.jsx)(e8,{onClick:()=>r(l.id)}):void 0})})]}):(0,a.jsx)(a.Fragment,{children:s})},e3=e=>{let{server:t,isEnabled:l,isUpdating:s,onToggle:n,onOpenToolDetails:r,showSwitch:i=!0}=e,{iconPath:o,displayName:d}=e5(t),c=t.isRestricted,u=(0,a.jsxs)(eP.di,{disabled:c,className:(0,$.cn)("flex items-center justify-between gap-2 px-2 py-1.5",c&&"opacity-50"),children:[(0,a.jsxs)("div",{className:(0,$.cn)("flex min-w-0 items-center gap-2",c&&"text-muted-foreground"),children:[o&&(0,a.jsx)("div",{className:"bg-muted grid size-6 shrink-0 place-items-center rounded",children:(0,a.jsx)(ez(),{src:o,alt:null!=d?d:"",width:16,height:16})}),(0,a.jsx)("span",{className:"truncate text-sm",children:d})]}),i&&(0,a.jsx)(eD.r,{checked:l,onCheckedChange:n,onClick:e=>e.stopPropagation(),disabled:s})]});return(0,a.jsx)(e9,{server:t,item:u,showFooter:!c,onOpenToolDetails:r,headerBadge:c?{text:"Restricted by Admin",variant:"destructive",size:"sm",className:"font-normal"}:void 0})},e7=e=>{let{server:t,onOpenDialog:l,userSecretTypes:s}=e,{iconPath:n,displayName:r}=e5(t),i=t.isRestricted,o=eH.ZP.find(e=>{var l;return e.secret_type===(null===(l=t.secretTypes)||void 0===l?void 0:l[0])}),{handleAuthentication:d}=(0,eV.C)({secretDeclaration:o}),c=(0,a.jsxs)(eP.di,{onSelect:i?void 0:()=>{var e;if(o){if(o.isOAuth&&(null===(e=o.supported_oauth_configs)||void 0===e?void 0:e.length)&&!o.isMultiAuth){let e=o.supported_oauth_configs[0];if(!s.some(t=>t.secret_type===e)){l(e);return}}if(o.isOAuth&&o.has_custom_subdomain||o.isOAuth&&o.isMultiAuth||o.isOAuth&&o.isInstructional){l(o.secret_type);return}o.isOAuth?d():l(o.secret_type)}},disabled:i,className:(0,$.cn)("flex cursor-pointer items-center justify-between gap-2 px-2 py-1.5",i&&"opacity-50"),children:[(0,a.jsxs)("div",{className:(0,$.cn)("flex min-w-0 items-center gap-2",i&&"text-muted-foreground"),children:[n&&(0,a.jsx)("div",{className:"bg-muted grid size-6 shrink-0 place-items-center rounded",children:(0,a.jsx)(ez(),{src:n,alt:null!=r?r:"",width:16,height:16})}),(0,a.jsx)("span",{className:"truncate text-sm",children:r})]}),(0,a.jsx)("div",{className:"grid size-6 shrink-0 place-items-center rounded",children:(0,a.jsx)(eA.Z,{className:"size-3.5"})})]});return(0,a.jsx)(e9,{server:t,item:c,headerBadge:i?{text:"Restricted by Admin",variant:"destructive",size:"sm",className:"font-normal"}:void 0})};var e6=()=>{let e=(0,d.CG)(M.b_),t=(0,d.CG)(M.SO),{userProfile:l}=(0,R.H)(),{updateCustomAgent:s,isLoading:n}=eT(),r=e=>{s(null==t?void 0:t.gummie_id,{model_name:e})};return(0,a.jsxs)(c.Fragment,{children:[(0,a.jsx)(eM.Z,{options:e,value:(null==t?void 0:t.model_name)||(l.isLoading()?"":"gummies_recommended"),onChange:e=>r(e),variant:eM.I.COMPACT,triggerProps:{className:"-ml-1.5"},popoverContentProps:{className:"w-md"},disabled:n}),(0,a.jsx)(e4,{})]})},te=l(62190),tt=l(97257),tl=()=>{let[e,t]=(0,c.useState)(!1),[l,s]=(0,c.useState)(!1),{currentProject:n}=(0,tt.d2)(),{userProfile:r,idTokenRef:i}=(0,R.H)(),o=(0,U.Z)();(0,c.useEffect)(()=>{r.isLoggedIn()&&(async()=>{let e=await r.fetchUserMetadata(H.m.CHAT_CONNECT_APP_LIP_DISMISSED,i.current);(null===e||"false"===e)&&s(!0)})()},[r,r.user_id,i]);let d=(0,c.useMemo)(()=>{var e,t,l,s;return o?null===(t=null!==(s=null===(l=S.So.find(e=>e.title===o))||void 0===l?void 0:l.integrations)&&void 0!==s?s:[])||void 0===t?void 0:null===(e=t.map(e=>(0,eB.F1)(null!=e?e:"")))||void 0===e?void 0:e.filter(e=>void 0!==e&&!["/images/gumloop_logo_small.png"].includes(null!=e?e:"")):[]},[o]);return l?(0,a.jsxs)(c.Fragment,{children:[(0,a.jsxs)("div",{className:"flex w-full shrink-0 items-center gap-2",children:[(0,a.jsxs)("button",{className:"flex flex-1 items-center gap-2 px-4 py-2",onClick:()=>t(!0),children:[(0,a.jsx)("div",{className:"flex flex-row items-center",children:null==d?void 0:d.slice(0,5).map((e,t)=>(0,a.jsx)("div",{className:(0,$.cn)("bg-background grid size-5 place-items-center rounded-sm border",t>0&&"-ml-1.5"),style:{zIndex:d.length-t},children:(0,a.jsx)(ez(),{src:e,alt:"",width:16,height:16})},e))}),(0,a.jsx)("span",{className:"w-full text-start text-xs font-medium",children:"Connect apps to power your agent's abilities"})]}),(0,a.jsx)(el.zx,{onClick:e=>{e.stopPropagation(),r.setUserMetadata(H.m.CHAT_CONNECT_APP_LIP_DISMISSED,"true",i.current),s(!1)},variant:"ghost",accent:"outline",size:"icon-xs",className:"mr-3","aria-label":"Dismiss",children:(0,a.jsx)(te.Z,{className:"size-4"})})]}),(0,a.jsx)(eY.ZP,{open:e,onOpenChange:t,project:n})]}):null},ts=()=>{let e=(0,d.CG)(o.Lv),{currentStep:t,displayStepIndex:l,totalSteps:s,handleNext:n,handleSkip:r,handleSkipDemo:i,isDemoRunning:u}=Y(),x=(0,d.CG)(o.uB),h=(0,d.CG)(M.W5),p=(0,d.CG)(o.bc),v=(0,d.CG)(o.d5),{interaction_id:f}=(0,ex.Z)(),g=(0,c.useCallback)(e=>{if(e&&!x){let t="/chat/".concat(e);window.history.replaceState({...window.history.state,as:t,url:t},"",t)}},[x]),j=(0,X.useSearchParams)(),{removeParams:b}=(0,ep.W)(),{handleSubmitGeneralAgentMessage:N}=(0,eh.s)(),y=(0,c.useRef)(!1);(0,c.useEffect)(()=>{var e;let t=null===(e=j.get("prompt"))||void 0===e?void 0:e.trim();t&&!y.current&&(y.current=!0,b(["prompt"]),N({messageContent:t}))},[j,b,N]);let C=(0,c.useMemo)(()=>({type:"agent",sectionLabel:"Agents",sectionIcon:(0,a.jsx)(ee.Z,{size:14}),items:h,toMentionItem:e=>({id:e.gummie_id,label:e.name,Icon:(0,a.jsx)(er.Z,{iconUrl:e.metadata.icon_url,size:"xxs"})}),filter:(e,t)=>e.name.toLowerCase().includes(t.toLowerCase())}),[h]),_=(0,c.useMemo)(()=>[C],[C]),w=(0,c.useMemo)(()=>x||f&&p!==f,[x,f,p]);return(0,a.jsxs)("div",{className:(0,$.cn)("flex flex-col items-center overflow-y-auto",e?"h-full gap-0 pb-4":(0,$.cn)("gap-4 pb-2",w?"h-full justify-end":"h-fit justify-start pt-[20svh] pb-6")),children:[!e&&!w&&v===m.Cn.GENERAL&&(0,a.jsx)(en.Z,{}),(0,a.jsx)(es.Z,{className:(0,$.cn)("md:px-8 lg:w-full",e&&w?"h-full":"h-fit",e&&!x&&"justify-end"),assistantMessageProps:{avatar:{name:e?"Gumloop Agent":"Gumloop"}},avoidCollapsibleStepsAutoClose:e,alwaysShowMessages:e||void 0,interactiveElement:e&&!u?(0,a.jsx)(em,{currentStep:t,stepIndex:l,totalSteps:s,handleNext:n,handleSkip:r}):void 0,disabled:e,abortElement:e&&u?(0,a.jsxs)(el.zx,{variant:"ghost",size:"2xs",onClick:i,className:"-mr-2 gap-1.5",children:["Skip ",(0,a.jsx)(et.Z,{className:"size-3.5"})]}):void 0,hideReportButton:e?void 0:!w,mentionSources:e?void 0:_,onSubmitMessage:e?void 0:g,extendedFooterGroupActions:e?void 0:(0,a.jsx)(e6,{}),bottomLip:e||w?void 0:(0,a.jsx)(tl,{})}),!e&&!w&&(0,a.jsx)(eE,{})]})},tn=l(11163);let tr=(0,c.createContext)(null),ti=()=>{let e=(0,c.useContext)(tr);if(!e)throw Error("useChatContext must be used within a ChatProvider");return e},ta=e=>{let{children:t}=e,l=(0,tn.useRouter)(),s=(0,d.TL)(),{abortCoreGummieCompletion:n}=(0,T.J)(),[r,i]=(0,c.useState)(!1),[u,x]=(0,c.useState)(!1),h=(0,c.useCallback)(()=>{i(e=>!e)},[]),p=(0,c.useCallback)(()=>{u||i(!1)},[u]),v=(0,c.useCallback)(()=>{n(),s((0,o.nz)(m.Cn.GENERAL)),l.push("/chat")},[n,s,l]),f=(0,c.useMemo)(()=>({conversationsOpen:r,setConversationsOpen:i,conversationsLocked:u,setConversationsLocked:x,toggleConversations:h,dismissConversations:p,handleNewChat:v}),[r,u,h,p,v]);return(0,a.jsx)(tr.Provider,{value:f,children:t})};var to=l(88953),td=l(29871),tc=l(54020),tu=l(50016),tm=l(95528),tx=()=>{let{conversationsOpen:e,setConversationsOpen:t}=ti();return(0,tc.Z)(944)?(0,a.jsx)(e$.yo,{open:e,onOpenChange:t,children:(0,a.jsx)(e$.ue,{side:"bottom",className:"flex max-h-[70vh] min-h-[50svh] flex-col gap-0 overflow-hidden border-t p-0",children:(0,a.jsx)(th,{})})}):(0,a.jsx)("div",{className:(0,$.cn)("h-full overflow-hidden transition-[width] duration-200 ease-out",e?"w-80":"w-0"),children:(0,a.jsx)("div",{className:"bg-background flex h-full w-80 flex-col border-r",children:(0,a.jsx)(th,{})})})};let th=()=>{let e=(0,d.CG)(M.gf),{chats:t,isLoading:l,isUninitialized:s,isFetching:n,hasNextPage:r,loadMore:i,searchQuery:o,setSearchQuery:u}=(0,eb.Z)(e,!0);return(0,a.jsxs)(c.Fragment,{children:[(0,a.jsx)("div",{className:"flex items-center justify-between p-2 pr-11 pb-1 md:pr-2",children:(0,a.jsx)(y.I,{placeholder:"Search",type:"search",autoComplete:"off",autoFocus:!0,value:o,onChange:e=>u(e.target.value)})}),!e||l||s||n&&0===t.length?(0,a.jsx)(tf,{children:Array.from({length:6}).map((e,t)=>(0,a.jsx)(tv,{},t))}):0===t.length?(0,a.jsx)(tu.Z,{title:"No chats found",description:"Send a message to get started",size:"sm",className:"my-12"}):(0,a.jsxs)(tf,{children:[t.map(e=>(0,a.jsx)(tp,{chat:e},e.interaction_id)),(r||n)&&(0,a.jsxs)(el.zx,{onClick:i,disabled:n,variant:"ghost",accent:"outline",size:"sm",loading:n,children:[(0,a.jsx)(td.Z,{}),"Load more"]})]})]})},tp=e=>{let{chat:t}=e,l=(0,tn.useRouter)(),s=(0,c.useMemo)(()=>{var e,l;return[...(null!==(e=t.servers_used)&&void 0!==e?e:[]).map(e=>({id:e,type:to.S.TOOL_INVOCATION,serverName:e,toolName:""})),...(null!==(l=t.tools_used)&&void 0!==l?l:[]).map(e=>({id:e,type:to.S.TOOL_INVOCATION,toolName:e,serverName:void 0}))]},[t.servers_used,t.tools_used]),n=s.length>0;return(0,a.jsxs)("button",{onClick:()=>{l.push("/chat/".concat(t.interaction_id))},className:"hover:bg-muted/80 flex w-full flex-col gap-1 rounded-sm p-2 text-left transition-colors",children:[(0,a.jsx)("p",{className:"text-foreground line-clamp-1 text-sm",children:t.name||"No message"}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[n?(0,a.jsx)(tm.Z,{parts:s,size:"sm"}):(0,a.jsx)("div",{}),(0,a.jsx)("span",{className:"text-muted-foreground/60 flex-shrink-0 text-xs",children:eN.hT.relativeCompact(t.created_ts)})]})]})},tv=()=>(0,a.jsxs)("div",{className:"flex w-full flex-col gap-1 rounded-sm p-2",children:[(0,a.jsx)(ej.O,{className:"h-5 w-3/4"}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex -space-x-1.5",children:[(0,a.jsx)(ej.O,{className:"size-5 rounded-full"}),(0,a.jsx)(ej.O,{className:"size-5 rounded-full"}),(0,a.jsx)(ej.O,{className:"size-5 rounded-full"})]}),(0,a.jsx)(ej.O,{className:"h-3 w-12"})]})]}),tf=e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"flex flex-1 flex-col overflow-y-auto p-2",children:t})};var tg=l(85929),tj=l(75026),tb=l(78497),tN=l(4970),ty=l(43024),tC=l(18165);l(88507);var t_=()=>{let{toggleConversations:e,handleNewChat:t,conversationsOpen:l}=ti(),{toggleSidebar:s}=(0,tN.Ap)(),n=(0,d.CG)(M.gf),r=(0,d.CG)(o.bc),i=(0,d.CG)(o.uB);(0,ea.y1)("mod+shift+o",e=>{e.preventDefault(),t()});let{name:u,data:m}=(0,ty.Z)(n,r),x=(0,c.useMemo)(()=>{var e;return null!==(e=null==m?void 0:m.totalCredits())&&void 0!==e?e:0},[m]);return(0,a.jsxs)("div",{className:(0,$.cn)("mt-0.5 grid min-h-8 grid-cols-[1fr_auto_1fr] items-start justify-between p-2 md:items-center"),children:[(0,a.jsx)("div",{className:(0,$.cn)("flex w-fit justify-start gap-0.25",!i&&"md:hidden"),children:(0,a.jsxs)(c.Fragment,{children:[(0,a.jsxs)(el.zx,{onClick:e,variant:"ghost",accent:"outline",size:"sm",className:"hidden md:flex",children:[l?(0,a.jsx)(tg.Z,{}):(0,a.jsx)(tj.Z,{}),(0,a.jsxs)("span",{children:[l?"Hide":"Show"," chats"]})]}),(0,a.jsx)(el.zx,{variant:"ghost",accent:"outline",size:"icon-sm",className:"md:hidden",onClick:s,children:(0,a.jsx)(tb.Z,{})})]})}),(0,a.jsxs)("div",{className:"flex w-full max-w-96 flex-col items-baseline justify-center pt-1 opacity-80 md:flex-row md:pt-0",children:[(0,a.jsx)("span",{className:"truncate text-center text-sm font-medium",children:u||""}),x>0&&(0,a.jsxs)("span",{className:"text-muted-foreground mx-auto flex shrink-0 items-baseline justify-center gap-0.5 text-xs md:mx-0 md:pl-1.5",children:[(0,a.jsx)("span",{className:"mr-0.5 hidden md:block",children:"|"})," ",tC.Rx.grouped(x)," ",(0,a.jsx)("span",{className:"text-muted-foreground text-[9px] uppercase",children:"credits"})]})]}),(0,a.jsxs)("div",{className:"flex flex-1 justify-end gap-0.25",children:[!1,i&&(0,a.jsxs)(el.zx,{onClick:t,variant:"ghost",accent:"outline",size:"sm",className:"px-1.75 md:px-3",children:[(0,a.jsx)(eA.Z,{}),(0,a.jsx)("span",{className:"hidden md:block",children:"New chat"})]})]})]})},tw=l(95895),tS=l(6335),tk=l(9751),tI=e=>{let{open:t,onClose:l}=e,{handleProjectSwitch:s}=(0,tk.y)(),n=(0,X.useRouter)();return(0,a.jsx)(tS.aR,{open:t,children:(0,a.jsxs)(tS._T,{children:[(0,a.jsx)(tS.iP,{children:(0,a.jsxs)(tS.fY,{children:[(0,a.jsx)(tS.f$,{children:"Chat is only available in your personal workspace"}),(0,a.jsx)(tS.yT,{children:"Switch to your personal workspace to continue using Chat, or go back to the hub."})]})}),(0,a.jsxs)(tS.xo,{children:[(0,a.jsx)(tS.le,{onClick:()=>{l(),n.replace("/hub")},children:"Go Back"}),(0,a.jsx)(tS.OL,{onClick:()=>{localStorage.setItem("currentProfile",""),s(void 0,!1,!1),l()},children:"Switch to Personal"})]})]})})},tE=e=>{var t,l;let{children:s}=e,{userProfile:n,idTokenRef:r}=(0,R.H)(),{currentProject:i}=(0,tt.d2)(),u=(0,d.TL)(),x=(0,d.CG)(M.gf),h=(0,d.CG)(o.d5),p=(0,X.useRouter)();(0,tn.useRouter)();let v="/chat/onboarding"===window.location.pathname,{data:f}=(0,eO.iM)({userProfile:n,idToken:r.current},{skip:!n.isLoggedIn()||!r.current});(0,eO.b6)({userProfile:n,idToken:r.current,author_id:(null==f?void 0:null===(t=f.gummie)||void 0===t?void 0:t.author_id)||""},{skip:!(null==f?void 0:null===(l=f.gummie)||void 0===l?void 0:l.author_id)||n.isLoading()}),(0,eF.Z)({filters:["agents"]}),(0,eR.jL)({userProfile:n,idToken:r.current}),(0,c.useEffect)(()=>{(null==f?void 0:f.gummie)&&x!==f.gummie.gummie_id&&u((0,M.U8)(f.gummie))},[null==f?void 0:f.gummie,x,u]),(0,c.useEffect)(()=>{if(!(null==f?void 0:f.gummie)&&!v)return;let e=v?m.Cn.ONBOARDING:m.Cn.GENERAL;h!==e&&u((0,o.pj)({mode:e,resetChat:e===m.Cn.ONBOARDING}))},[null==f?void 0:f.gummie,v,h,u]),(0,c.useEffect)(()=>{v?document.body.setAttribute("data-onboarding","true"):document.body.removeAttribute("data-onboarding")},[v]);let[g,j]=(0,c.useState)(()=>{if(null==i?void 0:i.id)return!0;{let e=localStorage.getItem("currentProfile");return!!e&&""!==e}});return(0,c.useEffect)(()=>{!g&&(null==i?void 0:i.id)&&p.replace("/hub")},[null==i?void 0:i.id,p,g]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(tI,{open:g,onClose:()=>j(!1)}),(0,a.jsx)(tw.Z,{children:s})]})},tO=()=>{let e=(0,d.CG)(o.Lv);return(0,a.jsx)(tE,{children:(0,a.jsx)(ta,{children:(0,a.jsx)(K,{children:(0,a.jsxs)("div",{className:(0,$.cn)("bg-background relative flex max-h-svh flex-1 overflow-hidden border-l"),children:[!e&&(0,a.jsx)(tx,{}),(0,a.jsxs)("div",{className:"flex h-full flex-1 flex-col",children:[e?(0,a.jsx)(Q,{}):(0,a.jsx)(t_,{}),(0,a.jsx)(ts,{})]})]})})})})}},85512:function(e,t,l){var s=l(85893),n=l(18998);t.Z=e=>{let{currentStepIndex:t,totalSteps:l,className:r,...i}=e;return(0,s.jsx)("div",{className:(0,n.cn)("mx-auto flex shrink-0 flex-row items-center gap-1.5",r),...i,children:Array.from({length:l}).map((e,l)=>{let r=l<t,i=l===t;return(0,s.jsx)("div",{className:(0,n.cn)("h-1 rounded-full transition-all",i?"bg-accent-foreground w-4":r?"bg-accent-foreground w-1":"bg-muted-foreground/30 w-1")},l)})})}},76344:function(e,t,l){l.d(t,{Z:function(){return p}});var s=l(85893),n=l(48491),r=l(53985),i=l(22495),a=l(67294),o=l(39281),d=l(78293);let c=(e,t,l,s)=>0===t?0:Math.floor(e+(t-e)*Math.min(1,Math.max(0,(s.getTime()-l.getTime())/9e5)));var u=()=>{var e,t;let{activityCountData:l}=(0,d.Tj)(),s=null!==(e=null==l?void 0:l.count)&&void 0!==e?e:0,n=null!==(t=null==l?void 0:l.previous_count)&&void 0!==t?t:0,r=(0,a.useMemo)(()=>(null==l?void 0:l.counted_at)?new Date(l.counted_at):null,[null==l?void 0:l.counted_at]),[i,o]=(0,a.useState)(()=>r&&0!==s?c(n,s,r,new Date):0);return(0,a.useEffect)(()=>{if(!r||0===s){o(0);return}o(c(n,s,r,new Date))},[n,s,r]),(0,a.useEffect)(()=>{if(!r||0===s)return;let e=setInterval(()=>{o(c(n,s,r,new Date))},2e3);return()=>clearInterval(e)},[n,s,r]),{displayCount:i}},m=l(45837);let x=e=>{let{digit:t,delay:l=0}=e;return(0,s.jsx)("span",{className:"bg-muted relative inline-block overflow-hidden px-1 py-0.25",style:{height:"".concat(1.3,"em")},children:(0,s.jsx)(o.E.span,{className:"flex flex-col",initial:!1,animate:{y:"".concat(-(1.3*t),"em")},transition:{type:"spring",stiffness:100,damping:15,delay:l},children:[0,1,2,3,4,5,6,7,8,9].map(e=>(0,s.jsx)("span",{className:"flex items-center justify-center leading-none",style:{height:"".concat(1.3,"em")},children:e},e))})})},h=()=>{let{displayCount:e}=u(),t=(0,a.useMemo)(()=>e.toString().padStart(4,"0").split("").map(e=>parseInt(e,10)),[e]);return 0===e?(0,s.jsx)("p",{className:"text-muted-foreground text-center md:text-xl",children:"Make MCP tool calls in Gumloop to get started"}):(0,s.jsxs)("p",{className:"text-muted-foreground text-center md:text-xl",children:["Understand the"," ",(0,s.jsx)("span",{className:"border-border/50 divide-border/50 inline-flex flex-row divide-x overflow-hidden rounded-sm border font-mono tabular-nums",children:t.map((e,t)=>(0,s.jsx)(x,{digit:e,delay:.1*t},t))})," ","tool calls made this month"]})};var p=()=>{let e=(0,i.CG)(n.d5),{userProfile:t}=(0,m.H)(),l=(0,a.useMemo)(()=>e===r.Cn.AGENT?"I'm your AI co-pilot. I can build flows, help you answer questions, and make you a Gumloop expert.":e===r.Cn.CUSTOM_NODE_CONFIG?"I'm your AI co-pilot. I can help you build and edit custom nodes.":e===r.Cn.GUMSTACK?(0,s.jsx)(h,{}):e===r.Cn.CUSTOM_GUMMIE||e===r.Cn.GENERAL?null:"I'm your AI co-pilot.",[e]),o=(0,a.useMemo)(()=>{var l,n;return t.isLoggedIn()||e!==r.Cn.GENERAL?e===r.Cn.GUMSTACK?(0,s.jsxs)("span",{className:"text-foreground mb-0.5 text-center text-xl font-medium md:text-3xl",children:["Hey ",null!==(l=t.first_name)&&void 0!==l?l:"there",",",(0,s.jsx)("br",{})]}):(0,s.jsxs)("span",{className:"text-foreground text-center text-xl font-medium md:text-2xl",children:["Hey ",null!==(n=t.first_name)&&void 0!==n?n:"there",", how can I help?"]}):(0,s.jsx)("span",{className:"text-foreground mb-0.5 text-center text-xl font-medium md:text-3xl",children:"Welcome to Gumloop, how can I help?"})},[e,t]);return(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1 px-4",children:[o,l&&"string"==typeof l?(0,s.jsx)("span",{className:"text-muted-foreground text-center text-sm text-balance",children:l}):l]})}},95895:function(e,t,l){l.d(t,{Z:function(){return C}});var s=l(85893),n=l(48491),r=l(53985),i=l(10869),a=l(22495),o=l(69245),d=l(94364),c=l(67294),u=l(44614),m=l(45837),x=l(34849),h=l(43841),p=l(88953),v=l(77739),f=l(41248),g=l(33682),j=l(75318);let b=e=>{let{children:t,onAllRunsCompleted:l}=e,n=(0,f.v9)(v.sG),i=(0,f.v9)(v.CJ),a=(0,f.v9)(h.IW),o=(0,c.useRef)(new Set),d=(0,c.useRef)([]),u=(0,c.useRef)(!1),m=(0,c.useRef)(new Set),p=(0,c.useRef)(null);return(0,c.useEffect)(()=>{let e=Object.values(n),t=new Set(Object.keys(n));for(let e of m.current)if(!t.has(e)){let t=null==i?void 0:i[e];t&&t.state===j.a.DONE&&!o.current.has(e)&&(o.current.add(e),d.current.push({runId:e,savedItemId:t.saved_item_id||void 0}))}if(m.current=t,e.length>0){u.current=!0;return}u.current&&d.current.length>0&&a!==r.IG.PROCESSING&&(p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{let e=x.Z.getState(),t=y((0,h.by)(e),Array.from(o.current)),s=(0,v.sG)(e);if(d.current.length>0&&0===Object.keys(s).length&&t){let e=new Map;for(let t of d.current)e.set(t.runId,t);let t=Array.from(e.values()).map(e=>e.runId),s=Array.from(e.values()).map(e=>e.savedItemId||"");try{null==l||l(t,s)}finally{d.current=[],o.current.clear(),u.current=!1,p.current=null}}else p.current=null},1e3))},[n,i,a,l]),(0,c.useEffect)(()=>()=>{p.current&&clearTimeout(p.current)},[]),(0,s.jsx)(c.Fragment,{children:t})};var N=e=>{let{children:t,onAllRunsCompleted:l}=e;return(0,s.jsx)(g.x,{children:(0,s.jsx)(b,{onAllRunsCompleted:l,children:t})})};let y=(e,t)=>{if(!e||0===t.length)return!1;if(e.role===r.lB.HIDDEN_USER)return!0;if(e.role===r.lB.USER)return!1;if(e.role===r.lB.ASSISTANT&&e.parts){let l=e.parts.filter(e=>{var t,l;return e.type===p.S.TOOL_INVOCATION&&(null===(l=e.result)||void 0===l?void 0:null===(t=l.result)||void 0===t?void 0:t.run_id)}).map(e=>{var t,l;return null===(l=e.result)||void 0===l?void 0:null===(t=l.result)||void 0===t?void 0:t.run_id}).filter(e=>null!=e);return t.some(e=>l.includes(e))}return!1};var C=e=>{var t,l;let{children:x,onAllRunsCompleted:h}=e,{userProfile:p,idTokenRef:v}=(0,m.H)(),f=(0,a.TL)(),g=(0,a.CG)(d.po),j=(0,a.CG)(n.IW),{abortCoreGummieCompletion:b}=(0,u.J)();return(0,o.Y)({userProfile:p,idToken:null!==(l=v.current)&&void 0!==l?l:""},{skip:(null==p?void 0:p.isLoading())||!v.current}),(0,i.O5)({userProfile:p,idToken:v.current,organizationId:null===(t=p.organization)||void 0===t?void 0:t.id},{skip:p.isLoading()}),(0,c.useEffect)(()=>{(null==p?void 0:p.user_id)&&g===d.JU.IDLE&&f((0,d.OU)({userProfile:p}))},[p,g,f]),(0,c.useEffect)(()=>(j===r.IG.PROCESSING&&b(),()=>{j===r.IG.PROCESSING&&b()}),[]),(0,s.jsx)(N,{onAllRunsCompleted:h,children:x})}},54348:function(e,t,l){var s=l(85893),n=l(67294),r=l(49200),i=l(64127);t.Z=e=>{let{form:t}=e;return(0,s.jsx)(n.Fragment,{children:(0,s.jsx)(r.l0,{...t,children:(0,s.jsx)("form",{onSubmit:e=>e.preventDefault(),children:(0,s.jsx)("div",{className:"flex flex-col gap-5",children:(0,s.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row",children:[(0,s.jsx)(r.Wi,{control:t.control,name:"firstName",render:e=>{let{field:t}=e;return(0,s.jsxs)(r.xJ,{className:"flex-1",children:[(0,s.jsx)(r.lX,{children:"First Name"}),(0,s.jsx)(r.NI,{children:(0,s.jsx)(i.I,{placeholder:"Enter your first name",...t})}),(0,s.jsx)(r.zG,{})]})}}),(0,s.jsx)(r.Wi,{control:t.control,name:"lastName",render:e=>{let{field:t}=e;return(0,s.jsxs)(r.xJ,{className:"flex-1",children:[(0,s.jsx)(r.lX,{children:"Last Name"}),(0,s.jsx)(r.NI,{children:(0,s.jsx)(i.I,{placeholder:"Enter your last name",...t})}),(0,s.jsx)(r.zG,{})]})}})]})})})})})}},88507:function(e,t,l){l(85893),l(48491),l(22495),l(67294),l(29876),l(22896),l(14142),l(81732)},33682:function(e,t,l){l.d(t,{x:function(){return m}});var s=l(85893),n=l(22495),r=l(62685),i=l(77739),a=l(67294),o=l(41248),d=l(75318),c=l(45837);let u=(0,a.createContext)(null),m=e=>{let{children:t}=e,l=(0,o.v9)(i.sG),{userProfile:m,idTokenRef:x}=(0,a.useContext)(c.f),h=(0,n.TL)();return(0,a.useEffect)(()=>{let e;let t=async()=>{for(let e in l)try{let t=await d.U.loadRun(e,m,x.current);t&&h((0,r.dj)({plRun:t,savedItem:{saved_item_id:l[e].saved_item_id,name:l[e].saved_item_name,is_saved:()=>!!l[e].saved_item_id},flowbook:{flowbook_id:l[e].flowbook_id,is_saved:()=>!!l[e].flowbook_id}}))}catch(t){console.log("Failed to update run ".concat(e,": ").concat(t))}};return Object.keys(l).length>0&&(e=setInterval(t,2e3)),()=>{e&&clearInterval(e)}},[l,h,m,x]),(0,s.jsx)(u.Provider,{value:{activePipelineRuns:l},children:t})}},67912:function(e,t,l){var s=l(48491),n=l(82141),r=l(22495),i=l(67294),a=l(27379),o=l(97257),d=l(45837),c=l(99882),u=l(90273);t.Z=()=>{var e;let t=(0,r.TL)(),{userProfile:l,idTokenRef:m}=(0,d.H)(),{currentProject:x}=(0,o.d2)(),h=(0,r.CG)(s.IW),p=(0,r.CG)(n.gf),v=(0,a.useParams)(),f=null!==(e=null==v?void 0:v.gummie_id)&&void 0!==e?e:p,g=null==v?void 0:v.interaction_id,[j,b]=(0,i.useState)(!1),[N,y]=(0,i.useState)(null),[C,_]=(0,i.useState)(void 0),w=(0,i.useRef)({gummie_id:null,interaction_id:null}),S=(0,i.useCallback)(async()=>{if(f&&g&&"onboarding"!==g&&l.isLoggedIn()&&m.current&&h!==c.t.PROCESSING)try{let e=(null==x?void 0:x.project_id)?"?project_id=".concat(x.project_id):"",n=await (0,u.eN)("gummies/".concat(f,"/chat/").concat(g).concat(e),l,m.current,"GET"),r={id:n.interaction_id,msgs:n.messages||[],participants:n.participants||{}};t((0,s.OZ)(r)),t((0,s.yg)(n.state)),_(new c.w(n)),y(null)}catch(e){y(e)}},[f,g,l,m,null==x?void 0:x.project_id,h,t]);return(0,i.useEffect)(()=>{if(!g){w.current={gummie_id:null,interaction_id:null},_(void 0);return}(w.current.interaction_id!==g||w.current.gummie_id!==f)&&f&&(b(!0),w.current={gummie_id:f,interaction_id:g},S().finally(()=>b(!1)))},[g,f,S]),(0,i.useEffect)(()=>{if(h!==c.t.ASYNC_PROCESSING)return;let e=setInterval(()=>{S()},5e3);return()=>clearInterval(e)},[h,S]),{data:C,isLoading:j,error:N,isAsyncProcessing:h===c.t.ASYNC_PROCESSING,interaction_id:g,refetch:S}}},43024:function(e,t,l){var s=l(82141),n=l(22495),r=l(67294),i=l(27379),a=l(821),o=l(97257),d=l(45837),c=l(99882);t.Z=(e,t)=>{var l;let{userProfile:u,idTokenRef:m}=(0,d.H)(),{currentProject:x}=(0,o.d2)(),h=(0,n.CG)(s.gf),p=(0,i.useParams)(),v=null!==(l=null!=e?e:null==p?void 0:p.gummie_id)&&void 0!==l?l:h,f=null!=t?t:null==p?void 0:p.interaction_id,g=(null==x?void 0:x.project_id)?"?project_id=".concat(x.project_id):"",{data:j,isLoading:b,error:N,refetch:y}=(0,a.DV)({path:"gummies/".concat(v,"/chat/").concat(f).concat(g),queryKey:["GummiesChatIndividual",null!=v?v:"",null!=f?f:""],options:{enabled:!!v&&!!f&&u.isLoggedIn()&&!!m.current}});return{data:(0,r.useMemo)(()=>{if(j)return new c.w(j)},[j]),name:null==j?void 0:j.name,isLoading:b,error:N,refetch:y,gummieId:v,interactionId:f}}},47640:function(e,t,l){var s=l(67294),n=l(78551),r=l(45837),i=l(90273);t.Z=e=>{let{userProfile:t,idTokenRef:l}=(0,r.H)(),{filters:a=[],enabled:o=!0,...d}=null!=e?e:{},c=(0,n.a)({queryKey:["gumcp-servers",a],queryFn:async()=>{let e=new URLSearchParams;a.length>0&&e.set("filters",a.join(","));let s=e.toString()?"gumcp_declarations?".concat(e):"gumcp_declarations",[n,r]=await Promise.all([(0,i.Mu)("get_gumcp_server_list",t,"GET",null,l.current),(0,i.Mu)(s,t,"GET",null,l.current)]),o=new Map(r.map(e=>[e.server_id,e]));return{servers:Object.values(n).filter(e=>!(a.length>0)||o.has(e.id)).map(e=>{let t=o.get(e.id);return{...e,category:null==t?void 0:t.category,secretTypes:null==t?void 0:t.secret_types,optionalSecrets:null==t?void 0:t.optional_secrets,isRestricted:null==t?void 0:t.is_restricted}})}},enabled:!(null==t?void 0:t.isLoading())&&o,...d}),u=(0,s.useMemo)(()=>{var e,t;let l=new Map;for(let s of null!==(t=null===(e=c.data)||void 0===e?void 0:e.servers)&&void 0!==t?t:[])l.set(s.id,s);return l},[c.data]);return{...c,serverMap:u}}}}]);