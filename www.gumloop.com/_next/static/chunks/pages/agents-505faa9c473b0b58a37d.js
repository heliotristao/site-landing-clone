(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1013],{68038:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/agents",function(){return l(3811)}])},3811:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return eU}});var r,o,a=l(85893),n=l(67294),s=l(9008),i=l.n(s),d=l(96888),c=l(10869),u=l(22495),m=l(13889),p=l(69245),g=l(77096),f=l(71751),h=l(36298),x=l(30202),v=l(64712),_=l(29876),j=l(34357),y=l(18289),w=l(76345),C=l(53695),k=l(98859),b=l(52695),T=l(98641),N=l(45573),F=l(37864),I=l(12852),A=l(86762),E=l(5357);let M={entityName:"agent",entityNamePlural:"agents",folderType:"GUMMIE",getEntityId:e=>e.gummie_id,getEntityName:e=>e.name,getEntityFolderId:e=>{var t;return null!==(t=e.folder_id)&&void 0!==t?t:null},getEntityHref:e=>"/agents/".concat(e.gummie_id),getEntityCreatedTs:e=>e.created_ts?e.created_ts.toString():null,getEntityAuthorId:e=>e.author_id,getCreatorDisplayName:e=>e.creator_first_name&&e.creator_last_name?"".concat(e.creator_first_name," ").concat(e.creator_last_name):e.creator_first_name?e.creator_first_name:e.creator_user_email?e.creator_user_email:"Unknown",getCreatorProfilePicture:e=>{var t;return null!==(t=e.creator_profile_picture)&&void 0!==t?t:null},getFolderId:e=>{var t;return null!==(t=e.folder_id)&&void 0!==t?t:""},getFolderName:e=>e.name,getFolderParentId:e=>e.parent_folder_id,getEntityIcon:e=>{var t;return(0,a.jsx)(E.Z,{iconUrl:null===(t=e.metadata)||void 0===t?void 0:t.icon_url,alt:e.name,size:"sm"})},features:{canMoveToWorkspace:!0,canMoveToFolder:!0,canDuplicate:!0,canShare:!0,canCreateTemplate:!0,canEditDescription:!1},getEntityActions:(e,t)=>[{id:"share",label:"Share",Icon:j.Z,onClick:()=>{t.onShare(),t.closeDropdown()}},{id:"copy-link",label:"Copy Link",Icon:y.Z,onClick:()=>{t.onCopyLink(),t.closeDropdown()},condition:!0},{id:"rename",label:"Rename",Icon:w.Z,onClick:()=>{t.onRename(),t.closeDropdown()}},{id:"duplicate",label:"Duplicate",Icon:C.Z,onClick:()=>{t.onDuplicate(),t.closeDropdown()}},{id:"move-to-folder",label:"Move to Folder",Icon:k.Z,onClick:()=>{t.onMoveToFolder(),t.closeDropdown()}},{id:"move-to-parent",label:"Move to Parent Folder",Icon:b.Z,onClick:()=>{t.onMoveToParent(),t.closeDropdown()}},{id:"move-to-workspace",label:"Move to Workspace",Icon:T.Z,onClick:()=>{t.onMoveToWorkspace(),t.closeDropdown()}},{id:"create-template",label:"Create Template",Icon:N.Z,onClick:()=>{t.onCreateTemplate(),t.closeDropdown()}},{id:"delete",label:"Delete",Icon:F.Z,onClick:()=>{t.onDelete(),t.closeDropdown()},destructive:!0}],getFolderActions:(e,t)=>[{id:"rename",label:"Rename",Icon:w.Z,onClick:()=>{t.onRename(),t.closeDropdown()}},{id:"move-to-parent",label:"Move To Parent Folder",Icon:I.Z,onClick:()=>{t.onMoveToParent(),t.closeDropdown()}},{id:"delete",label:"Delete",Icon:A.Z,onClick:()=>{t.onDelete(),t.closeDropdown()},destructive:!0}]};var D=l(98150);function S(e){let{open:t,onOpenChange:l,entity:r,entities:o,entityType:s,entityTypePlural:i,getName:d,onDelete:c,onSuccess:u,title:m,description:p}=e,[g,f]=(0,n.useState)(!1),h=o&&o.length>0,x=h?o:r?[r]:[],j=x.length,y=i||"".concat(s,"s"),w=async()=>{if(0===x.length)return;f(!0);let e=h?"".concat(j," ").concat(1===j?s:y):'"'.concat(d(x[0]),'"'),t=v.Am.loading("Deleting ".concat(e,"..."));try{await c(h?o:r),l(!1),v.Am.success("".concat(e," deleted successfully!"),{id:t}),null==u||u()}catch(l){var a;let e=(null==l?void 0:null===(a=l.data)||void 0===a?void 0:a.error)||(null==l?void 0:l.message)||"Failed to delete ".concat(s);v.Am.error(e,{id:t})}finally{f(!1)}};return r||o&&0!==o.length?(0,a.jsx)(D.Z,{open:t,setOpen:l,title:m||(h?"Delete ".concat(j," ").concat(1===j?s:y,"?"):r?'Delete "'.concat(d(r),'"?'):"Delete ".concat(s,"?")),description:p||(h?"Are you sure you want to delete ".concat(j," ").concat(1===j?s:y,"? This action cannot be undone."):"Are you sure you want to delete this? This action cannot be undone."),onConfirm:w,primaryActionButtonLoading:g,primaryActionButtonVariant:_.f1.DESTRUCTIVE,confirmButtonProps:{text:"Delete"},cancelButtonProps:{text:"Cancel"}}):null}var O=l(9962),Z=l(61298),L=l(97257),P=l(45837),R=l(86453),G=l(41248);let B=()=>{let e=(0,G.I0)(),{userProfile:t,idTokenRef:l}=(0,P.H)(),{currentProject:r}=(0,L.d2)(),[o]=(0,c.YU)(),[a]=(0,c.N3)(),[s]=(0,d.HM)(),i=(0,n.useCallback)(t=>{e(d.qv.util.invalidateTags([{type:"GummiesFolders",id:t||"root"}]))},[e]),u=(0,n.useCallback)(t=>{e(c.y1.util.invalidateTags([{type:"Gummies",id:t}]))},[e]);return{bulkDelete:(0,n.useCallback)(async e=>{let r={successful:[],failed:[]};if(0===e.length)return r;try{var a;let n=e.map(e=>e.gummie_id),s=await o({userProfile:t,idToken:null!==(a=l.current)&&void 0!==a?a:"",gummieIds:n}).unwrap(),d=new Set(s.results.successful.map(e=>e.gummie_id)),c=new Map(s.results.failed.map(e=>[e.gummie_id,e.error]));e.forEach(e=>{d.has(e.gummie_id)?r.successful.push(e):r.failed.push({gummie:e,error:c.get(e.gummie_id)||"Failed to delete agent"})});let u=new Set;r.successful.forEach(e=>{var t;return u.add(null!==(t=e.folder_id)&&void 0!==t?t:null)}),u.forEach(e=>i(e))}catch(t){e.forEach(e=>{var l;r.failed.push({gummie:e,error:(null==t?void 0:null===(l=t.data)||void 0===l?void 0:l.error)||(null==t?void 0:t.message)||"Failed to delete agent"})})}return r},[o,t,l,i]),bulkMoveToFolder:(0,n.useCallback)(async(e,o)=>{let a={successful:[],failed:[]};if(0===e.length)return a;try{let n=e.map(e=>e.gummie_id),i=e.map(e=>{var t;return null!==(t=e.folder_id)&&void 0!==t?t:null});await s({userProfile:t,idToken:l.current,gummieIds:n,folderId:o,oldFolderIds:i,gummiesData:e,projectId:null==r?void 0:r.project_id}).unwrap(),a.successful=[...e]}catch(t){e.forEach(e=>{var l;a.failed.push({gummie:e,error:(null==t?void 0:null===(l=t.data)||void 0===l?void 0:l.error)||(null==t?void 0:t.message)||"Failed to move agent"})})}return a},[s,t,l,null==r?void 0:r.project_id]),bulkMoveToWorkspace:(0,n.useCallback)(async(e,r)=>{let o={successful:[],failed:[]};if(0===e.length)return o;let n=r||t.user_id;try{var s;let r=e.map(e=>e.gummie_id),d=await a({userProfile:t,idToken:null!==(s=l.current)&&void 0!==s?s:"",gummieIds:r,newAuthorId:n}).unwrap(),c=new Set(d.results.filter(e=>"success"===e.status).map(e=>e.gummie_id)),m=new Map(d.results.filter(e=>"error"===e.status).map(e=>[e.gummie_id,e.error||"Failed to move agent"]));e.forEach(e=>{c.has(e.gummie_id)?o.successful.push(e):o.failed.push({gummie:e,error:m.get(e.gummie_id)||"Failed to move agent"})});let p=new Set;o.successful.forEach(e=>{var t;return p.add(null!==(t=e.folder_id)&&void 0!==t?t:null)}),p.forEach(e=>i(e));let g=new Set;o.successful.forEach(e=>g.add(e.author_id)),g.add(n),g.forEach(e=>u(e))}catch(t){e.forEach(e=>{var l;o.failed.push({gummie:e,error:(null==t?void 0:null===(l=t.data)||void 0===l?void 0:l.error)||(null==t?void 0:t.message)||"Failed to move agent"})})}return o},[a,t,l,i,u])}};var W=l(51893);let z=()=>{let e=(0,u.TL)(),{userProfile:t,idTokenRef:l}=(0,P.H)(),{currentProject:r,isCurrentProjectLoading:o}=(0,L.d2)(),{data:a,isLoading:s}=(0,d.Um)({userProfile:t,idToken:l.current,projectId:null==r?void 0:r.project_id},{skip:t.isLoading()||o}),i=(0,n.useCallback)(t=>{e(d.qv.util.invalidateTags([{type:"GummiesFolders",id:t||"root"}]))},[e]),c=(0,W.d)({folderTreeData:a,isFolderTreeLoading:s,onInvalidateTags:i}),{currentData:m,isLoading:p,isFetching:g}=(0,d.zQ)({userProfile:t,idToken:l.current,folderId:c.currentFolderId,folderType:"GUMMIE",projectId:null==r?void 0:r.project_id},{skip:t.isLoading()||o}),f=t.isLoading()||o||p||!m&&g||null!==c.currentFolderId&&s;return{...c,folders:(null==m?void 0:m.folders)||[],gummies:(null==m?void 0:m.gummies)||[],isLoading:f,isFetching:g}};var V=l(69386),q=l(59100);(r=o||(o={})).CREATOR="creator",r.TOOL="tool",r.FLOW="flow";let U={keys:["name","description"],threshold:.3,ignoreLocation:!0},H=e=>{let{agents:t}=e,l=(0,u.CG)(m.SN.selectMCPDeclarationsMap),{updateParam:r,removeParams:o,currentParams:a}=(0,q.W)(),s=(0,n.useRef)(),[i,d]=(0,n.useState)(a.search||""),c=a.search||"";(0,n.useEffect)(()=>{d(c)},[c]);let p=(0,n.useMemo)(()=>{let e={};return a.creator&&(e.creator=a.creator),a.tool&&(e.tool=a.tool),a.flow&&(e.flow=a.flow),e},[a]),g=(0,n.useMemo)(()=>[{key:"creator",extractValue:e=>e.creator_user_id||"",getOptions:e=>{let t=new Map;return e.forEach(e=>{e.creator_user_id&&e.getCreatorDisplayName()&&t.set(e.creator_user_id,e.getCreatorDisplayName())}),Array.from(t.entries()).map(e=>{let[t,l]=e;return{value:t,label:l}}).sort((e,t)=>e.label.localeCompare(t.label))},label:"Creator"},{key:"tool",extractValue:e=>e.tools&&0!==e.tools.length?e.tools.map(e=>e.server_id).filter(e=>!!e).filter((e,t,l)=>l.indexOf(e)===t).join(","):"",getOptions:e=>{let t=new Set;return e.forEach(e=>{e.tools&&e.tools.forEach(e=>{e.server_id&&t.add(e.server_id)})}),Array.from(t).map(e=>{var t;return{value:e,label:(null===(t=l.get(e))||void 0===t?void 0:t.category)||e}}).sort((e,t)=>e.label.localeCompare(t.label))},label:"Tool"},{key:"flow",extractValue:e=>e.tools&&0!==e.tools.length?e.tools.map(e=>e.saved_item_id).filter(e=>!!e).filter((e,t,l)=>l.indexOf(e)===t).join(","):"",getOptions:e=>{let t=new Map;return e.forEach(e=>{e.tools&&e.tools.forEach(e=>{e.saved_item_id&&e.name&&t.set(e.saved_item_id,e.name)})}),Array.from(t.entries()).map(e=>{let[t,l]=e;return{value:t,label:l}}).sort((e,t)=>e.label.localeCompare(t.label))},label:"Flow"}],[l]),f=(0,n.useMemo)(()=>new V.Z(t,U),[t]),h=(0,n.useCallback)(e=>{d(e),s.current&&clearTimeout(s.current),s.current=setTimeout(()=>{e.trim()?r("search",e):o(["search"])},300)},[r,o]);(0,n.useEffect)(()=>()=>{s.current&&clearTimeout(s.current)},[]);let x=(0,n.useCallback)((e,t)=>{t?r(e,t):o([e])},[r,o]),v=(0,n.useCallback)(e=>{o([e])},[o]),_=(0,n.useCallback)(()=>{o(["creator","tool","flow"])},[o]),j=(0,n.useCallback)(e=>{let l=g.find(t=>t.key===e);return l?l.getOptions(t):[]},[t,g]),y=(0,n.useMemo)(()=>{let e=c.trim()?f.search(c).map(e=>e.item):t;return Object.keys(p).length>0?e.filter(e=>g.every(t=>{let{key:l,extractValue:r}=t,o=p[l];if(!o)return!0;let a=r(e);return"tool"===l||"flow"===l?a.includes(o):a===o})):e},[t,c,p,f,g]),w=(0,n.useMemo)(()=>Object.keys(p).filter(e=>p[e]).length,[p]);return{items:y,filters:{searchTerm:i,setSearchTerm:h,filters:p,setFilter:x,clearFilter:v,clearAllFilters:_,getFilterValues:j,activeFilterCount:w,filterDefinitions:g.reduce((e,t)=>(e[t.key]=t,e),{})}}};var K=l(36401),X=l(26567),Y=l(38719),$=l(50855),Q=l(98532),J=l(59654),ee=l(2689),et=l(7597),el=l.n(et),er=l(7161),eo=l(64127),ea=l(54178),en=e=>{let{open:t,onOpenChange:l,children:r,parentFolderId:o,onSuccess:s}=e,[i,c]=(0,ea.P)({open:t,onOpenChange:l}),{userProfile:u,idTokenRef:m}=(0,n.useContext)(P.f),{currentProject:p}=(0,n.useContext)(L.xI),[g,{isLoading:f}]=(0,d.mv)(),h=async e=>{let t=v.Am.loading("Creating folder...");try{let l=(null==p?void 0:p.project_id)||u.user_id,r=el()().new();c(!1),await g({userProfile:u,idToken:m.current,folderId:r,name:e,parentFolderId:void 0!==o?o:null,authorId:l,projectId:null==p?void 0:p.project_id}).unwrap(),v.Am.success("Folder ".concat(e," created successfully!"),{id:t}),null==s||s()}catch(e){v.Am.error("Error creating folder: ".concat(e.message),{id:t})}};return(0,a.jsxs)(er.Vq,{open:i,onOpenChange:c,children:[r&&(0,a.jsx)(er.hg,{asChild:!0,children:r}),(0,a.jsx)(er.cZ,{children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),f||h(new FormData(e.target).get("folder-name"))},children:[(0,a.jsxs)(er.a7,{children:[(0,a.jsx)(er.fK,{children:(0,a.jsx)(er.$N,{children:"Create a Folder For Your Agents"})}),(0,a.jsx)("div",{children:(0,a.jsx)(eo.I,{id:"folder-name",name:"folder-name",required:!0})})]}),(0,a.jsxs)(er.cN,{children:[(0,a.jsx)(er.GG,{children:(0,a.jsx)(_.zx,{type:"button",variant:"ghost",disabled:f,children:"Cancel"})}),(0,a.jsx)(_.zx,{type:"submit",disabled:f,children:"Create"})]})]})})]})},es=e=>{let{folder:t,open:l,setOpen:r,onSuccess:o}=e,{userProfile:s,idTokenRef:i}=(0,n.useContext)(P.f),[c,{isLoading:u}]=(0,d.t9)(),m=async e=>{let l=v.Am.loading("Renaming your folder...");try{await c({userProfile:s,idToken:i.current,folderId:t.folder_id,name:e,parentFolderId:t.parent_folder_id}).unwrap(),v.Am.success("Folder renamed successfully!",{id:l}),r(!1),null==o||o()}catch(e){v.Am.error("".concat(e.message||"Failed to rename folder"),{id:l})}};return(0,a.jsx)(er.Vq,{open:l,onOpenChange:r,children:(0,a.jsx)(er.cZ,{onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),u||m(new FormData(e.target).get("folder-name"))},children:[(0,a.jsxs)(er.a7,{children:[(0,a.jsx)(er.fK,{children:(0,a.jsx)(er.$N,{className:"text-lg font-semibold",children:"Rename Your Folder"})}),(0,a.jsx)("div",{children:(0,a.jsx)(eo.I,{id:"folder-name",name:"folder-name",placeholder:"Enter your new folder name",defaultValue:(null==t?void 0:t.name)||"",required:!0})})]}),(0,a.jsxs)(er.cN,{children:[(0,a.jsx)(_.zx,{variant:"ghost",onClick:()=>{r(!1)},disabled:u,children:"Cancel"}),(0,a.jsx)(_.zx,{type:"submit",disabled:u,children:"Continue"})]})]})})})},ei=l(26824),ed=l(28643),ec=l(18998),eu=l(5197),em=l(92290),ep=l(48819),eg=l(69307),ef=l(63455);let eh=(e,t,l)=>{let r=null==t?void 0:t.find(t=>t.target_id===e.gummie_id),o=(null==r?void 0:r.creator_user_id)===l;return!!r&&(!!o||r.status===ei.C.APPROVED)&&{template:r,isCreator:o,isMarketplaceTemplate:!r.organization_id}},ex=e=>e.name?e.name:e.type===ed.y.IMAGE_GENERATOR?"Image Generation":e.type===ed.y.WEB_SEARCH?"Web Search":e.type===ed.y.SANDBOX?"Code Sandbox":e.saved_item_id?"Flow":"Tool",ev=(e,t)=>{let l={};return e.forEach(e=>{let r=ex(e),o="";if(e.type===ed.y.IMAGE_GENERATOR)o="image_generator_tool";else if(e.type===ed.y.WEB_SEARCH)o="web_search_tool";else if(e.type===ed.y.SANDBOX)o="code_sandbox_tool";else if(e.saved_item_id)o="saved_item_tool";else if(e.server_id){var a;let l=t.get(e.server_id);o=null!==(a=null==l?void 0:l.category)&&void 0!==a?a:"mega_node"}else o="mega_node";l[r]=[o,1]}),l},e_=e=>{let{templates:t,totalItems:l,userId:r,currentProjectId:o,mcpDeclarationsMap:n,onDelete:s,onShare:i,onMoveToWorkspace:d}=e;return[{accessorKey:"name",header:"Agents • ".concat(l),accessorFn:e=>e.name||"",enableSorting:!0,sortingFn:"text",meta:{columnClasses:"w-1/2"},cell:e=>{var l,o;let{row:n}=e,s=n.original,i=eh(s,t,r),d=(null===(l=s.description)||void 0===l?void 0:l.trim())||(null===(o=s.system_prompt)||void 0===o?void 0:o.trim());return(0,a.jsxs)("div",{className:"my-auto flex min-w-0 flex-col items-start",children:[(0,a.jsx)("p",{className:"w-full truncate text-sm font-medium",children:s.name}),(0,a.jsxs)("div",{className:(0,ec.cn)("flex w-full min-w-0 flex-row items-center gap-1",i&&"pt-0.5"),children:[i&&(0,a.jsx)(eg.O,{status:i.template.status,isCreator:i.isCreator,isMarketplaceTemplate:i.isMarketplaceTemplate}),d&&(0,a.jsx)("p",{className:"text-muted-foreground min-w-0 flex-1 truncate text-sm",children:d})]})]})}},{accessorKey:"tools",header:"Tools",meta:{columnClasses:"hidden md:table-cell"},enableSorting:!1,cell:e=>{let{row:t}=e,l=t.original;if(!l.tools||0===l.tools.length)return null;let r=ev(l.tools,n);return(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsx)(em.Z,{keyOperators:r,maxOperators:4})})}},{accessorKey:"creator_user_id",header:"Creator",meta:{columnClasses:(0,ec.cn)("hidden md:table-cell",!o&&"!hidden")},enableSorting:!1,cell:e=>{let{row:t}=e,l=t.original;if(!l.creator_user_id)return(0,a.jsx)("span",{className:"text-border text-xs",children:"—"});let o=l.creator_first_name&&l.creator_last_name?"".concat(l.creator_first_name," ").concat(l.creator_last_name):l.creator_first_name||l.creator_user_email||"Unknown";return(0,a.jsx)(ep.Z,{name:o,src:l.creator_profile_picture,isSelf:l.creator_user_id===r})}},{accessorKey:"created_ts",header:"Created",accessorFn:e=>{let t=e.created_ts;return t?new Date(t):null},meta:{columnClasses:"hidden lg:table-cell"},enableSorting:!0,sortingFn:"datetime",cell:e=>{var t;let{row:l}=e,r=l.original;return(0,a.jsx)("div",{className:"flex items-center gap-3",children:(0,a.jsx)("span",{className:"text-muted-foreground flex-none text-sm",children:r.created_ts?(0,eu.p6)((null===(t=r.created_ts)||void 0===t?void 0:t.toString())||""):""})})}},{id:"actions",header:"",cell:e=>{let{row:t}=e,l=t.original;return(0,a.jsx)("div",{className:"flex items-center justify-end gap-3",children:(0,a.jsx)(ef.Z,{agent:l,onDelete:()=>s(l),onShare:()=>i(l),onMoveToWorkspace:()=>d(l)})})}}]};var ej=l(32578),ey=l(93713),ew=l(36127),eC=l(70563),ek=l(8267),eb=l(28979),eT=l(92437),eN=l(26659),eF=l(50016);function eI(e){let{open:t,onOpenChange:r,agents:o,onMove:s,onSuccess:i}=e,{userProfile:d,idTokenRef:c}=(0,P.H)(),{currentProject:u}=(0,L.d2)(),m=(0,G.I0)(),[p,g]=(0,n.useState)(),[f,h]=(0,n.useState)(!1),[x,j]=(0,n.useState)(!1),[y,w]=(0,n.useState)([]),[C,k]=(0,ea.P)({open:t,onOpenChange:r});(0,n.useEffect)(()=>{t&&o.length>0?w(o):t||w([])},[t,o]);let b=(0,G.v9)(ey.ak),N=(0,G.v9)(ey._I);(0,n.useEffect)(()=>{d.isLoggedIn()&&"idle"===b&&m((0,ey.bl)({userProfile:d,idToken:c.current}))},[d,b,m,c]);let F=y.length>0?y:o,I=(0,n.useMemo)(()=>{let e=N.filter(e=>e.project_id!==(null==u?void 0:u.project_id));return[new(l(78618)).IK({project_name:"Personal",project_id:"personal"}),...e.sort((e,t)=>(null==e?void 0:e.project_name.localeCompare((null==t?void 0:t.project_name)||""))||0)].filter(e=>"personal"===e.project_id?F.some(e=>e.author_id!==d.user_id):F.some(t=>t.author_id!==e.project_id))},[N,null==u?void 0:u.project_id,F,d.user_id]),[A,E,M]=(0,eN.X)(I,{searchKeys:["project_name"]}),S=async()=>{if(h(!1),!p){v.Am.error("Please select a workspace");return}if(0===F.length){v.Am.error("No agents selected");return}j(!0);let e=v.Am.loading("Moving ".concat(F.length," ").concat((0,eu.Ri)(F.length,"agent"),"..."));try{let t="personal"===p.project_id?void 0:p.project_id,l=await s(F,t);k(!1),0===l.failed.length?v.Am.success("".concat(l.successful.length," ").concat((0,eu.Ri)(l.successful.length,"agent"),' moved to "').concat(p.project_name,'" successfully!'),{id:e}):l.successful.length>0?v.Am.success("".concat(l.successful.length," ").concat((0,eu.Ri)(l.successful.length,"agent")," moved successfully. ").concat(l.failed.length," failed."),{id:e}):v.Am.error("Failed to move ".concat((0,eu.Ri)(l.failed.length,"agent")),{id:e}),null==i||i()}catch(t){v.Am.error("Failed to move agents: ".concat(t.message),{id:e})}finally{j(!1),g(void 0)}};if(0===F.length)return null;let O="Move ".concat(F.length," ").concat((0,eu.Ri)(F.length,"Agent")," to Workspace"),Z="Change owner of ".concat(F.length," ").concat((0,eu.Ri)(F.length,"agent"),"?"),R='Moving these agents to "'.concat(null==p?void 0:p.project_name,'" will change the owner. You will not be able to undo this action unless you have administrator permissions in "').concat(null==p?void 0:p.project_name,'".');return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(er.Vq,{open:C,onOpenChange:k,children:(0,a.jsxs)(er.cZ,{className:"max-h-3/4 max-w-2xl",children:[(0,a.jsxs)(er.a7,{children:[(0,a.jsx)(er.fK,{children:(0,a.jsxs)(er.$N,{className:"flex items-center gap-2",children:[(0,a.jsx)(T.Z,{}),O]})}),(0,a.jsxs)("p",{className:"text-muted-foreground text-xs",children:["Currently in:"," ",(0,a.jsx)("span",{className:"text-foreground font-medium",children:(null==u?void 0:u.project_name)||"Personal"})]}),(0,a.jsx)(eo.I,{placeholder:"Search workspaces...",value:A,LeadingIcon:ew.Z,type:"search",onChange:e=>E(e.target.value)}),0===M.length&&(0,a.jsx)(eF.Z,{title:"No workspaces found",description:"No workspaces found".concat(A?" for '".concat(A,"'"):""),Icon:eC.Z,className:"py-16"}),M.length>0&&(0,a.jsx)(eT.E,{value:(null==p?void 0:p.project_id)||"none",onValueChange:e=>{g(I.find(t=>t.project_id===e))},className:"max-h-96 gap-0 divide-y overflow-y-auto rounded-lg border",children:M.map(e=>{let t=(null==p?void 0:p.project_id)===e.project_id,l="personal"===e.project_id;return(0,a.jsxs)("label",{htmlFor:"workspace-".concat(e.project_id),className:(0,ec.cn)("flex cursor-pointer items-center gap-3 p-3 transition-colors",!t&&"hover:bg-muted/50"),children:[l?(0,a.jsx)(ek.Z,{className:"size-4 flex-none"}):(0,a.jsx)(eb.Z,{className:"size-4 flex-none"}),(0,a.jsx)("span",{className:"flex-1 text-sm font-medium",children:e.project_name}),(0,a.jsx)(eT.m,{value:e.project_id,id:"workspace-".concat(e.project_id)})]},e.project_id)})})]}),(0,a.jsxs)(er.cN,{className:"flex items-center justify-between",children:[(0,a.jsx)(er.GG,{asChild:!0,children:(0,a.jsx)(_.zx,{type:"button",variant:"ghost",disabled:x,children:"Cancel"})}),(0,a.jsx)(_.zx,{onClick:()=>{p&&"personal"!==p.project_id?h(!0):S()},disabled:!p||x,children:x?"Moving...":"Move"})]})]})}),(0,a.jsx)(D.Z,{open:f,setOpen:h,title:Z,description:R,onConfirm:S,onCancel:()=>h(!1),primaryActionButtonVariant:_.f1.DEFAULT,confirmButtonProps:{text:"Move to Workspace"},cancelButtonProps:{text:"Cancel"}})]})}var eA=l(821),eE=l(52338),eM=l(1461),eD=()=>{var e;let{userProfile:t}=(0,P.H)(),{data:l,isLoading:r}=(0,eA.iZ)({path:"/gummies/templates",queryKey:["gummies/templates"],options:{enabled:!t.isLoading()}}),o=(0,u.CG)(m.SN.selectMCPDeclarationsMap),s=(0,u.CG)(g.xC.selectTemplateByTargetIdMap),i=(0,n.useMemo)(()=>{var e;return null==l?void 0:null===(e=l.gummies)||void 0===e?void 0:e.map(e=>new eE.a({name:e.name,model_name:e.model_name,system_prompt:e.system_prompt,tools:e.tools,resources:e.resources,metadata:e.metadata,gummie_id:e.gummie_id}))},[l]);return!r&&(null==l?void 0:null===(e=l.gummies)||void 0===e?void 0:e.length)===0||t.isLoading()?null:(0,a.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,a.jsx)("div",{className:"flex flex-row items-center gap-2",children:(0,a.jsxs)("div",{className:"flex flex-1 flex-col gap-0.75",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold",children:"Recommended agents for you to try"}),(0,a.jsx)("span",{className:"text-muted-foreground text-sm",children:"These agents are recommended to get you started with Gumloop."})]})}),(0,a.jsx)("div",{className:"grid grid-cols-1 items-stretch gap-4 md:grid-cols-2 lg:grid-cols-3",children:r?Array.from({length:3}).map((e,t)=>(0,a.jsx)(eM.w,{},t)):null==i?void 0:i.map(e=>(0,a.jsx)(eM.Z,{agent:e,mcpDeclarationsMap:o,template:s.get(e.gummie_id)||null},e.gummie_id))})]})},eS=l(39608),eO=l(1998),eZ=l(42171),eL=l(70384),eP=l(36454),eR=l(87111),eG=l(81687),eB=l(18272),eW=l(97387),ez=l(98692),eV=e=>{let{filters:{searchTerm:t,filters:{creator:l,tool:r,flow:s},setSearchTerm:i,setFilter:d,clearAllFilters:c,getFilterValues:u,activeFilterCount:m,filterDefinitions:p}}=e,g=u(o.CREATOR),f=u(o.TOOL),h=u(o.FLOW),x=(0,n.useMemo)(()=>g.length>1||f.length>1||h.length>1,[g.length,f.length,h.length]);return(0,a.jsxs)("div",{className:"xs:flex-nowrap flex w-full min-w-0 flex-wrap items-center gap-3 md:w-auto md:max-w-md md:flex-1 xl:max-w-none xl:flex-row",children:[(0,a.jsx)("div",{className:"relative min-w-0 flex-1",children:(0,a.jsx)(eo.I,{placeholder:"Search agents",LeadingIcon:ew.Z,className:"w-full min-w-0!",value:t,onChange:e=>i(e.target.value),shadow:!0})}),x&&(0,a.jsxs)(eB.J2,{children:[(0,a.jsx)(eB.xo,{asChild:!0,className:"group/popover-trigger",children:(0,a.jsxs)(_.zx,{variant:"outline",shadow:!0,className:"xs:w-fit w-full",children:[m>0?(0,a.jsx)("span",{className:"text-background bg-accent-foreground flex size-4 shrink-0 items-center justify-center rounded-full text-[10px]",children:m}):(0,a.jsx)(eO.Z,{}),(0,a.jsx)("span",{children:"Filters"}),(0,a.jsx)(eZ.Z,{className:"transition-[rotate] duration-200 group-data-[state=open]/popover-trigger:-rotate-180"})]})}),(0,a.jsxs)(eB.yk,{align:"end",className:"flex flex-col !p-0",children:[g.length>1&&(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2 p-3",children:[(0,a.jsxs)(eG._,{className:"text-muted-foreground flex w-40 flex-row items-center gap-2 text-xs",children:[(0,a.jsx)(eL.Z,{className:"h-4 w-4"}),p[o.CREATOR].label]}),(0,a.jsx)(ez.N,{options:g,value:l,placeholder:"Select creator",onSelect:e=>{d(o.CREATOR,e===l?void 0:e)},className:"flex !h-8 !w-48 rounded-sm text-xs shadow-xs"})]}),g.length>1&&(0,a.jsx)(eW.Z,{className:"bg-muted"}),f.length>0&&(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2 p-3",children:[(0,a.jsxs)(eG._,{className:"text-muted-foreground flex w-40 flex-row items-center gap-2 text-xs",children:[(0,a.jsx)(eP.Z,{className:"h-4 w-4"}),p[o.TOOL].label]}),(0,a.jsx)(ez.N,{options:f,value:r,placeholder:"Select Tool",className:"flex !h-8 !w-48 rounded-sm text-xs shadow-xs",onSelect:e=>{e===r?d(o.TOOL,void 0):d(o.TOOL,e)}})]}),f.length>0&&(0,a.jsx)(eW.Z,{className:"bg-muted"}),h.length>0&&(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2 p-3",children:[(0,a.jsxs)(eG._,{className:"text-muted-foreground flex w-40 flex-row items-center gap-2 text-xs",children:[(0,a.jsx)(eR.Z,{className:"h-4 w-4"}),p[o.FLOW].label]}),(0,a.jsx)(ez.N,{options:h,value:s,placeholder:"Select Workflow",className:"flex !h-8 !w-48 rounded-sm text-xs shadow-xs",onSelect:e=>{e===s?d(o.FLOW,void 0):d(o.FLOW,e)}})]}),m>0&&(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)(eW.Z,{className:"bg-muted"}),(0,a.jsx)("div",{className:"flex flex-row items-center justify-end gap-2 p-3",children:(0,a.jsx)(_.zx,{variant:"outline",size:"xs",onClick:()=>{c()},children:"Clear Filters"})})]})]})]})]})},eq=()=>{var e;let t=(0,u.TL)(),{userProfile:l,idTokenRef:r}=(0,P.H)(),{currentProject:o}=(0,L.d2)(),s=(0,x.NL)(),[i,j]=(0,X.I)(),[y,w]=(0,n.useState)(null),[C,k]=(0,n.useState)(null),[b,T]=(0,n.useState)(null),[N,F]=(0,n.useState)(null),[I,{isLoading:A}]=(0,c.Mk)(),{currentFolderId:E,currentPath:G,folders:W,gummies:V,isLoading:q,navigateToFolder:U,navigateToIndex:et,refetch:el}=z(),{deleteFolder:er,moveToParentFolder:eo,moveToSiblingFolder:ea}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{onSuccess:t}=e,{userProfile:l,idTokenRef:r}=(0,P.H)(),{currentProject:o}=(0,L.d2)(),[a,{isLoading:s}]=(0,d.si)(),[i,{isLoading:c}]=(0,d.f1)(),[u,{isLoading:m}]=(0,d.vm)(),[p,{isLoading:g}]=(0,d.t9)(),f=(0,n.useCallback)(async e=>{try{await a({userProfile:l,idToken:r.current,folderId:e.folder_id,parentFolderId:e.parent_folder_id,projectId:null==o?void 0:o.project_id}).unwrap(),v.Am.success("Folder deleted"),null==t||t()}catch(e){throw v.Am.error(e.message||"Failed to delete folder"),e}},[a,l,r,null==o?void 0:o.project_id,t]);return{deleteFolder:f,moveToParentFolder:(0,n.useCallback)(async e=>{try{var a;await i({userProfile:l,idToken:r.current,folderId:e.folder_id,currentParentFolderId:e.parent_folder_id,projectId:null==o?void 0:o.project_id,folderData:{folder_id:e.folder_id,name:e.name,parent_folder_id:e.parent_folder_id,author_id:e.author_id,created_ts:e.created_ts?R.hT.toISO(e.created_ts):null,folder_type:null!==(a=e.folder_type)&&void 0!==a?a:void 0}}).unwrap(),v.Am.success("Folder moved"),null==t||t()}catch(e){throw v.Am.error(e.message||"Failed to move folder"),e}},[i,l,r,null==o?void 0:o.project_id,t]),moveToSiblingFolder:(0,n.useCallback)(async(e,a)=>{try{var n;await u({userProfile:l,idToken:r.current,folderId:e.folder_id,targetFolderId:a,currentParentFolderId:e.parent_folder_id,projectId:null==o?void 0:o.project_id,folderData:{folder_id:e.folder_id,name:e.name,parent_folder_id:e.parent_folder_id,author_id:e.author_id,created_ts:e.created_ts?R.hT.toISO(e.created_ts):null,folder_type:null!==(n=e.folder_type)&&void 0!==n?n:void 0}}).unwrap(),v.Am.success("Folder moved"),null==t||t()}catch(e){throw v.Am.error(e.message||"Failed to move folder"),e}},[u,l,r,null==o?void 0:o.project_id,t]),renameFolder:(0,n.useCallback)(async(e,a)=>{try{await p({userProfile:l,idToken:r.current,folderId:e.folder_id,name:a,projectId:null==o?void 0:o.project_id,parentFolderId:e.parent_folder_id}).unwrap(),v.Am.success("Folder renamed"),null==t||t()}catch(e){throw v.Am.error(e.message||"Failed to rename folder"),e}},[p,l,r,null==o?void 0:o.project_id,t]),isDeleting:s,isMoving:c||m,isRenaming:g}}(),{bulkDelete:ei,bulkMoveToFolder:ed,bulkMoveToWorkspace:ec}=B(),{data:eu,isLoading:em}=(0,d.Um)({userProfile:l,idToken:r.current,projectId:null==o?void 0:o.project_id}),ep=(0,u.CG)(m.SN.selectMCPDeclarationsMap),eg=(0,u.CG)(g.xC.selectAllTemplates),ef=(0,u.CG)(g.xC.selectTemplateByTargetIdMap);(0,p.Y)({userProfile:l,idToken:null!==(e=r.current)&&void 0!==e?e:""},{skip:null==l?void 0:l.isLoading()});let{items:eh,filters:ex}=H({agents:V});(0,K.a)({clearFilters:ex.clearAllFilters});let ev=(0,n.useMemo)(()=>e_({templates:eg,totalItems:eh.length,userId:l.user_id,currentProjectId:null==o?void 0:o.project_id,mcpDeclarationsMap:ep,onDelete:e=>k(e),onShare:e=>T(e),onMoveToWorkspace:e=>F(e)}),[eg,eh.length,l.user_id,null==o?void 0:o.project_id,ep]),ey=(0,n.useCallback)(e=>{U(e)},[U]),ew=(0,n.useCallback)(e=>{w(e)},[]),eC=(0,n.useCallback)(async e=>{await er(e)},[er]),ek=(0,n.useCallback)(async e=>{await eo(e)},[eo]),eb=(0,n.useCallback)(async(e,t)=>{await ea(e,t)},[ea]),eT=(0,n.useCallback)(e=>{et(e)},[et]),eN=(0,n.useCallback)(async e=>{let t=Array.isArray(e)?e:[e];await ei(t),el()},[ei,el]),eF=(0,n.useCallback)(async()=>{var e,a;if(!C)return;let n=v.Am.loading("Deleting agent...");try{await I({userProfile:l,idToken:r.current,gummie_id:C.gummie_id}).unwrap(),(0,$.rB)(Y.Z.DELETED,{gummie_id:C.gummie_id});let a=null!==(e=C.folder_id)&&void 0!==e?e:null;try{t(d.qv.util.updateQueryData("fetchAgentFolderContents",{userProfile:l,idToken:r.current,folderId:a,folderType:"GUMMIE",projectId:null==o?void 0:o.project_id},e=>{e.gummies&&(e.gummies=e.gummies.filter(e=>e.gummie_id!==C.gummie_id))}))}catch(e){t(d.qv.util.invalidateTags([{type:"GummiesFolders",id:a||"root"}]))}s.invalidateQueries({queryKey:["hub","recent",C.author_id]}),v.Am.success("Agent deleted successfully",{id:n}),k(null)}catch(t){let e=(null==t?void 0:null===(a=t.data)||void 0===a?void 0:a.error)||(null==t?void 0:t.message)||"Failed to delete agent";v.Am.error(e,{id:n})}},[C,I,l,r,t,null==o?void 0:o.project_id,s]),eA=(0,n.useCallback)(async(e,t)=>{let l=Array.isArray(e)?e:[e];await ed(l,t),el()},[ed,el]),eE=(0,n.useCallback)(async(e,t)=>{let l=v.Am.loading("Moving agent...");try{(await ed([e],t)).successful.length>0?v.Am.success('Moved "'.concat(e.name,'" to folder'),{id:l}):v.Am.error("Failed to move agent",{id:l}),el()}catch(e){v.Am.error("Failed to move agent",{id:l})}},[ed,el]),eO=(0,n.useMemo)(()=>{if(!(null==eu?void 0:eu.folderTree))return null;let e=t=>{var l;return{folder_id:t.folder_id,name:t.name,children:(null===(l=t.children)||void 0===l?void 0:l.map(e))||[]}};return e(eu.folderTree)},[eu]),eZ={title:"No agents found",description:"Build your first agent to get started",Icon:f.Z,action:(0,a.jsx)(J.Z,{folderId:E})};return(0,a.jsxs)("main",{className:"flex h-fit w-full flex-col gap-6",children:[(0,a.jsx)(ee.Z,{title:"Agents",className:"px-2"}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 px-2 md:flex-row md:items-end md:justify-between",children:[(0,a.jsx)(eV,{filters:ex}),(0,a.jsxs)("div",{className:"flex w-full flex-wrap items-center gap-3 md:w-fit md:shrink-0 md:flex-nowrap",children:[(0,a.jsx)(Q.x,{viewMode:i,onViewModeChange:j}),(0,a.jsx)(en,{parentFolderId:E,children:(0,a.jsxs)(_.zx,{variant:"outline",shadow:!0,className:"hidden md:flex",children:[(0,a.jsx)(h.Z,{}),"Create Folder"]})}),(0,a.jsx)(J.Z,{className:"w-full md:w-fit",folderId:E})]})]}),(0,a.jsx)(Z.X,{view:i,currentFolderPath:G,folders:W,entities:eh,adapter:M,onFolderClick:ey,onBreadcrumbNavigate:eT,onFolderRename:ew,onFolderDelete:eC,onFolderMoveToParent:ek,onMoveToFolder:eE,onFolderMoveToSibling:eb,renderEntityCard:e=>(0,a.jsx)(eM.Z,{agent:e,mcpDeclarationsMap:ep,template:ef.get(e.gummie_id)||null}),entityColumns:ev,currentFolderId:E,isLoading:q,emptyState:eZ,searchTerm:ex.searchTerm,renderBulkMoveToFolderDialog:e=>{let{open:t,onOpenChange:l,entities:r,onSuccess:o,currentFolderId:n}=e;return(0,a.jsx)(O.$,{open:t,onOpenChange:l,entities:r,entityName:"agent",entityNamePlural:"agents",getEntityName:e=>e.name,getEntityFolderId:e=>{var t;return null!==(t=e.folder_id)&&void 0!==t?t:null},folderTree:eO,isLoadingTree:em,currentFolderId:n,rootName:"Agents",onMove:eA,onSuccess:()=>{o(),el()}})},renderBulkMoveToWorkspaceDialog:e=>{let{open:t,onOpenChange:l,entities:r,onSuccess:o}=e;return 1===r.length?(0,a.jsx)(eS.E,{open:t,onOpenChange:l,gummie:r[0],onSuccess:()=>{o(),el()}}):(0,a.jsx)(eI,{open:t,onOpenChange:l,agents:r,onMove:ec,onSuccess:()=>{o(),el()}})},renderBulkDeleteDialog:e=>{let{open:t,onOpenChange:l,entities:r,onSuccess:o}=e;return(0,a.jsx)(S,{open:t,onOpenChange:l,entities:r,entityType:"agent",entityTypePlural:"agents",getName:e=>e.name,onDelete:eN,onSuccess:()=>{o(),el()}})}}),(0,a.jsx)(eD,{}),y&&(0,a.jsx)(es,{folder:y,open:!!y,setOpen:e=>!e&&w(null)}),C&&(0,a.jsx)(D.Z,{open:!!C,setOpen:e=>!e&&k(null),title:"Delete Agent",description:'Are you sure you want to delete "'.concat(C.name,'"? This action cannot be undone.'),onConfirm:eF,primaryActionButtonLoading:A,primaryActionButtonVariant:_.f1.DESTRUCTIVE,confirmButtonProps:{text:"Delete"}}),b&&(0,a.jsx)(ej.Z,{gummie:b,userProfile:l,idToken:r.current,open:!!b,onOpenChange:e=>!e&&T(null)}),N&&(0,a.jsx)(eS.E,{open:!!N,onOpenChange:e=>!e&&F(null),gummie:N,onSuccess:()=>{F(null),el()}})]})},eU=()=>(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)(i(),{children:(0,a.jsx)("title",{children:"Gumloop | Agents"})}),(0,a.jsx)(eq,{})]})},36401:function(e,t,l){"use strict";l.d(t,{a:function(){return i}});var r=l(67294),o=l(11163),a=l(97257),n=l(45837),s=l(59100);let i=e=>{let{clearFilters:t}=e,{userProfile:l}=(0,n.H)(),{addProjectSwitchListener:i,removeProjectSwitchListener:d}=(0,a.d2)(),{removeParams:c}=(0,s.W)(),u=(0,o.useRouter)();return(0,r.useEffect)(()=>{let e;let r=r=>{e=setTimeout(()=>{let e=u.query.project_id;l.isLoggedIn()&&e!==(null==r?void 0:r.project_id)&&(t(),c("project_id"))},0)};return i(r),()=>{clearTimeout(e),d(r)}},[i,d,u,l]),{}}}},function(e){e.O(0,[7918,5738,3818,8210,8116,768,6753,1461,2888,9774,179],function(){return e(e.s=68038)}),_N_E=e.O()}]);