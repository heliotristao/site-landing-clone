(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6005],{68199:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/interface/[customFormUrl]",function(){return r(94924)}])},94924:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return eW}});var s=r(85893),i=r(27379),n=r(2164),a=r(45788),l=r(67294),o=r(9008),c=r.n(o),d=r(91036),u=r.n(d),m=r(64712),x=r(97757),p=r(30586),h=r(15486),f=r(94780),g=r(8780),j=r(45785),v=r(73577),w=r(1588),b=r(34867);function _(e){return(0,b.ZP)("MuiImageList",e)}(0,w.Z)("MuiImageList",["root","masonry","quilted","standard","woven"]);let y=l.createContext({}),N=["children","className","cols","component","rowHeight","gap","style","variant"],k=e=>{let{classes:t,variant:r}=e;return(0,f.Z)({root:["root",r]},_,t)},I=(0,j.ZP)("ul",{name:"MuiImageList",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t[r.variant]]}})(e=>{let{ownerState:t}=e;return(0,h.Z)({display:"grid",overflowY:"auto",listStyle:"none",padding:0,WebkitOverflowScrolling:"touch"},"masonry"===t.variant&&{display:"block"})}),Z=l.forwardRef(function(e,t){let r=(0,v.Z)({props:e,name:"MuiImageList"}),{children:i,className:n,cols:a=2,component:o="ul",rowHeight:c="auto",gap:d=4,style:u,variant:m="standard"}=r,x=(0,p.Z)(r,N),f=l.useMemo(()=>({rowHeight:c,gap:d,variant:m}),[c,d,m]);l.useEffect(()=>{},[]);let j="masonry"===m?(0,h.Z)({columnCount:a,columnGap:d},u):(0,h.Z)({gridTemplateColumns:"repeat(".concat(a,", 1fr)"),gap:d},u),w=(0,h.Z)({},r,{component:o,gap:d,rowHeight:c,variant:m}),b=k(w);return(0,s.jsx)(I,(0,h.Z)({as:o,className:(0,g.Z)(b.root,b[m],n),ref:t,style:j,ownerState:w},x,{children:(0,s.jsx)(y.Provider,{value:f,children:i})}))});r(59864);var S=r(24493);function C(e){return(0,b.ZP)("MuiImageListItem",e)}let P=(0,w.Z)("MuiImageListItem",["root","img","standard","woven","masonry","quilted"]),T=["children","className","cols","component","rows","style"],E=e=>{let{classes:t,variant:r}=e;return(0,f.Z)({root:["root",r],img:["img"]},C,t)},L=(0,j.ZP)("li",{name:"MuiImageListItem",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[{["& .".concat(P.img)]:t.img},t.root,t[r.variant]]}})(e=>{let{ownerState:t}=e;return(0,h.Z)({display:"block",position:"relative"},"standard"===t.variant&&{display:"flex",flexDirection:"column"},"woven"===t.variant&&{height:"100%",alignSelf:"center","&:nth-of-type(even)":{height:"70%"}},{["& .".concat(P.img)]:(0,h.Z)({objectFit:"cover",width:"100%",height:"100%",display:"block"},"standard"===t.variant&&{height:"auto",flexGrow:1})})}),O=l.forwardRef(function(e,t){let r=(0,v.Z)({props:e,name:"MuiImageListItem"}),{children:i,className:n,cols:a=1,component:o="li",rows:c=1,style:d}=r,u=(0,p.Z)(r,T),{rowHeight:m="auto",gap:x,variant:f}=l.useContext(y),j="auto";"woven"===f?j=void 0:"auto"!==m&&(j=m*c+x*(c-1));let w=(0,h.Z)({},r,{cols:a,component:o,gap:x,rowHeight:m,rows:c,variant:f}),b=E(w);return(0,s.jsx)(L,(0,h.Z)({as:o,className:(0,g.Z)(b.root,b[f],n),ref:t,style:(0,h.Z)({height:j,gridColumnEnd:"masonry"!==f?"span ".concat(a):void 0,gridRowEnd:"masonry"!==f?"span ".concat(c):void 0,marginBottom:"masonry"===f?x:void 0,breakInside:"masonry"===f?"avoid":void 0},d),ownerState:w},u,{children:l.Children.map(i,e=>l.isValidElement(e)?"img"===e.type||(0,S.Z)(e,["Image"])?l.cloneElement(e,{className:(0,g.Z)(b.img,e.props.className)}):e:null)}))});var R=r(86501),A=r(50382),F=r(13384),D=r(25164),M=r(45837),z=r(75318),U=r(90273),G=r(58137),q=r(76636),H=r(11247),V=r(71707),W=r(53645),Y=r(27695),B=r(1257),J=r(21612),$=r(23432),Q=r(50039),X=r(52609),K=r(60530),ee=r(14582),et=r(87900),er=r(39397),es=e=>{let{plRun:t,plConfig:r,runProgressPercentage:i,bgColorOverride:n,isForm:a,handleCancelRun:o,onBack:c,flowbookId:d}=e,u=(0,l.useMemo)(()=>(t.credit_cost||0)+(t.child_run_credit_cost||0),[t.credit_cost,t.child_run_credit_cost]),m=(0,l.useCallback)(()=>{if(!t.created_ts)return 0;let e=new Date(t.created_ts);return(((t.finished_ts?new Date(t.finished_ts):new Date).getTime()-e.getTime())/1e3).toFixed(1)},[t.created_ts,t.finished_ts]),x=(0,l.useMemo)(()=>m(),[m]),p="RUNNING"===t.state||"STARTED"===t.state,h="DONE"===t.state,f="FAILED"===t.state,g="TERMINATING"===t.state||"TERMINATED"===t.state,j="QUEUED"===t.state,v=h||f,w=(0,l.useMemo)(()=>n||(h?"bg-success":f?"bg-destructive":"bg-muted"),[h,f,n]),b=(0,l.useMemo)(()=>h?"text-success-foreground":f?"text-destructive-foreground":"text-muted-foreground",[h,f]),_=e=>{navigator.clipboard.writeText(e)},y=(0,l.useCallback)(()=>(0,s.jsxs)(K.z,{variant:"outline",onClick:()=>window.open("".concat(window.origin,"/pipeline?workbook_id=").concat(d,"&run_id=").concat(t.run_id),"_blank"),className:"border-border text-muted-foreground flex items-center justify-center rounded-lg border px-4 py-2 hover:bg-gray-50",children:[(0,s.jsx)(V.Z,{className:"mr-1 h-4 w-4"}),"View Flow Run"]}),[d,t.run_id]);return(0,s.jsx)(ee.Zb,{className:"w-full ".concat(w," bg-opacity-80 border-none shadow-none ").concat(a?"":"mt-4 rounded-t-none"),children:(0,s.jsx)(ee.aY,{className:"pt-6",children:(0,s.jsxs)("div",{className:"space-y-4",children:[v&&(0,s.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-lg font-medium",children:[h&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W.Z,{className:"text-success-foreground h-6 w-6"}),(0,s.jsx)("span",{className:"text-success-foreground",children:"Run completed successfully"})]}),f&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Y.Z,{className:"text-destructive-foreground h-6 w-6"}),(0,s.jsx)("span",{className:"text-destructive-foreground",children:"Run failed"})]})]}),(0,s.jsx)("div",{className:"block w-full sm:hidden",children:(r||i)&&(0,s.jsx)(er.Z,{plRun:t,plConfig:r,runProgressPercentage:i})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row",children:[a&&c&&d&&(0,s.jsx)(y,{}),a&&c&&(0,s.jsxs)(K.z,{variant:"outline",onClick:c,className:"border-border text-muted-foreground flex items-center justify-center rounded-lg border px-4 py-2 hover:bg-gray-50",children:[(0,s.jsx)(B.Z,{className:"mr-1 h-4 w-4"}),"Return to form"]})]})]}),f&&!a&&(0,s.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,s.jsx)("span",{className:"text-destructive-foreground text-sm",children:"Sending us this run link is the best way for our team to help"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(et.I,{type:"text",value:window.location.href,readOnly:!0,className:"border-destructive text-destructive-foreground rounded border bg-red-50 px-3 py-2 focus:outline-none"}),(0,s.jsx)(K.z,{onClick:()=>_(window.location.href),variant:"outline",className:"hover:bg-destructive text-destructive-foreground bg-destructive rounded px-4 py-2",children:(0,s.jsx)(J.Z,{className:"h-4 w-4"})})]})]})]}),!v&&(0,s.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-lg font-medium",children:[j?"Queued":g?"Stopped":"Progress",a&&p&&(0,s.jsx)($.Z,{className:"text-muted-foreground h-4 w-4 animate-spin"})]}),(0,s.jsx)("div",{className:"block w-full sm:hidden",children:(r||i)&&(0,s.jsx)(er.Z,{plRun:t,plConfig:r,runProgressPercentage:i})}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row",children:[a&&c&&d&&(0,s.jsx)(y,{}),a&&o&&(0,s.jsxs)(K.z,{variant:"outline",onClick:o,className:"border-border text-muted-foreground flex items-center justify-center rounded-lg border px-4 py-2 hover:bg-gray-50",children:[(0,s.jsx)("span",{className:"mr-2",children:"âœ•"}),"Cancel run"]})]})]}),(r||i)&&(0,s.jsx)("div",{className:"hidden sm:block",children:(0,s.jsx)(er.Z,{plRun:t,plConfig:r,runProgressPercentage:i})}),(0,s.jsxs)("div",{className:"flex items-center text-sm ".concat(b," space-x-3"),children:[j?(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(Q.Z,{className:"h-4 w-4 ".concat(b)}),(0,s.jsx)("span",{children:null!==t.queue_position?"Queue Position: ".concat(t.queue_position):"Queued"})]}):p?t.created_ts&&(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(Q.Z,{className:"h-4 w-4 ".concat(b)}),(0,s.jsxs)("span",{children:["Started at: ",t.getFormattedCreatedTime()]})]}):(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(Q.Z,{className:"h-4 w-4 ".concat(b)}),(0,s.jsxs)("span",{children:["Time: ",x,"s"]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(X.Z,{className:"h-4 w-4 ".concat(b)}),(0,s.jsxs)("span",{children:["Credits: ",u]})]})]})]})})})};let ei=(0,l.memo)(e=>{let{content:t}=e,r=RegExp("(?<!\\]\\()(https?:\\/\\/[^\\s]+)(?!\\))","g"),i=t.replace(r,"[$1]($1)");return(0,s.jsx)("div",{className:"max-w-full overflow-x-auto break-words whitespace-pre-wrap",children:(0,s.jsx)(A.U,{remarkPlugins:[F.Z],components:{p:e=>(0,s.jsx)("span",{className:"block break-words whitespace-pre-wrap",children:e.children}),h1:e=>(0,s.jsx)("h1",{className:"my-4 text-2xl font-semibold",children:e.children}),h2:e=>(0,s.jsx)("h2",{className:"my-2 text-xl font-semibold",children:e.children}),h3:e=>(0,s.jsx)("h3",{className:"my-2 text-lg font-semibold",children:e.children}),h4:e=>(0,s.jsx)("h4",{className:"my-1 text-base font-semibold",children:e.children}),h5:e=>(0,s.jsx)("h5",{className:"my-1 text-sm font-semibold",children:e.children}),h6:e=>(0,s.jsx)("h6",{className:"my-1 text-xs font-semibold",children:e.children}),li:e=>(0,s.jsx)("li",{className:"ml-4 leading-[1]",children:e.children}),ul:e=>(0,s.jsx)("ul",{className:"list-disc pl-4",children:e.children}),ol:e=>(0,s.jsx)("ol",{className:"list-decimal pl-4",children:e.children}),br:()=>(0,s.jsx)("br",{className:"my-2 block"}),a:e=>(0,s.jsx)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:"text-pink-600 hover:underline",children:e.children}),table:e=>(0,s.jsx)("table",{className:"border-border my-4 min-w-full border-collapse border",children:e.children}),thead:e=>(0,s.jsx)("thead",{className:"bg-gray-50",children:e.children}),tbody:e=>(0,s.jsx)("tbody",{className:"divide-y divide-gray-200",children:e.children}),tr:e=>(0,s.jsx)("tr",{className:"hover:bg-gray-50",children:e.children}),th:e=>(0,s.jsx)("th",{className:"border-border text-muted-foreground border px-6 py-3 text-left text-xs font-medium tracking-wider uppercase",children:e.children}),td:e=>(0,s.jsx)("td",{className:"border-border text-muted-foreground border px-6 py-4 text-sm whitespace-nowrap",children:e.children})},children:i})})});ei.displayName="MarkdownRenderer";let en=e=>{let{runId:t,flowbookId:r,onBack:i}=e,{userProfile:n,idTokenRef:a}=(0,l.useContext)(M.f),[o,c]=(0,l.useState)(null),[d,u]=(0,l.useState)(0),[m,x]=(0,l.useState)(null),[p,h]=(0,l.useState)(!1),[f,g]=(0,l.useState)("");(0,l.useEffect)(()=>{let e;let r=async()=>{if(!n.isLoggedIn()){x("You must be logged in to view this flow run.");return}try{let s=await (0,U.eN)("get_forms_plrun?run_id=".concat(t),n,a.current,"GET");c(new z.U(s.pl_run)),u(s.progress_percentage),s.error&&x(s.error),"DONE"!==s.pl_run.state&&"FAILED"!==s.pl_run.state&&"TERMINATED"!==s.pl_run.state&&(e=setTimeout(r,2e3))}catch(e){e instanceof D.H?x(e.message):x("Something went wrong when trying to get your run progress. Your flow is still running - please try refreshing the page.")}};return r(),()=>{e&&clearTimeout(e)}},[t,n]);let j=async()=>{try{i(),await (0,U.eN)("kill_pipeline",n,a.current,"POST",{user_id:n.user_id,run_id:t}),R.Am.success("Run cancelled")}catch(e){R.Am.error("Failed to cancel run")}},v=e=>{try{return JSON.parse(e),!0}catch(e){return!1}},w=e=>JSON.stringify(JSON.parse(e),null,2),b=e=>Array.isArray(e)?(0,s.jsx)("div",{className:"space-y-1",children:e.map((e,t)=>(0,s.jsx)("div",{className:"flex items-start rounded-lg bg-[#f7f7f7] p-3",children:(0,s.jsxs)("div",{className:"flex min-w-0 flex-1 items-start space-x-3",children:[(0,s.jsx)("span",{className:"border-opacity-15 inline-flex h-6 w-6 shrink-0 items-center justify-center rounded-md border border-black text-sm font-medium text-[#555555]",children:t+1}),(0,s.jsx)("div",{className:"text-muted-foreground w-full text-sm break-words whitespace-pre-wrap",children:v(e)?(0,s.jsx)("pre",{className:"overflow-x-auto font-mono break-words whitespace-pre-wrap",children:w(e)}):(0,s.jsx)(ei,{content:e})})]})},t))}):(0,s.jsx)("div",{className:"text-muted-foreground w-full break-words whitespace-pre-wrap",children:v(e)?(0,s.jsx)("pre",{className:"overflow-x-auto font-mono break-words whitespace-pre-wrap",children:w(e)}):(0,s.jsx)(ei,{content:e})});return(0,s.jsx)("div",{className:"mx-auto max-w-3xl py-8",children:(0,s.jsxs)("div",{className:"space-y-2 rounded-lg border",children:[o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(es,{flowbookId:r,plRun:o,runProgressPercentage:d,bgColorOverride:"bg-background",onBack:i,handleCancelRun:j,isForm:!0}),"DONE"===o.state&&o.outputs&&Object.keys(o.outputs).length>0&&(0,s.jsxs)("div",{className:"border-border border-t p-6",children:[(0,s.jsx)("p",{className:"mb-4 text-xl font-semibold",children:"Outputs"}),(0,s.jsx)("div",{className:"space-y-4",children:Object.entries(o.outputs).map(e=>{let[t,r]=e;return(0,s.jsxs)("div",{className:"rounded-lg bg-gray-50 p-4",children:[(0,s.jsx)("p",{className:"mb-2 text-lg font-medium text-gray-900",children:t}),b(r)]},t)})})]}),"DONE"===o.state&&o.memory_objects_written&&(0,G.GH)(o.memory_objects_written).length>0&&(0,s.jsxs)("div",{className:"border-border border-t p-6",children:[(0,s.jsx)("p",{className:"mb-4 text-xl font-semibold",children:"Generated Images"}),(0,s.jsx)(Z,{cols:3,children:(0,G.GH)(o.memory_objects_written).map((e,t)=>(0,s.jsx)(O,{onClick:()=>{g(e),h(!0)},sx:{cursor:"zoom-in"},children:(0,s.jsx)("img",{src:e,alt:"Generated image ".concat(t)})},t))}),(0,s.jsx)(H.Z,{isOpen:p,setIsOpen:h,imageUrl:f})]}),"DONE"===o.state&&o.memory_objects_written&&(0,G.YR)(o.memory_objects_written)&&(0,s.jsxs)("div",{className:"border-border border-t p-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("p",{className:"text-xl font-semibold",children:"Generated Files"})}),(0,s.jsx)(q.Z,{fileNames:(0,G.AR)(o.memory_objects_written)})]})]}),m&&(0,s.jsx)("div",{className:"text-destructive-foreground p-4 text-sm whitespace-pre-wrap",children:m})]})})};var ea=r(16215),el=r(92761),eo=r(41664),ec=r.n(eo),ed=r(29876),eu=r(19079),em=r(87021);let ex=(0,l.memo)(e=>{let{workflowLink:t}=e;return(0,s.jsx)("div",{className:"bg-background z-50 mx-auto w-full max-w-3xl py-4 pb-6 backdrop-blur",children:(0,s.jsx)("div",{className:"mx-auto max-w-6xl px-4 py-2 xl:px-0",children:(0,s.jsxs)("div",{className:"flex h-12 items-center justify-between",children:[(0,s.jsx)(em.Z,{size:"w-28 h-28",className:"opacity-70"}),(0,s.jsx)(ec(),{href:t||"https://gumloop.com",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-[#555555] transition-colors hover:text-[#333333]",children:t?"View Workflow":"Learn more about Gumloop"})]})})})});ex.displayName="InterfacePageHeader";var ep=e=>{let{workflowLink:t,errorDetails:r,hasAccessToInterfaceInOtherProject:i,handleProjectSwitch:n}=e,{userProfile:a,setIsUserSignInModalOpen:l}=(0,M.H)(),o=(null==r?void 0:r.message)||"Something went wrong",c=i?"You have access to this interface in another workspace.":(null==r?void 0:r.message)?"Please contact support if you believe this is a mistake.":"We couldn't load the interface you requested. Please try again later.";return!a.isLoggedIn()&&(null==r?void 0:r.code)&&"form_not_found"!==r.code?(0,s.jsxs)("div",{className:"flex h-svh flex-col",children:[(0,s.jsx)(ex,{workflowLink:t}),(0,s.jsxs)(eu.$,{title:"Please create an account to view this interface",description:"You need to be authenticated to view this interface.",markHref:"/hub",children:[(0,s.jsx)(ed.zx,{asChild:!0,variant:"outline",children:(0,s.jsxs)(ec(),{href:"/hub",children:[(0,s.jsx)(ea.Z,{}),"Go to Hub"]})}),(0,s.jsx)(ed.zx,{variant:"default",onClick:()=>l(!0),children:"Sign up"})]})]}):(0,s.jsxs)("div",{className:"flex h-svh flex-col",children:[(0,s.jsx)(ex,{workflowLink:t}),(0,s.jsxs)(eu.$,{title:o,description:c,markHref:"/hub",className:"h-full",children:[(0,s.jsx)(ed.zx,{asChild:!0,children:(0,s.jsxs)(ec(),{href:"/hub",children:[(0,s.jsx)(el.Z,{}),"Go to Hub"]})}),i&&(0,s.jsxs)(ed.zx,{onClick:()=>n(i),variant:"secondary",children:["Switch to ",i.project_name," Workspace"]})]})]})},eh=r(41999),ef=r(62666),eg=r(35152);let ej=e=>eh.Form.getOutputs(e.form_elements).reduce((t,r)=>{let s=e.form_elements.find(e=>"input_name"in e&&e.input_name===r.name);return t[r.name]=(null==s?void 0:s.value)!==void 0&&(null==s?void 0:s.value)!==null?s.value:(null==s?void 0:s.default)!==void 0&&(null==s?void 0:s.default)!==null?s.default:"",t},{}),ev=e=>!!e&&!("error"in e);var ew=r(82606),eb=r(88870);function e_(e){let{isSubmitting:t,hasValidationError:r,onSubmit:i}=e;return(0,s.jsx)("div",{className:"flex flex-col gap-2 pt-6",children:(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsx)(ed.zx,{onClick:i,variant:"default",size:"lg",className:"w-full",disabled:t||Object.values(r).includes(!0),children:t?(0,s.jsx)("div",{className:"flex items-center justify-center gap-2",children:(0,s.jsx)(ew.Z,{size:16,className:"text-muted-foreground animate-spin"})}):(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)(eb.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Submit and run flow"})]})})})})}var ey=r(12220);function eN(e){let{isSubmitting:t,hasValidationError:r,triggerDraft:i,existingUserTriggers:n,onSubmit:a,onDeleteClick:l}=e,o=n.length>0,c=t||Object.values(r).includes(!0)||!i||!i.isValid||0===i.triggerData.length;return(0,s.jsxs)("div",{className:"flex flex-col gap-2 pt-6",children:[(0,s.jsx)(ed.zx,{onClick:a,variant:"secondary",size:"lg",disabled:c,children:t?(0,s.jsx)("div",{className:"flex items-center justify-center gap-2",children:(0,s.jsx)(ew.Z,{size:16,className:"animate-spin"})}):(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)(ey.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:o?"Update Subscription":"Subscribe"})]})}),o&&(0,s.jsx)(ed.zx,{onClick:l,variant:"outline",size:"lg",disabled:t,children:"Unsubscribe"})]})}var ek=r(62266),eI=r(73793),eZ=r(98150),eS=r(3515),eC=r(78551),eP=e=>{let{formId:t,projectId:r}=e,{userProfile:s,idTokenRef:i}=(0,M.H)(),n=(0,l.useMemo)(()=>{if(!t)return;let e="get_published_form?form_id=".concat(t);return r&&(e+="&project_id=".concat(r)),e},[t,r]);return(0,eC.a)({queryKey:["publishedForm",t,r],queryFn:async()=>{let e=await fetch("".concat(U.CT,"/").concat(n),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s.api_key||i.current),"x-auth-key":s.user_id}});if(!e.ok){let t=await (0,U.e$)(e.clone()),r=await e.json();return{error:t,authorId:null==r?void 0:r.author_id,errorCode:null==r?void 0:r.error}}let t=await e.json();return{form:new eh.Form(t.form),required_secrets:t.required_secrets,flowbook_id:t.flowbook_id}},enabled:!!t&&!s.isLoading()&&!!n})},eT=r(98029),eE=()=>{let{userProfile:e,idTokenRef:t}=(0,M.H)();return(0,eT.D)({mutationFn:async r=>await (0,U.eN)("form_start_pipeline",e,t.current,"POST",{form_id:r.form_id,project_id:r.project_id,form_inputs:r.form_inputs})})},eL=r(59100),eO=r(9751),eR=r(18998),eA=r(5197),eF=r(49230),eD=r(16538),eM=r(8267),ez=r(94356),eU=e=>{let{width:t=30,height:r=30,className:i}=e,{userProfile:n}=(0,l.useContext)(M.f);return(0,s.jsx)(ez.Z,{src:n.profile_picture,name:(null==n?void 0:n.getDisplayName())||n.user_email||"",fallbackType:ez.A.Initials,style:{width:t,height:r},className:i})},eG=r(31479);let eq=(0,l.memo)(()=>{let{userProfile:e,isUserSignInModalOpen:t,setIsUserSignInModalOpen:r}=(0,l.useContext)(M.f);return e.isLoading()?null:e.isLoggedIn()?(0,s.jsx)("div",{className:"bg-muted rounded-2xl p-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(eU,{width:40,height:40}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"text-foreground text-sm font-medium",children:e.user_email}),(0,s.jsx)(eG.Z,{compact:!0,className:"text-muted-foreground hover:text-foreground text-sm"})]})]})}):(0,s.jsx)("div",{className:"bg-muted py-4 not-first:not-first-of-type:rounded-2xl",children:(0,s.jsx)(K.z,{variant:"ghost",className:"w-full justify-start gap-2",disabled:t,onClick:()=>r(!0),children:(0,s.jsxs)("div",{className:"flex items-center gap-2 rounded-lg border p-3",children:[(0,s.jsx)(eM.Z,{width:24,height:24}),"Sign in to run this flow"]})})})});eq.displayName="FormUserProfile";var eH=e=>{let{headerImage:t,icon:r,title:i,description:n}=e;return(0,s.jsxs)("div",{className:"bg-background relative rounded-lg",children:[t&&(0,s.jsx)("div",{className:"relative h-52 overflow-hidden rounded-3xl",children:(0,s.jsx)("img",{src:t,alt:"Interface header",className:"h-full w-full object-cover"})}),r&&(0,s.jsx)("div",{className:(0,eR.cn)("relative ml-12",t?"-mt-12":"mt-0"),children:(0,s.jsx)("div",{className:"relative h-24 w-24 rounded-lg",children:r.startsWith("http")?(0,s.jsx)("img",{src:r,alt:"Interface icon",className:"h-24 w-24 rounded-lg object-cover"}):(0,s.jsx)("div",{className:"text-[80px]",children:r})})}),(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{children:[i&&(0,s.jsx)("p",{className:"mt-4 block w-full pt-3 pb-2 text-4xl font-semibold break-words",children:i}),n&&(0,s.jsx)("div",{className:"text-muted-foreground block w-full text-lg break-words [&_a]:cursor-pointer [&_a]:text-pink-500 [&_a]:underline [&_a]:decoration-pink-500 [&_a]:hover:text-pink-600 [&_li]:my-1 [&_ol]:list-decimal [&_ol]:pl-6 [&_p]:min-h-[1.5em] [&_strong]:font-semibold [&_ul]:list-disc [&_ul]:pl-6",dangerouslySetInnerHTML:{__html:(0,eD.bb)(n)}})]}),(0,s.jsx)(eq,{})]})]})},eV=e=>{let{customFormUrl:t}=e,{userProfile:r,idTokenRef:i,setIsUserSignInModalOpen:o}=(0,M.H)(),{currentProject:d,projects:p,handleProjectSwitch:h,projectsStatus:f}=(0,eO.y)(),{data:g,isLoading:j}=eP({formId:function(e){if(!e)return;let t=e.split("-");return t[t.length-1]}(t),projectId:null==d?void 0:d.project_id}),{data:v,error:w,isLoading:b,refetch:_}=(0,a.jL)({userProfile:r,idToken:i.current},{skip:!r.isLoggedIn()}),{data:y,error:N,isLoading:k,refetch:I}=(0,a.jL)({userProfile:r,idToken:i.current,projectId:null==d?void 0:d.project_id},{skip:!(null==d?void 0:d.project_id)||!r.isLoggedIn()}),[Z,S]=(0,l.useState)(null),[C,P]=(0,l.useState)({}),[T,E]=(0,l.useState)(!1),[L,O]=(0,l.useState)({}),[R,A]=(0,l.useState)(!1),[F,D]=(0,l.useState)(null),[z,U]=(0,l.useState)([]),[G,q]=(0,l.useState)(!1),[H,{isLoading:V}]=(0,n.iq)(),[W,{isLoading:Y}]=(0,n.vs)(),{mutateAsync:B,isPending:J}=eE(),{updateParam:$,removeParams:Q,currentParams:X}=(0,eL.W)(),K=X.run_id,ee=async e=>{let t=v,r=y;e?t=(await _()).data:r=(await I()).data,P((0,eF.t)({pipelineRequiredSecrets:es,userSecretTypes:t||[],projectSecretTypes:r,projectId:null==d?void 0:d.project_id}))},et=(0,l.useMemo)(()=>!g||ev(g)?null:{message:g.error,authorId:g.authorId,errorCode:g.errorCode},[g]),er=(0,l.useMemo)(()=>(null==et?void 0:et.authorId)&&p&&p.find(e=>e.project_id===et.authorId)||null,[null==et?void 0:et.authorId,p]),es=(0,l.useMemo)(()=>ev(g)?g.required_secrets:{},[g]);(0,l.useEffect)(()=>{ev(g)&&S(g.form)},[g]),(0,l.useEffect)(()=>{var e;if(!Z||0===z.length){S(Z);return}let t=z.find(e=>{var t;return(null===(t=e.event)||void 0===t?void 0:t.form_inputs)&&Object.keys(e.event.form_inputs).length>0&&((null==d?void 0:d.project_id)?e.project_id===(null==d?void 0:d.project_id):null===e.project_id||void 0===e.project_id)});if(t&&(null===(e=t.event)||void 0===e?void 0:e.form_inputs)){let e=t.event.form_inputs;S(t=>t?function(e,t){let r=e.form_elements.map(e=>{if(!("input_name"in e)||!("is_required"in e))return e;let r=e.input_name;return r in t?{...e,value:t[r]}:e});return new eh.Form({...e,form_elements:r})}(t,e):t)}},[z]);let ei=(0,l.useMemo)(()=>{var e,t;return ev(g)?(e=window.origin,(t={form:null==g?void 0:g.form,flowbook_id:null==g?void 0:g.flowbook_id}).form.allow_workflow_access?t.flowbook_id?"".concat(e,"/pipeline?workbook_id=").concat(t.flowbook_id):"".concat(e,"/pipeline?flow_id=").concat(t.form.saved_item_id):null):null},[g]),ea=(0,l.useMemo)(()=>ev(g)?null==g?void 0:g.flowbook_id:null,[g]),el=async()=>{if(!r.isLoggedIn()){o(!0);return}if(!v||(null==d?void 0:d.project_id)&&!y){m.Am.error("Failed to get user secrets. ".concat(w||N?"Error: ".concat(w||N,".data"):"Please try again."));return}let e=eh.Form.validate(Z);if(Object.keys(e).length>0){O(Z.form_elements.reduce((t,r)=>("input_name"in r&&(t[r.input_name]=r.input_name in e),t),{})),m.Am.error("Please fill in all required fields correctly");return}let t=(0,eF.t)({pipelineRequiredSecrets:es,userSecretTypes:v,projectSecretTypes:y,projectId:null==d?void 0:d.project_id});if(Object.keys(t).length>0){P(t),E(!0);return}if(R&&F)try{await eo(F)}catch(e){m.Am.error(e.data||"Failed to save trigger");return}else{let e=ej(Z);await B({form_id:Z.form_id,form_inputs:e,project_id:(null==d?void 0:d.project_id)||""},{onSuccess:e=>{$("run_id",e.run_id)},onError:e=>{m.Am.error(e.message||"Failed to run flow")}})}},eo=async e=>{if(!e.isValid){m.Am.error("Please fix trigger configuration errors before saving");return}if(!e.triggerData||0===e.triggerData.length){m.Am.error("No trigger configuration found");return}let t=ej(Z),s=e.triggerData.map(e=>{var t;let r=null===(t=ef.x.validateTriggerEvent)||void 0===t?void 0:t.call(ef.x,e.trigger_type,e.event);return{triggerData:e,validation:r}}).find(e=>e.validation&&!1===e.validation.isValid);if(s&&s.validation&&!s.validation.isValid){m.Am.error(s.validation.error||"Invalid trigger configuration");return}let n=e.triggerData.map(async e=>{var s;let n=(s=null==d?void 0:d.project_id)?z.find(t=>t.project_id===s&&t.node_id===e.node_id):e.node_id?z.find(t=>t.node_id===e.node_id&&null===t.project_id):void 0;return H({trigger:function(e){let{triggerData:t,formId:r,savedItemId:s,userId:i,projectId:n,formInputs:a,existingTrigger:l}=e,o={...t.event,__form_id__:r,form_inputs:a},c=(null==l?void 0:l.trigger_id)||(0,eg.RL)();return new ef.x({trigger_id:c,saved_item_id:s,user_id:i,project_id:n,trigger_type:t.trigger_type,node_id:t.node_id,event:o})}({triggerData:e,formId:Z.form_id,savedItemId:Z.saved_item_id,userId:r.user_id,projectId:null==d?void 0:d.project_id,formInputs:t,existingTrigger:n}),flowbookId:ea||void 0,userProfile:r,idToken:i.current}).unwrap()});await Promise.all(n),m.Am.success("Trigger saved successfully!")},ec=async()=>{if(0!==z.length)try{let e=z.map(e=>W({trigger:e,flowbookId:ea||void 0,userProfile:r,idToken:i.current}).unwrap());await Promise.all(e),m.Am.success("Triggers deleted successfully"),q(!1),A(!1),U([]),D(null)}catch(e){m.Am.error(e.message||"Failed to delete triggers")}},eu=(e,t)=>{if(!Z)return;let r=[...Z.form_elements];r[e]=t,S(new eh.Form({...Z,form_elements:r}))};return r.isLoading()||("idle"===f||"loading"===f)&&r.isLoggedIn()||j||b||k?(0,s.jsx)(ek.rX,{}):(null==et?void 0:et.message)||!Z?(0,s.jsx)(ep,{workflowLink:ei,errorDetails:et,hasAccessToInterfaceInOtherProject:er,handleProjectSwitch:h}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eS.Z,{url:"https://www.gumloop.com/interface/".concat(t),title:Z.title,description:Z.description?u()(Z.description,{allowedTags:[],allowedAttributes:{}}):void 0}),(0,s.jsx)(c(),{children:(0,s.jsxs)("title",{children:["Gumloop | ",Z.title||"Interface"]})}),(0,s.jsxs)("div",{className:(0,eR.cn)("text-foreground mx-auto h-svh w-full max-w-3xl px-4"),children:[(0,s.jsx)(ex,{workflowLink:ei}),(0,s.jsx)(eH,{headerImage:Z.header_image,icon:Z.icon,title:Z.title,description:Z.description}),(0,s.jsx)("div",{className:(0,eR.cn)("bg-background text-foreground min-h-[300px] w-full space-y-4 rounded-lg px-4",K?"py-0":"py-8"),children:K?(0,s.jsx)(en,{flowbookId:ea||void 0,runId:K,onBack:()=>Q("run_id")}):(0,s.jsxs)(l.Fragment,{children:[Z.form_elements.map((e,t)=>(0,s.jsx)(x.F,{element:e,index:t,onUpdate:eu,onDelete:()=>{},isDisplayMode:!0,savedItemId:Z.saved_item_id,projectId:null==d?void 0:d.project_id,interfaceCreatorUserId:Z.creator_user_id,interfaceAuthorId:Z.author_id,isTriggerModeEnabled:R,setIsTriggerModeEnabled:A,onTriggerDraftChange:D,onExistingUserTriggersChange:U,hasValidationError:!!e.input_name&&L[e.input_name],setHasValidationError:t=>{e.input_name&&O(r=>({...r,[e.input_name]:t}))}},t)),R?(0,s.jsx)(eN,{isSubmitting:V||Y,hasValidationError:L,triggerDraft:F,existingUserTriggers:z,onSubmit:el,onDeleteClick:()=>q(!0)}):(0,s.jsx)(e_,{isSubmitting:J,hasValidationError:L,onSubmit:el})]})})]}),(0,s.jsx)(eI.Z,{immediatePipelineEvaluationResult:C,open:T,onOpenChange:E,immediateOnAuthSuccess:ee}),(0,s.jsx)(eZ.Z,{open:G,setOpen:q,title:"Unsubscribe and delete ".concat((0,eA.Ri)(z.length,"trigger"),"?"),description:"You are about to permanently delete ".concat(z.length," ").concat((0,eA.Ri)(z.length,"trigger"),". This action cannot be undone."),onConfirm:ec,onCancel:()=>q(!1),primaryActionButtonVariant:ed.f1.DESTRUCTIVE,confirmButtonProps:{text:"Delete"},cancelButtonProps:{text:"Cancel"}})]})};function eW(){let e=(0,i.useParams)(),t=null==e?void 0:e.customFormUrl;return t?(0,s.jsx)(eV,{customFormUrl:t}):null}},87021:function(e,t,r){"use strict";var s=r(85893);r(67294);var i=r(25675),n=r.n(i),a=r(41664),l=r.n(a);t.Z=e=>{let{size:t,className:r}=e;return(0,s.jsx)(l(),{href:"/home",children:(0,s.jsx)("div",{className:"relative ".concat(t," ").concat(r||""),children:(0,s.jsx)(n(),{src:"/images/gumloop_logo.svg",alt:"Gumloop logo",fill:!0,className:"object-contain",style:{filter:"var(--svg-filter)"}})})})}},3515:function(e,t,r){"use strict";var s=r(85893),i=r(67294),n=r(9008),a=r.n(n),l=r(70334),o=r.n(l),c=r(68934);let d={title:"Gumloop",description:"The no-code platform to build and host AI-powered business automations.",siteURL:"https://gumloop.com",linkPreviewPath:"https://gumloop.com/images/link-preview.webp",linkPreviewAlt:"Gumloop heading and preview image"};t.Z=e=>{let{url:t,title:r,description:n,linkPreviewPath:l,linkPreviewAlt:u,videoSchemas:m,canonicalUrl:x}=e,p=l&&l.startsWith("/")?"".concat(c.hZ).concat(l):l||d.linkPreviewPath,h=t||d.siteURL,f={"@context":"https://schema.org","@type":"WebSite",name:r||d.title,description:n||d.description,url:h,image:p,publisher:{"@type":"Organization",name:"Gumloop",logo:{"@type":"ImageObject",url:"https://gumloop.com/logo.svg",width:60,height:60}}};return(0,s.jsxs)(i.Fragment,{children:[(0,s.jsxs)(a(),{children:[(0,s.jsx)("title",{children:r}),(0,s.jsx)("meta",{name:"viewport",content:"width=device-width,initial-scale=1.0"}),(0,s.jsx)("meta",{name:"theme-color",content:"#f6f8fa"}),(0,s.jsx)("meta",{name:"description",content:n||d.description}),(0,s.jsx)("meta",{property:"og:title",content:r||d.title}),(0,s.jsx)("meta",{property:"og:description",content:n||d.description}),(0,s.jsx)("meta",{property:"og:url",content:h}),(0,s.jsx)("meta",{property:"og:type",content:"website"}),(0,s.jsx)("meta",{property:"og:site_name",content:r||d.title}),(0,s.jsx)("meta",{property:"og:image",content:p}),(0,s.jsx)("meta",{property:"og:image:alt",content:u||d.linkPreviewAlt}),(0,s.jsx)("meta",{name:"twitter:title",content:r||d.title}),(0,s.jsx)("meta",{name:"twitter:description",content:n||d.description}),(0,s.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,s.jsx)("meta",{name:"twitter:image",content:p||d.linkPreviewPath}),(0,s.jsx)("meta",{name:"twitter:image:alt",content:u||d.linkPreviewAlt}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"}),x&&(0,s.jsx)("link",{rel:"canonical",href:x})]}),(0,s.jsx)(o(),{id:"structured-data",type:"application/ld+json",strategy:"afterInteractive",children:JSON.stringify(f)}),m&&m.map((e,t)=>(0,s.jsx)(o(),{id:"structured-data-video-".concat(t),type:"application/ld+json",strategy:"afterInteractive",children:JSON.stringify({"@context":"https://schema.org","@type":"VideoObject",...e})},"video-schema-".concat(t)))]})}}},function(e){e.O(0,[1036,2270,1105,2888,9774,179],function(){return e(e.s=68199)}),_N_E=e.O()}]);