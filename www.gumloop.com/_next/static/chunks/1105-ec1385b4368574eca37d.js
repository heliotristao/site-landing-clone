(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1105],{53334:function(e,t,r){"use strict";r.d(t,{K:function(){return s},TM:function(){return i},ev:function(){return l}});var a=r(8698);let n=e=>e.triggers,s=(0,a.P1)([n,(e,t)=>t],(e,t)=>{var r;return t&&(null===(r=e.triggerMap[t])||void 0===r?void 0:r.active)||[]}),i=(0,a.P1)([n,(e,t)=>{let{nodeId:r,savedItemId:a,userId:n,projectId:s}=t;return{nodeId:r,savedItemId:a,userId:n,projectId:s}}],(e,t)=>{let{nodeId:r,savedItemId:a,userId:n,projectId:s}=t;if(!r||!a)return;let i=e.triggerMap[a];if(!i)return;let l=i.active.find(e=>s?e.node_id===r&&e.project_id===s:e.node_id===r&&e.user_id===n);if(l)return l});(0,a.P1)(n,e=>Object.values(e.triggerMap).flatMap(e=>e.active));let l=(0,a.P1)(n,e=>{let t={};return Object.entries(e.triggerMap).forEach(e=>{let[r,{active:a}]=e;a.length>0&&(t[r]=a)}),t});(0,a.P1)([n],e=>Object.keys(e.triggerMap).length>0)},97757:function(e,t,r){"use strict";r.d(t,{F:function(){return ek}});var a=r(85893),n=r(67294),s=r(86762),i=r(61929),l=r(14919),o=r(23279),d=r.n(o),c=r(71424),u=r(29876),m=r(18272),g=r(75177),p=r(50720),x=r(10586),f=r(27484),h=r.n(f),v=r(29387),b=r.n(v),_=r(70178),j=r.n(_);h().extend(j()),h().extend(b());let y=Intl.DateTimeFormat().resolvedOptions().timeZone;var N=e=>{let{value:t,onChange:r,className:n}=e;return(0,a.jsxs)("div",{className:"custom-datepicker ".concat(n||""),children:[(0,a.jsx)("style",{children:"\n          /* Ensure text color uses the foreground variable */\n\n          .custom-datepicker input {\n            --tw-ring-shadow: 0 0 #000 !important;\n           \n          }\n        "}),(0,a.jsx)(p._,{dateAdapter:x.y,children:(0,a.jsx)(g.M,{value:t?h()(t):null,onChange:e=>r(e?"".concat(h()(e).format("YYYY-MM-DD"),"T00:00:00"):""),timezone:y,sx:{"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"var(--border)",borderRadius:"var(--radius)"},"& input":{color:"var(--foreground)",height:"calc(var(--spacing) * 10)",padding:"0 calc(var(--spacing) * 3)"},backgroundColor:"var(--background)",borderRadius:"var(--radius)"},"& .MuiSvgIcon-root":{color:"var(--foreground)",height:"1.25rem",width:"1.25rem"},"& .MuiPickersDay-root":{color:"var(--foreground)"},"& .MuiTypography-root":{color:"var(--foreground)"}}})})]})},k=r(87900),w=r(87915),C=r(35718),I=r(82014),T=r(73063);let E={All:[],Images:[".jpg",".jpeg",".png",".gif",".webp",".svg",".bmp",".tiff"],Documents:[".pdf",".doc",".docx",".txt",".csv",".xls",".xlsx",".ppt",".pptx"]};var P=r(45837),D=r(41999),Z=r(18998),S=r(45286),z=r(62190),A=r(28900),M=r(60887),F=r(45587),U=r(24285),V=r(27876),O=r(42414);let L=(0,n.memo)(e=>{let{value:t,onChange:r,placeholder:n="",type:s="text",className:i="",...l}=e;return(0,a.jsx)(k.I,{value:null!=t?t:"",onChange:r,placeholder:n,type:s,className:"h-8 w-full text-xs ".concat(i),...l})});L.displayName="ConfigInput";let R=(0,n.memo)(e=>{let{children:t}=e;return(0,a.jsx)("label",{className:"text-muted-foreground! mb-1 block text-xs font-medium",children:t})});R.displayName="ConfigLabel";let G=(0,n.memo)(e=>{let{id:t,option:r,onChange:n,onRemove:s}=e,{attributes:l,listeners:o,setNodeRef:d,transform:c,transition:m,isDragging:g}=(0,F.nB)({id:t}),p={transform:U.ux.Transform.toString(c),transition:m};return(0,a.jsxs)("div",{ref:d,style:p,className:(0,Z.cn)("mb-2 flex items-center gap-2",g&&"opacity-50"),children:[(0,a.jsx)("div",{className:"text-muted-foreground/50 hover:text-muted-foreground flex cursor-grab items-center active:cursor-grabbing",...l,...o,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})}),(0,a.jsx)(L,{value:r,onChange:e=>n(e.target.value),placeholder:"Enter option text..."}),(0,a.jsx)(u.zx,{variant:"ghost",accent:"destructive",size:"icon-sm",onClick:s,children:(0,a.jsx)(z.Z,{className:"h-4 w-4"})})]})});G.displayName="DraggableOption";let W=(0,n.memo)(e=>{let{element:t,onUpdate:r}=e,{userProfile:s}=(0,P.H)(),i="is_required"in t,[l,o]=(0,n.useState)(""),[d,c]=(0,n.useState)(""),m=(0,M.Dy)((0,M.VT)(M.we),(0,M.VT)(M.Lg,{coordinateGetter:F.is}));(0,n.useEffect)(()=>{var e,r,a,n,s,i,l,d;"TextField"===t.type?(o(null!==(a=null===(e=t.min_characters)||void 0===e?void 0:e.toString())&&void 0!==a?a:""),c(null!==(n=null===(r=t.max_characters)||void 0===r?void 0:r.toString())&&void 0!==n?n:"")):"Number"===t.type&&(o(null!==(l=null===(s=t.min_value)||void 0===s?void 0:s.toString())&&void 0!==l?l:""),c(null!==(d=null===(i=t.max_value)||void 0===i?void 0:i.toString())&&void 0!==d?d:""))},[]);let g=(0,n.useCallback)(e=>{r(e)},[r]),p=(0,n.useCallback)(e=>{let{active:r,over:a}=e;if(a&&r.id!==a.id&&"options"in t&&Array.isArray(t.options)){let e=t.options.findIndex((e,t)=>"option-".concat(t)===r.id),n=t.options.findIndex((e,t)=>"option-".concat(t)===a.id),s=[...t.options],[i]=s.splice(e,1);s.splice(n,0,i),g({options:s})}},[t,g]),x=(0,n.useCallback)((e,r)=>{let a=e.target.value;if("min"===r?o(a):c(a),!a){"min"===r?g("TextField"===t.type?{min_characters:void 0}:{min_value:void 0}):g("TextField"===t.type?{max_characters:void 0}:{max_value:void 0});return}f(()=>{let e=parseInt(a);if(!isNaN(e)){if(e<0){"min"===r?(o("0"),g("TextField"===t.type?{min_characters:0}:{min_value:0})):!isNaN(parseInt(l))&&d<l&&(c(l),g("TextField"===t.type?{max_characters:0}:{max_value:0}));return}if("min"===r){let r=parseInt(d);!isNaN(r)&&e>r?(o(d),g("TextField"===t.type?{min_characters:r}:{min_value:r})):g("TextField"===t.type?{min_characters:e}:{min_value:e})}else{let r=parseInt(l);!isNaN(r)&&e<r?(c(l),g("TextField"===t.type?{max_characters:r}:{max_value:r})):g("TextField"===t.type?{max_characters:e}:{max_value:e})}}})},[t.type,g,l,d]),f=(0,n.useMemo)(()=>(0,V.Z)(e=>{e()},1e3),[]),h=(0,n.useCallback)(()=>(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{children:"TextField"===t.type?"Min Characters":"Min Value"}),(0,a.jsx)(L,{type:"number",value:l,onChange:e=>x(e,"min"),placeholder:"TextField"===t.type?"Min length":"Min value"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{children:"TextField"===t.type?"Max Characters":"Max Value"}),(0,a.jsx)(L,{type:"number",value:d,onChange:e=>x(e,"max"),placeholder:"TextField"===t.type?"Max length":"Max value"})]})]}),[t.type,l,d,x]),v=(0,n.useCallback)(()=>i?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2",children:[(0,a.jsx)(R,{children:"Required field"}),(0,a.jsx)(I.Z,{textSize:"text-sm",checked:t.is_required,onChange:e=>g({is_required:e.target.checked})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{children:"Helper Text"}),(0,a.jsx)(L,{value:t.helper_text,onChange:e=>g({helper_text:e.target.value}),placeholder:"Add helper text..."})]})]}):null,[t,g,i]);return(0,n.useCallback)(()=>{var e,r,n;switch(t.type){case"TextField":return(0,a.jsxs)("div",{className:"space-y-4",children:[v(),(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{children:"Default Value"}),(0,a.jsx)(L,{value:t.default,onChange:e=>g({default:e.target.value}),placeholder:"Enter default value..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{children:"Placeholder"}),(0,a.jsx)(L,{value:t.placeholder,onChange:e=>g({placeholder:e.target.value}),placeholder:"Enter placeholder text..."})]}),h()]});case"Number":return(0,a.jsxs)("div",{className:"space-y-4",children:[v(),(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{children:"Default Value"}),(0,a.jsx)(L,{type:"number",value:t.default,onChange:e=>g({default:e.target.value}),placeholder:"Enter default value..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{children:"Placeholder"}),(0,a.jsx)(L,{value:t.placeholder,onChange:e=>g({placeholder:e.target.value}),placeholder:"Enter placeholder text..."})]}),h()]});case"SelectDropdown":return(0,a.jsxs)("div",{className:"space-y-4",children:[v(),(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{children:"Default Value"}),(0,a.jsx)(C.Z,{options:t.options,value:t.default||"",onChange:e=>g({default:e})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{children:"Options"}),(0,a.jsx)(M.LB,{sensors:m,collisionDetection:M.pE,onDragEnd:p,children:(0,a.jsx)(F.Fo,{items:t.options.map((e,t)=>"option-".concat(t)),strategy:F.qw,children:t.options.map((e,r)=>(0,a.jsx)(G,{id:"option-".concat(r),option:e,onChange:e=>{let a=[...t.options];a[r]=e,g({options:a})},onRemove:()=>{g({options:t.options.filter((e,t)=>t!==r)})}},"option-".concat(r)))})}),(0,a.jsx)(u.zx,{variant:"outline",size:"sm",onClick:()=>g({options:[...t.options,""]}),className:"text-muted-foreground text-xs",children:"+ Add Option"})]})]});case"MultiSelectDropdown":{let n=t.options.map(e=>({value:e,label:e})),s=null!==(r=null===(e=t.default)||void 0===e?void 0:e.map(e=>({value:e,label:e})))&&void 0!==r?r:[];return(0,a.jsxs)("div",{className:"space-y-4",children:[v(),(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{children:"Default Values"}),(0,a.jsx)(w.Z,{noPortal:!0,options:n,value:s,onChange:e=>{g({default:e.map(e=>e.value)})}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{children:"Options"}),(0,a.jsx)(M.LB,{sensors:m,collisionDetection:M.pE,onDragEnd:p,children:(0,a.jsx)(F.Fo,{items:t.options.map((e,t)=>"option-".concat(t)),strategy:F.qw,children:t.options.map((e,r)=>(0,a.jsx)(G,{id:"option-".concat(r),option:e,onChange:e=>{let a=[...t.options];a[r]=e,g({options:a})},onRemove:()=>{g({options:t.options.filter((e,t)=>t!==r)})}},"option-".concat(r)))})}),(0,a.jsx)(u.zx,{variant:"outline",size:"sm",onClick:()=>g({options:[...t.options,""]}),className:"text-muted-foreground text-xs",children:"+ Add Option"})]})]})}case"Checkbox":return(0,a.jsxs)("div",{className:"space-y-4",children:[v(),(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2",children:[(0,a.jsx)(R,{children:"Default Checked"}),(0,a.jsx)(I.Z,{textSize:"text-sm",checked:"true"===t.default,onChange:e=>g({default:e.target.checked.toString()})})]})]});case"Email":return(0,a.jsxs)("div",{className:"space-y-4",children:[s.user_email&&(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between gap-2",children:[(0,a.jsx)(R,{children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["Autofill email",(0,a.jsxs)(O.u,{children:[(0,a.jsx)(O.aJ,{asChild:!0,children:(0,a.jsx)(A.Z,{className:"text-muted-foreground h-3 w-3"})}),(0,a.jsx)(O._v,{className:"max-w-xs text-xs",children:"When enabled, any user filling out this form will have their email address automatically populated in this field."})]})]})}),(0,a.jsx)(I.Z,{textSize:"text-sm",checked:!!t.auto_fill_email,onChange:e=>{let t=e.target.checked;g({auto_fill_email:t,...t&&s.user_email?{value:s.user_email}:{}})}})]}),v()]});case"FileUpload":{let e=t.file_category||"All",r=null===(n=t.custom_file_extensions)||void 0===n?void 0:n.map(e=>({value:e,label:e}));return(0,a.jsxs)("div",{className:"space-y-4",children:[v(),(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{children:"Allowed File Types"}),(0,a.jsx)(C.Z,{options:[...Object.keys(E),"Custom"],value:e,onChange:e=>{g({file_category:e,..."Custom"!==e&&{custom_file_extensions:[]}})}})]}),"Custom"===e&&(0,a.jsxs)("div",{children:[(0,a.jsx)(R,{children:"Custom File Extensions"}),(0,a.jsx)(w.Z,{isCreatable:!0,value:r,onChange:e=>{g({custom_file_extensions:e.map(e=>e.value.startsWith(".")?e.value:"."+e.value)})},placeholder:"Type extension and press Enter (e.g., .pdf)",formatCreateLabel:e=>'Add "'.concat(e.startsWith(".")?e:"."+e,'"'),customStyles:{control:e=>({...e,minHeight:"32px",fontSize:"0.75rem"})}})]})]})}default:return v()}},[t,g,v,h])()});W.displayName="ConfigurationPanel";var q=r(23432),B=r(97387),H=r(30671),J=r(25675),K=r.n(J),Y=r(5295),X=r(32782),$=r(29020),Q=r(82244),ee=r(70452),et=r(37054),er=r(14908),ea=r(75111),en=r(20997),es=e=>{let{parameter:t,declarationParameter:r,declaration:s,allParameters:i,onChange:l,onParameterChanges:o}=e,d=null;if(r.is_dynamic){var c;let e=(null===(c=Q.e_[s.name])||void 0===c?void 0:c[r.name])||Q.Xc[r.name];if(e){let a="component"in e?e.component:e,l="props"in e&&e.props?e.props:{};d=(0,n.createElement)(a,{parameter:t,parameters:i,declarationParameter:r,handleParameterChanges:o,data:{name:s.name,parameters:i,declaration:s,version:s.version},className:"w-full",...l})}}d||(d="boolean"===r.data_type?(0,a.jsx)(ea.PT,{parameter:t,declarationParameter:r,handleParameterChanges:e=>{var t;return l(null===(t=e[0])||void 0===t?void 0:t.newValue)},onColor:"var(--accent-foreground)",offColor:"var(--muted)",textSize:"text-sm"}):r.data_type.startsWith("enum(")||r.data_type.startsWith("grouped_enum(")?(0,a.jsx)(ea.nj,{parameter:t,declarationParameter:r,handleParameterChanges:e=>{var t;return l(null===(t=e[0])||void 0===t?void 0:t.newValue)},className:"w-full!"}):r.data_type.startsWith("multi_select_enum(")?(0,a.jsx)(ea.Q5,{parameter:t,declarationParameter:r,handleParameterChanges:e=>{var t;return l(null===(t=e[0])||void 0===t?void 0:t.newValue)},className:"w-full!"}):"Date"===r.data_type?(0,a.jsx)(ea.$5,{parameter:t,handleParameterChanges:e=>{var t;return l(null===(t=e[0])||void 0===t?void 0:t.newValue)},isDisabled:!1,error:!1}):"File"===r.data_type?(0,a.jsx)(et.Z,{isDisabled:!1,parameter:t,handleParameterChanges:e=>{var t;return l(null===(t=e[0])||void 0===t?void 0:t.newValue)},declarationParameter:r,error:null==t?void 0:t.error_message}):"GoogleDrive"===r.data_type?(0,a.jsx)(er.Z,{isDisabled:!1,handleParameterChanges:e=>{var t;return l(null===(t=e[0])||void 0===t?void 0:t.newValue)},parameter:t,parameters:i,declaration:s,declarationParameter:r,error:null==t?void 0:t.error_message}):"CredentialsPicker"===r.data_type?(0,a.jsx)(en.ZP,{parameter:t,parameters:i,declaration:s,declarationParameter:r,handleParameterChanges:e=>{var t;return l(null===(t=e[0])||void 0===t?void 0:t.newValue)},error:null==t?void 0:t.error_message}):(0,a.jsx)(ea.Z4,{parameter:t,declarationParameter:r,handleParameterChanges:e=>{var t;return l(null===(t=e[0])||void 0===t?void 0:t.newValue)},isDisabled:!1}));let u=["Date"];return(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("div",{className:(0,Z.cn)("boolean"===r.data_type?"relative flex flex-row items-center justify-between":""),children:u.includes(r.data_type)?(0,a.jsxs)("div",{className:"flex flex-row space-x-2",children:[d,(0,ee.W)(r,void 0,!0,u)]}):(0,a.jsxs)(a.Fragment,{children:[(0,ee.W)(r,void 0,!0,u),d]})})})};let ei=(0,n.memo)(e=>{let{nodeId:t,declaration:r,parameters:s,validationErrors:i,onParameterChange:l,onParameterChanges:o,viewOnly:d=!1}=e,c=(0,n.useMemo)(()=>{let e=new Map;return s.forEach(t=>e.set(t.name,t)),e},[s]),u=(0,n.useMemo)(()=>r?[...r.parameters||[],...r.additional_parameters||[]]:[],[r]),m=(0,n.useMemo)(()=>{if(!r)return[];let e=u.map(e=>c.get(e.name)||(0,X.A)(e,"")),t=e.findIndex(e=>"_is_trigger_enabled"===e.name);if(t>=0)e[t]={...e[t],value:"true"};else{let t=u.find(e=>"_is_trigger_enabled"===e.name);t&&e.push((0,X.A)(t,"true"))}return e},[u,c,r]),g=(0,n.useMemo)(()=>({name:"",inputs:[],outputs:[],parameters:m,declaration:r||{},connectedInputBadges:[]}),[m,r]),p=(0,n.useMemo)(()=>r?u.filter(e=>e.is_trigger_parameter||"CredentialsPicker"===e.data_type).filter(e=>!e.name.endsWith("_map")).filter(e=>(0,$.P_)(e,m,g,void 0)):[],[u,m,g,r]);if(!r)return(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:"Unable to load trigger parameters for this node."});let x=!!(i&&i.length>0);return(0,a.jsxs)("div",{className:(0,Z.cn)("flex shrink-0 flex-col gap-4 transition-[padding] duration-100",d?"p-2":"p-4"),children:[(0,a.jsx)("div",{className:"group/collapsible-trigger",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm select-none",children:[(0,a.jsx)("div",{className:"border-border flex size-8 items-center justify-center rounded-md border p-1",children:(0,a.jsx)(K(),{src:(0,Y.F1)(r.category),alt:r.category,width:16,height:16,className:"flex-shrink-0"})}),(0,a.jsx)("p",{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{className:"font-medium",children:[r.category," Trigger"]})})]})}),(0,a.jsx)("div",{className:(0,Z.cn)("flex-col gap-3",d?"hidden":"flex"),children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[p.map(e=>{let n=c.get(e.name)||(0,X.A)(e,"");return(0,a.jsx)("div",{children:(0,a.jsx)(es,{parameter:n,declarationParameter:e,declaration:r,allParameters:m,onChange:t=>l(e.name,t),onParameterChanges:e=>o(e)})},"".concat(t,"-").concat(e.name))}),x&&0===p.length&&(0,a.jsx)("div",{className:"mt-2 space-y-1",children:i.map((e,t)=>(0,a.jsx)("p",{className:"text-destructive text-xs",children:e},t))})]})})]})});ei.displayName="NodeTriggerEditor";var el=r(46611),eo=r(92647),ed=r(84385);function ec(e){let{value:t,validationErrors:r,onChange:s,isDisabled:i=!1,viewOnly:l=!1}=e,o=(0,n.useRef)(null),[d,c]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!1),g=!!(r&&r.length>0);return(0,a.jsxs)("div",{className:(0,Z.cn)("flex flex-col gap-3 transition-[padding] duration-100",l?"p-2":"p-4"),children:[(0,a.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,a.jsx)(ed.Z,{triggerType:"time_based",size:16,fallbackIcon:(0,a.jsx)(el.Z,{className:"size-5"}),className:"border-border flex size-8 items-center justify-center rounded-md border p-1"}),(0,a.jsx)("div",{className:"text-sm font-medium",children:"Time Trigger"})]}),!l&&(0,a.jsx)(eo.Z,{ref:o,value:t,onChange:s,onGenerationStateChange:e=>{c(e.isConvertingToCron),m(e.isCronError)}}),g&&r&&(0,a.jsx)("div",{className:"mt-2 space-y-1",children:r.map((e,t)=>(0,a.jsx)("p",{className:"text-destructive text-xs",children:e},t))})]})}var eu=r(22495),em=r(2164),eg=r(53334),ep=r(99673),ex=r(62666),ef=r(90273);function eh(e,t,r){return r?e.find(e=>e.user_id===t&&e.project_id===r)||null:e.find(e=>e.user_id===t&&null==e.project_id)||null}function ev(e,t){if(0===e.length)return null;let r=eh(e,t.currentUserId,t.projectId);if(r)return r;if(t.interfaceCreatorUserId){let r=function(e,t){if(e&&t&&e!==t)return e}(t.interfaceAuthorId,t.interfaceCreatorUserId),a=eh(e,t.interfaceCreatorUserId,r);if(a)return a}if(t.interfaceAuthorId&&t.interfaceAuthorId!==t.interfaceCreatorUserId){let r=e.find(e=>e.user_id===t.interfaceAuthorId);if(r)return r;let a=e.find(e=>e.project_id===t.interfaceAuthorId);if(a)return a}return null}function eb(e,t){let r=new Map;for(let a of e){let e=t(a);r.has(e)||r.set(e,[]),r.get(e).push(a)}return r}let e_=(0,n.memo)(e=>{var t,r,s;let{savedItemId:i,isDisplayMode:l,projectId:o,interfaceCreatorUserId:d,interfaceAuthorId:c,isTriggerModeEnabled:u,setIsTriggerModeEnabled:m,onTriggerDraftChange:g,onExistingUserTriggersChange:p}=e,x=function(e){let{savedItemId:t,mode:r,projectId:a,interfaceCreatorUserId:s,interfaceAuthorId:i}=e,{userProfile:l,idTokenRef:o}=(0,P.H)(),[d,c]=(0,n.useState)({}),[u,m]=(0,n.useState)({cron_expression:void 0,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}),g=(0,eu.CG)(e=>t?(0,eg.K)(e,t):[]),{data:p,isLoading:x}=(0,em.Fe)({savedItemId:t,userProfile:l,idToken:o.current},{skip:"display"!==r||!t||l.isLoading()}),f=(0,n.useMemo)(()=>{if(!t)return{};if("display"===r){var e;let r=null!==(e=null==p?void 0:p[t])&&void 0!==e?e:[];return r.length>0?{[t]:r}:{}}return{[t]:g}},[g,p,r,t]),{nodeTriggerConfigs:h,timeTriggerConfig:v,hasUserCreatedTriggers:b}=(0,n.useMemo)(()=>(function(e){var t,r;let{triggersBySavedItem:a,currentUserId:n,projectId:s,interfaceCreatorUserId:i,interfaceAuthorId:l}=e,o={currentUserId:n,projectId:s,interfaceCreatorUserId:i,interfaceAuthorId:l},d=[];Object.values(a).forEach(e=>d.push(...e));let{nodeTriggers:c,timeTriggers:u}=function(e){let t=[],r=[];for(let a of e)"time_based"===a.trigger_type?r.push(a):null!=a.node_id&&t.push(a);return{nodeTriggers:t,timeTriggers:r}}(d),m=[];for(let[e,t]of eb(c,e=>e.node_id)){let r=ev(t,o);r&&m.push({nodeId:e,trigger:r,isCreatedByUser:r.user_id===o.currentUserId,saved_item_id:r.saved_item_id})}let g=null;for(let[e,r]of eb(u,e=>e.saved_item_id)){let a=ev(r,o);if(a){g={trigger:a,isCreatedByUser:a.user_id===o.currentUserId,saved_item_id:null!==(t=null!=e?e:a.saved_item_id)&&void 0!==t?t:null};break}}let p=m.some(e=>e.isCreatedByUser)||null!==(r=null==g?void 0:g.isCreatedByUser)&&void 0!==r&&r;return{nodeTriggerConfigs:m,timeTriggerConfig:g,hasUserCreatedTriggers:p}})({triggersBySavedItem:f,currentUserId:l.user_id,projectId:a,interfaceCreatorUserId:null!=s?s:null,interfaceAuthorId:null!=i?i:null}),[f,l.user_id,a,s,i]);(0,n.useEffect)(()=>{c({})},[a]),(0,n.useEffect)(()=>{var e;if(null==v?void 0:null===(e=v.trigger)||void 0===e?void 0:e.event){let e=v.trigger.event;m({cron_expression:e.cron_expression,timezone:e.timezone})}else m({cron_expression:void 0,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone})},[v,a]);let _=(0,ep.h)({queries:h.map(e=>{let{nodeId:r,trigger:a}=e;return{queryKey:["trigger-parameters",a.saved_item_id,r],queryFn:async()=>{let e=await (0,ef.eN)("trigger_parameters/".concat(a.saved_item_id,"/").concat(r),l,o.current,"GET");return{nodeId:r,data:e}},enabled:!!t&&h.length>0}})}),j=(0,n.useMemo)(()=>{let e={};return h.forEach(t=>{let{nodeId:r}=t;e[r]=null}),_.forEach(t=>{var r,a,n;let s=null===(r=t.data)||void 0===r?void 0:r.nodeId;s&&(null===(n=t.data)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.declaration)&&(e[s]=t.data.data.declaration)}),e},[_,h]);(0,n.useEffect)(()=>{!t||_.some(e=>e.isLoading)||c(e=>{let t={};return(h.forEach(r=>{let{nodeId:a,trigger:n}=r,s=j[a];if(!s||e[a]&&e[a].length>0)return;let i=function(e,t){let r=ex.x.getNodeParameterValuesFromEvent(e.name,e.version,t);return[...e.parameters||[],...e.additional_parameters||[]].filter(e=>(e.is_trigger_parameter||"CredentialsPicker"===e.data_type)&&!e.name.endsWith("_map")).map(e=>{let t=r[e.name],a=null!=t?t:"CredentialsPicker"===e.data_type?{}:"";return(0,X.A)(e,a)})}(s,n.event||{});t[a]=i}),Object.keys(t).length>0)?{...e,...t}:e})},[_,h,j,t]);let y=(0,n.useCallback)((e,t,r)=>{c(a=>{let n=[...a[e]||[]],s=n.findIndex(e=>e.name===t);if(s>=0)n[s]={...n[s],value:r};else{var i,l;let a=j[e],s=(null==a?void 0:null===(i=a.parameters)||void 0===i?void 0:i.find(e=>e.name===t))||(null==a?void 0:null===(l=a.additional_parameters)||void 0===l?void 0:l.find(e=>e.name===t));s&&n.push((0,X.A)(s,r))}return{...a,[e]:n}})},[j]),N=(0,n.useCallback)((e,t)=>{c(r=>{let a=[...r[e]||[]];return t.forEach(t=>{let r=a.findIndex(e=>e.name===t.parameterName);if(r>=0)a[r]={...a[r],value:t.newValue};else{var n,s;let r=j[e],i=(null==r?void 0:null===(n=r.parameters)||void 0===n?void 0:n.find(e=>e.name===t.parameterName))||(null==r?void 0:null===(s=r.additional_parameters)||void 0===s?void 0:s.find(e=>e.name===t.parameterName));i&&a.push((0,X.A)(i,t.newValue))}}),{...r,[e]:a}})},[j]),k=(0,n.useCallback)(e=>{m(e)},[]),w=(0,n.useMemo)(()=>{let e={};if(u&&u.cron_expression){let t=[];u.timezone||t.push("Timezone is required"),t.length>0&&(e.time=t)}return h.forEach(t=>{let{nodeId:r}=t,a=j[r],n=d[r]||[];if(!a){e[r]=["Unable to load trigger parameters for this node"];return}let s=(a.parameters||[]).some(e=>e.is_trigger_parameter);if(!a.is_trigger_node&&!s)return;let i=function(e,t,r){let a=[],n=[...t.parameters||[],...t.additional_parameters||[]],s=n.map(t=>e.find(e=>e.name===t.name)||(0,X.A)(t,"")),i=s.findIndex(e=>"_is_trigger_enabled"===e.name);if(i>=0)s[i]={...s[i],value:"true"};else{let e=n.find(e=>"_is_trigger_enabled"===e.name);e&&s.push((0,X.A)(e,"true"))}let l={...r,parameters:s};return n.filter(e=>e.is_trigger_parameter||"CredentialsPicker"===e.data_type).filter(e=>!e.name.endsWith("_map")).filter(e=>(0,$.P_)(e,s,l,void 0)).forEach(t=>{if("credentials_to_use"===t.name)return;let r=e.find(e=>e.name===t.name);t.is_optional||r&&null!==r.value&&void 0!==r.value&&""!==r.value||a.push("".concat(t.name," is required"))}),a}(n,a,{name:"",inputs:[],outputs:[],parameters:n,declaration:a,connectedInputBadges:[]});try{ex.x.getTriggerData(a.name,a.version,n,!0)||i.push("Invalid trigger configuration")}catch(e){i.push("Invalid trigger configuration")}i.length>0&&(e[r]=i)}),e},[u,h,j,d]),C=(0,n.useMemo)(()=>0===Object.keys(w).length,[w]),I=(0,n.useCallback)(()=>0===Object.keys(w).length,[w]),T=(0,n.useCallback)(()=>{let e=[];return(null==u?void 0:u.cron_expression)&&u.timezone&&e.push({trigger_type:"time_based",event:{cron_expression:u.cron_expression,timezone:u.timezone}}),h.forEach(t=>{let{nodeId:r}=t,a=j[r],n=d[r]||[];if(a&&a.is_trigger_node)try{let t=ex.x.getTriggerData(a.name,a.version,n,!0);t&&e.push({trigger_type:t.triggerType,node_id:r,event:t.event})}catch(e){}}),e},[u,h,j,d]),E=(0,n.useMemo)(()=>({isValid:C,triggerData:T()}),[C,T]),D=(0,n.useMemo)(()=>{let e=_.some(e=>e.isLoading);return"display"===r&&x||e},[_,x,r]),Z=(0,n.useMemo)(()=>{let e=[];return(null==v?void 0:v.isCreatedByUser)&&v.trigger&&e.push(v.trigger),h.forEach(t=>{let{isCreatedByUser:r,trigger:a}=t;r&&e.push(a)}),e},[v,h]),S=(0,n.useMemo)(()=>{let e=[];return(null==v?void 0:v.trigger)&&e.push(v.trigger),h.forEach(t=>{let{trigger:r}=t;e.push(r)}),e},[v,h]);return{nodeDeclarations:j,nodeParameters:d,timeTrigger:u,validationErrors:w,isValid:C,isLoading:D,nodeTriggerConfigs:h,timeTriggerConfig:v,hasUserCreatedTriggers:b,selectedUserTriggers:Z,selectedEffectiveTriggers:S,draft:E,actions:{updateNodeParameter:y,updateTimeTrigger:k,validateAll:I,getTriggerData:T,handleParameterChanges:N}}}({savedItemId:i,mode:l?"display":"builder",projectId:o,interfaceCreatorUserId:d,interfaceAuthorId:c}),f=x.nodeTriggerConfigs.length>0,h=!!(null===(t=x.timeTriggerConfig)||void 0===t?void 0:t.trigger)||!!(null===(r=x.timeTrigger)||void 0===r?void 0:r.cron_expression),v=f||h||x.hasUserCreatedTriggers;(0,n.useEffect)(()=>{l&&x.hasUserCreatedTriggers&&m(!0)},[x.hasUserCreatedTriggers,m]),(0,n.useEffect)(()=>{l&&p(x.selectedUserTriggers)},[l,x.selectedUserTriggers,p]),(0,n.useEffect)(()=>{if(l){if(!u){g({isValid:!0,triggerData:[]});return}g(x.draft)}},[l,u,x.draft,g]);let b=(0,n.useMemo)(()=>x.nodeTriggerConfigs,[x.nodeTriggerConfigs]);return l&&(v||x.isLoading)?(0,a.jsxs)("div",{className:"bg-card bg-muted flex flex-col gap-4 rounded-lg p-4 px-4",children:[(0,a.jsxs)("label",{className:"flex items-center justify-between gap-6",htmlFor:"configure-flow-as-trigger-switch",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-md font-semibold",children:x.hasUserCreatedTriggers&&!u?"See your existing subscriptions":"Subscribe to this Workflow"}),(0,a.jsx)("span",{className:"text-muted-foreground text-xs",children:"Create a trigger for this workflow, and set the values that will be used for each triggered run."})]}),(0,a.jsxs)(O.u,{children:[(0,a.jsx)(O.aJ,{children:(0,a.jsx)(H.r,{id:"configure-flow-as-trigger-switch",checked:u,onCheckedChange:e=>m(e)})}),x.hasUserCreatedTriggers&&(0,a.jsx)(O._v,{children:"You are subscribed to this workflow, please unsubscribe first before turning this off."})]})]}),(0,a.jsx)("div",{className:"space-y-3",children:x.isLoading?(0,a.jsxs)("div",{className:"text-muted-foreground bg-background flex items-center gap-2 rounded-md border p-2 text-sm",children:[(0,a.jsx)("div",{className:"border-border flex size-8 items-center justify-center rounded-md border p-1",children:(0,a.jsx)(q.Z,{className:"size-4 animate-spin"})}),(0,a.jsx)("p",{className:"animate-pulse text-sm font-medium",children:"Loading Triggers..."})]}):v?(0,a.jsxs)("div",{className:"bg-background overflow-visible rounded-md border",children:[h&&i&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ec,{value:x.timeTrigger||{},validationErrors:null===(s=x.validationErrors)||void 0===s?void 0:s.time,onChange:x.actions.updateTimeTrigger,viewOnly:!u}),f&&(0,a.jsx)(B.Z,{className:"bg-border/75"})]}),f&&b.map(e=>{let{nodeId:t}=e;return(0,a.jsx)(n.Fragment,{children:(0,a.jsx)(ei,{nodeId:t,viewOnly:!u,declaration:x.nodeDeclarations[t],parameters:x.nodeParameters[t]||[],validationErrors:x.validationErrors[t],onParameterChange:(e,r)=>x.actions.updateNodeParameter(t,e,r),onParameterChanges:e=>x.actions.handleParameterChanges(t,e)})},t)})]}):(0,a.jsx)("div",{className:"text-muted-foreground bg-background flex items-center gap-2 rounded-md border p-2 text-sm",children:"No triggers available for this workflow."})})]}):l?(0,a.jsx)("div",{className:"bg-card bg-muted flex flex-col gap-4 rounded-lg p-4 px-4",children:(0,a.jsxs)("label",{className:"flex items-center justify-between gap-6",htmlFor:"configure-flow-as-trigger-switch",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-md font-semibold",children:"Subscribe to this Workflow (Access Required)"}),(0,a.jsx)("span",{className:"text-muted-foreground text-xs",children:"This workflow allows subscriptions, but you don't have access to the workflow. Please contact the owner to share the workflow with you."})]}),(0,a.jsx)(H.r,{id:"configure-flow-as-trigger-switch",checked:!1,onCheckedChange:()=>{},disabled:!0})]})}):null});e_.displayName="InterfaceFlowSubscription";let ej=e=>null==e,ey=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return ej(e)?t:e},eN=function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return r&&ej(e)&&!ej(t)?t:ey(e,a)},ek=e=>{let{element:t,index:r,onUpdate:o,onDelete:g,isDisplayMode:p=!1,savedItemId:x,hasValidationError:f=!1,setHasValidationError:h,dragHandleProps:v,isLocked:b=!1,isTriggerModeEnabled:_,setIsTriggerModeEnabled:j,onTriggerDraftChange:y,onExistingUserTriggersChange:z,projectId:A,interfaceCreatorUserId:M,interfaceAuthorId:F}=e,{userProfile:U}=(0,P.H)(),V=(0,T.Z)(),[O,L]=(0,n.useState)(),[R,G]=(0,n.useState)([]),q=(0,n.useMemo)(()=>"is_required"in t,[t]),[B,H]=(0,n.useState)(ey(t.value,ey(t.default,""))),[J,K]=(0,n.useState)(q?ey(t.input_name,""):"");(0,n.useEffect)(()=>{G([])},[t.input_name,t.type]),(0,n.useEffect)(()=>{if(!q){"content"in t&&t.content!=B&&H(t.content||"");return}"Email"===t.type&&t.auto_fill_email&&!t.value&&!B&&U.user_email||t.value==B||H(q&&t.value||""),t.input_name!=J&&K(q&&t.input_name||"")},[t,B,q,U.user_email]),(0,n.useEffect)(()=>{"Email"===t.type&&t.auto_fill_email&&null===t.value&&!B&&U.user_email&&(H(U.user_email),Y({value:U.user_email}),$(U.user_email))},[U.user_email,t.type,t.auto_fill_email,t.value,B]);let Y=(0,n.useCallback)(e=>{o(r,{...t,...e})},[t,r,o]),X=(0,n.useMemo)(()=>d()(e=>{e()},500),[]),$=e=>{X(()=>{let r=(0,D.tk)(t),a=t.default||"";if(r){let n=r(e||a,t);G(n),p&&(null==h||h(n.length>0))}})},Q=(0,n.useCallback)(e=>p?ey(e.value,ey(e.default,"")):B,[p,B]),ee=e=>{switch(t.type){case"TextField":return(0,a.jsx)(k.I,{placeholder:t.placeholder,className:"w-full",value:Q(t),onChange:e=>{let t=e.target.value;H(t),Y({value:t}),$(t)},multiline:!0,maxLines:16});case"SelectDropdown":return(0,a.jsx)(C.Z,{options:t.options,value:eN(t.value,t.default,!0===e,t.options.length>0?t.options[0]:""),onChange:e=>{Y({value:e}),$(e)}});case"MultiSelectDropdown":{let r=t.options.map(e=>({value:e,label:e})),n=eN(t.value,t.default,!0===e,[]).map(e=>({value:e,label:e}));return(0,a.jsx)(w.Z,{isMulti:!0,noPortal:!0,options:r,value:n,onChange:e=>{let t=e.map(e=>e.value);Y({value:t}),$(t)}})}case"Checkbox":return(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(I.Z,{className:"text-muted-foreground",textSize:"md",checked:!!(e&&ej(t.value))&&"true"===t.default||"true"===t.value,onChange:e=>{let t=e.target.checked.toString();Y({value:t}),$(t)}})});case"Email":return(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)(k.I,{type:"email",placeholder:t.placeholder,className:(0,Z.cn)("w-full",t.auto_fill_email&&"pr-20"),value:Q(t),onChange:e=>{let t=e.target.value;H(t),Y({value:t}),$(t)}}),t.auto_fill_email&&(0,a.jsx)(c.C,{variant:"accent",size:"xs",className:"absolute top-1/2 right-2 -translate-y-1/2",children:"Autofill on"})]});case"Date":return(0,a.jsx)("div",{className:"text-foreground! w-full",children:(0,a.jsx)(N,{value:eN(t.value,t.default,!0===e,""),onChange:e=>{Y({value:e}),$(e)}})});case"Number":return(0,a.jsx)(k.I,{type:"number",placeholder:t.placeholder,min:t.min_value,max:t.max_value,className:"w-1/5",value:Q(t),onChange:e=>{let t=e.target.value;H(t),Y({value:t}),$(t)}});case"FileUpload":{let e;let r=t.file_category||"All";return"Custom"===r?e=t.custom_file_extensions:r in E&&(e=[...E[r]]),(0,a.jsx)(S.Z,{existingFile:O,setFile:L,userProfile:U,onUpload:e=>{Y({value:e}),$(e)},isDisabled:!1,allowedFileExtensions:e})}case"Heading":return e?(0,a.jsx)("p",{className:"mt-4 block w-full pt-3 pb-2 text-4xl font-semibold break-words",children:t.content}):(0,a.jsx)(k.I,{value:B,onChange:e=>{let t=e.target.value;H(t),Y({content:t})},onKeyDown:e=>{"Enter"===e.key&&e.preventDefault()},className:"block w-full rounded-md !border-0 px-4 pt-3 pb-2 text-4xl font-semibold break-words !ring-0 !outline-none focus:!border-0 focus:!ring-0 focus:!outline-none",style:{outline:"none",border:"none"},placeholder:"Enter heading...",multiline:!0});case"Description":return e?(0,a.jsx)("p",{className:"text-muted-foreground block w-full py-2 text-lg break-words",children:t.content}):(0,a.jsx)(k.I,{value:B,onChange:e=>{let t=e.target.value;H(t),Y({content:t})},onKeyDown:e=>{"Enter"===e.key&&e.preventDefault()},className:"block w-full rounded-md !border-0 px-4 py-2 text-lg break-words !ring-0 !outline-none focus:!border-0 focus:!ring-0 focus:!outline-none",style:{outline:"none",border:"none"},placeholder:"Enter description...",multiline:!0});case"Divider":return(0,a.jsx)("hr",{className:"my-4"});case"TriggerConfiguration":if(!V)return null;if(!j||!y||!z)return console.error("Trigger Configuration element is missing required props"),null;return(0,a.jsx)(e_,{savedItemId:x,isDisplayMode:!0===e,projectId:A,interfaceCreatorUserId:M,interfaceAuthorId:F,isTriggerModeEnabled:null!=_&&_,setIsTriggerModeEnabled:j,onTriggerDraftChange:y,onExistingUserTriggersChange:z});default:return(0,a.jsxs)("div",{children:["Unsupported element type: ",t.type]})}};return(0,a.jsx)("div",{className:(0,Z.cn)("group relative",!p&&"rounded-lg border px-4 py-3",f&&"ring-destructive-foreground ring-2"),children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"mb-2 flex items-center gap-2",children:[!p&&!b&&(0,a.jsxs)("div",{className:"absolute -left-14 flex items-center",children:[(0,a.jsx)(u.zx,{variant:"ghost",size:"icon-xs",accent:"destructive",className:"opacity-0 transition-opacity group-hover:opacity-100",onClick:()=>g(r),children:(0,a.jsx)(s.Z,{className:"size-4"})}),v&&(0,a.jsx)("div",{className:"p-1 opacity-0 transition-opacity group-hover:opacity-100",...v,children:(0,a.jsx)(i.Z,{className:"size-4"})})]}),q?p?(0,a.jsx)("div",{className:"font-semibold",children:t.input_name||""}):(0,a.jsx)(k.I,{value:J,onChange:e=>{let t=e.target.value;K(t),Y({input_name:t})},className:"focus-within:bg-background hover:bg-background w-full border-0 bg-transparent px-0 font-medium focus-within:border focus-within:px-3",placeholder:"Add label..."}):(0,a.jsx)("div",{className:"flex-1",children:ee(p)}),q&&!p&&(0,a.jsxs)(m.J2,{modal:!0,children:[(0,a.jsx)(m.xo,{children:(0,a.jsx)(u.zx,{variant:"ghost",size:"icon-sm",children:(0,a.jsx)(l.Z,{className:"size-4"})})}),(0,a.jsx)(m.yk,{children:(0,a.jsx)(W,{element:t,onUpdate:Y})})]})]}),(0,a.jsx)("div",{className:"flex gap-4",children:(0,a.jsx)("div",{className:"flex-1 rounded-md",children:q&&(0,a.jsxs)(a.Fragment,{children:[ee(p),(t.helper_text||t.is_required)&&(0,a.jsxs)("div",{className:"mt-1 ml-3 flex justify-between",children:[(0,a.jsx)("span",{className:"text-muted-foreground text-xs",children:t.helper_text}),t.is_required&&(0,a.jsxs)("span",{className:"text-destructive-foreground relative text-xs",children:[(0,a.jsx)("span",{className:"absolute -top-[0.1rem] -left-1.5",children:"*"}),"Required"]})]}),R.length>0&&(0,a.jsx)("div",{className:"mt-1",children:R.map((e,t)=>(0,a.jsx)("span",{className:"text-destructive-foreground block text-xs",children:e.message},t))})]})})})]})})})}},14908:function(e,t,r){"use strict";var a=r(85893),n=r(67294),s=r(23432),i=r(78865),l=r(71707),o=r(41664),d=r.n(o),c=r(86501),u=r(29876),m=r(90273),g=r(97257),p=r(45837),x=r(18998),f=r(73793);t.Z=e=>{let{isDisabled:t,handleParameterChanges:r,parameter:o,parameters:h,declaration:v,declarationParameter:b,error:_,foldersOnly:j=!1,sheetsOnly:y=!1,formsOnly:N=!1,presentationsOnly:k=!1,className:w}=e,{userProfile:C,idTokenRef:I}=(0,n.useContext)(p.f),{currentProject:T}=(0,n.useContext)(g.xI),[E,P]=(0,n.useState)(!1),[D,Z]=(0,n.useState)(!1),[S,z]=(0,n.useState)(!1),[A,M]=(0,n.useState)(""),[F,U]=(0,n.useState)("");(0,n.useEffect)(()=>{if(o&&h){let e=h.find(e=>"file_name"===e.name&&e.value),t=h.find(e=>"file_url"===e.name&&e.value);e&&t&&(z(!0),M(e.value),U(t.value))}},[o,h]);let V=e=>{var t;if(null===(t=window.google)||void 0===t?void 0:t.picker)O(e);else{let t=document.createElement("script");t.src="https://apis.google.com/js/api.js",t.onload=()=>{window.gapi.load("picker",{callback:O.bind(null,e)})},document.body.appendChild(t)}},O=e=>{if(!e){c.Am.error("Access token is not available.");return}let t=j?google.picker.ViewId.FOLDERS:google.picker.ViewId.DOCS,r=new google.picker.DocsView(t).setIncludeFolders(!0).setSelectFolderEnabled(j).setMimeTypes(k?"application/vnd.google-apps.presentation":y?"application/vnd.google-apps.spreadsheet":N?"application/vnd.google-apps.form":j?"":"application/pdf,text/plain,application/json,text/csv,text/html,application/vnd.google-apps.document,application/vnd.google-apps.presentation,application/vnd.google-apps.spreadsheet,video/mp4,image/jpeg,image/png,image/gif,image/webp,image/bmp,image/svg+xml").setMode(google.picker.DocsViewMode.LIST);new google.picker.PickerBuilder().addView(r).setOAuthToken(e).setAppId("143190353106").setCallback(L).disableFeature(google.picker.Feature.MULTISELECT_ENABLED).build().setVisible(!0)},L=e=>{if(e[google.picker.Response.ACTION]===google.picker.Action.PICKED){let t=e[google.picker.Response.DOCUMENTS][0],a=t[google.picker.Document.ID],n=t[google.picker.Document.NAME],s=t[google.picker.Document.URL];o&&h&&(r([{parameterName:b.name,newValue:a},{parameterName:"file_name",newValue:n},{parameterName:"file_url",newValue:s}]),z(!0),M(n),U(s))}},R="gdrive_access_token",G=null==h?void 0:h.find(e=>"credentials_to_use"===e.name),W=null==G?void 0:G.value,q=null==W?void 0:W[R];(0,n.useEffect)(()=>{!v||v.secrets[R]||q||r([{parameterName:"credentials_to_use",newValue:{...W,[R]:{secret_id:void 0,is_personal_credential:!0,is_default:!0}}}])},[W,v,q,r]);let B=async()=>{try{Z(!0);let e=null==q?void 0:q.secret_id,t=new URLSearchParams({secret_type:R,...e&&{secret_id:e},...!(null==q?void 0:q.is_personal_credential)&&T&&{project_id:T.project_id}}),r="secret?".concat(t.toString()),a=await (0,m.eN)(r,C,I.current,"GET");V(a)}catch(e){P(!0)}Z(!1)};return(0,a.jsxs)("div",{className:(0,x.cn)("nodrag flex flex-col gap-2",w),children:[(0,a.jsxs)("div",{className:"flex items-center justify-center p-1",children:[(0,a.jsx)(f.Z,{immediatePipelineEvaluationResult:{[R]:[{credential:null!=q?q:{is_personal_credential:!0,is_default:!0},scopes:["https://www.googleapis.com/auth/drive.file"],result:{missingScopes:["https://www.googleapis.com/auth/drive.file"],isValid:!1}}]},open:E,onOpenChange:P,immediateOnAuthSuccess:()=>P(!1)}),(0,a.jsxs)(u.zx,{className:"flex min-w-1/2",variant:"outline",onClick:B,disabled:t||D,children:[D?(0,a.jsx)(s.Z,{className:"size-5 animate-spin"}):S?(0,a.jsx)(i.Z,{className:"text-success-foreground"}):(0,a.jsx)("img",{src:"images/google.png",className:"size-5"}),S?"".concat(A):j?"Pick Folder":"Pick File"]}),S&&(0,a.jsx)(d(),{className:"pl-1",href:F,target:"_blank",rel:"noopener noreferrer",children:(0,a.jsx)(u.zx,{variant:"ghost",size:"icon",accent:"accent",className:"text-muted-foreground",children:(0,a.jsx)(l.Z,{})})})]}),_&&(0,a.jsx)("p",{className:"text-destructive-foreground text-sm",children:_})]})}},20997:function(e,t,r){"use strict";var a,n,s=r(85893),i=r(45788),l=r(67294),o=r(28900),d=r(4270),c=r(29871),u=r(82606),m=r(23157),g=r(32248),p=r(29876),x=r(42414),f=r(97257),h=r(45837),v=r(5197),b=r(27801);(a=n||(n={})).WorkspaceCredential="Workspace Credential",a.PersonalCredential="Personal Credential";let _=m.ZP,j=(0,l.memo)(e=>{var t;let{className:r,data:{secretType:a,extraInfo:n},unknown:i}=e;return(0,s.jsxs)("div",{className:"flex items-center gap-2.5 ".concat(null!=r?r:""),children:[(0,s.jsx)("img",{src:null===(t=(0,b.vw)(a.secret_type))||void 0===t?void 0:t.image_path,alt:a.secret_type,className:"bg-muted h-8 w-8 rounded-md object-scale-down p-1.5"}),(0,s.jsxs)("div",{className:"flex grow-0 flex-col truncate",children:[(0,s.jsx)("div",{className:"text-foreground flex items-center gap-2",children:(0,s.jsx)("span",{className:"truncate text-xs font-semibold",children:i?"Unknown credential":a.nickname})}),n&&!i&&(0,s.jsx)("span",{className:"text-xxs text-muted-foreground truncate",children:n})]})]})});j.displayName="CustomValue";let y=e=>(0,s.jsxs)("div",{className:"text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-xs normal-case",children:e.label}),e.label&&(0,s.jsxs)(x.u,{children:[(0,s.jsx)(x.aJ,{asChild:!0,children:(0,s.jsx)(o.Z,{className:"h-3 w-3 cursor-pointer"})}),(0,s.jsx)(x._v,{children:(0,s.jsx)("span",{className:"text-md",children:e.label.includes("Workspace")?"Workspace credentials are shared across all members of this workspace.":e.label.includes("Personal")?"Personal credentials are only usable by your personal account.":"Uses the user's default credentials when running this node."})})]})]}),N=e=>t=>{var r;return{secretType:t,type:e,extraInfo:"".concat((null===(r=(0,b.vw)(t.secret_type))||void 0===r?void 0:r.isOAuth)?"Last refreshed":"Created"," ").concat((0,v.Sy)(new Date(t.created_ts),!0))}},k=(0,l.memo)(e=>{var t,r,a,n,i;let{secret:o,personalSecretTypes:c,options:u,projectId:m,selectedCredential:f,onCredentialChange:h,error:v,disabled:N,disabledTooltip:k}=e,w=[{label:"Default Credentials",options:[{secretType:{secret_id:null===(t=u[0])||void 0===t?void 0:t.secretType.secret_id,secret_type:o,nickname:"Use ".concat(m?"Workspace":"Personal"," Default"),is_default:!0,created_ts:""},type:m?"Workspace Credential":"Personal Credential",extraInfo:"Currently ".concat(u.length>0?null===(r=u[0])||void 0===r?void 0:r.secretType.nickname:"none")}]},{label:m?"All Workspace Credentials":"All Personal Credentials",options:u}];m&&w[0].options.push({secretType:{secret_id:null===(i=c.find(e=>(0,b.Dq)(o).includes(e.secret_type)&&e.is_default))||void 0===i?void 0:i.secret_id,secret_type:o,nickname:"Use Personal Default",is_default:!0,created_ts:""},type:"Personal Credential"});let C=!!(null==f?void 0:f.secret_id)&&!(null==f?void 0:f.is_default)&&!u.find(e=>e.secretType.secret_id===f.secret_id),I=(0,l.useCallback)(e=>(0,s.jsx)(g.c.Option,{...e,children:(0,s.jsx)(j,{data:e.data})}),[]),T=(0,l.useCallback)(e=>{let t=e.getValue()[0];return(0,s.jsx)(g.c.SingleValue,{...e,children:t&&(0,s.jsx)(j,{data:t,unknown:C})})},[C]),E=(0,l.useCallback)(e=>(0,s.jsxs)(g.c.MenuList,{...e,className:"cursor-default",children:[e.children,(0,s.jsx)("div",{className:"bg-border mx-auto my-1 h-px w-11/12"}),(0,s.jsxs)("a",{className:"bg-background hover:bg-muted flex w-full items-center gap-2.5 px-3 py-2 transition-none",href:m?"".concat(window.location.origin,"/settings/workspace/").concat(m,"/credentials"):"".concat(window.location.origin,"/settings/profile/credentials"),target:"_blank",rel:"noopener noreferrer",children:[(0,s.jsx)(p.zx,{variant:"secondary",size:"icon",className:"nodrag",children:(0,s.jsx)(d.Z,{})}),(0,s.jsx)("span",{className:"truncate text-xs font-semibold",children:"Add New Credential"})]})]}),[m]),P=e=>{let t=e.type===((null==f?void 0:f.is_personal_credential)?"Personal Credential":"Workspace Credential"),r=(null==f?void 0:f.is_personal_credential)?"Use Personal Default"===e.secretType.nickname:"Use Workspace Default"===e.secretType.nickname;return(null==f?void 0:f.is_default)||(null==f?void 0:f.secret_id)===void 0?t&&r:t&&e.secretType.secret_id===(null==f?void 0:f.secret_id)&&!r},D=w.flatMap(e=>e.options),Z=(0,s.jsx)(_,{options:w,className:"nodrag nowheel",defaultValue:null===(n=w[0])||void 0===n?void 0:null===(a=n.options)||void 0===a?void 0:a[0],value:f&&D.find(P),onChange:e=>{N||h((null==e?void 0:e.secretType.nickname)==="Use Workspace Default"||(null==e?void 0:e.secretType.nickname)==="Use Personal Default"?{secret_id:null==e?void 0:e.secretType.secret_id,is_personal_credential:(null==e?void 0:e.type)==="Personal Credential",is_default:!0}:{secret_id:null==e?void 0:e.secretType.secret_id,is_personal_credential:(null==e?void 0:e.type)==="Personal Credential",is_default:!1})},isOptionSelected:e=>!C&&P(e),styles:{control:e=>({...e,border:v?"1px solid var(--destructive)":"1px solid var(--border)",borderRadius:"6px",boxShadow:"none","&:hover":{border:v?"1px solid var(--destructive)":"1px solid var(--border)"},padding:"6px 0",backgroundColor:"var(--background)",color:"var(--foreground)",opacity:N?.6:1,cursor:N?"not-allowed":"default"}),group:e=>({...e,padding:"0"}),groupHeading:e=>({...e,margin:"0",padding:"2px 12px"}),option:(e,t)=>({...e,backgroundColor:t.isSelected?"var(--accent)":"var(--background)",color:"var(--foreground)","&:hover":{backgroundColor:"var(--muted)"}}),menu:e=>({...e,borderRadius:"var(--radius)",padding:"4px 0",backgroundColor:"var(--background)",color:"var(--foreground)"}),menuList:e=>({...e,padding:"0"}),valueContainer:e=>({...e,padding:"0 6px"})},components:{Option:I,SingleValue:T,MenuList:E},formatGroupLabel:y,isSearchable:!1,isDisabled:N});return(0,s.jsxs)("div",{className:"flex flex-grow",children:[N&&k?(0,s.jsxs)(x.u,{children:[(0,s.jsx)(x.aJ,{asChild:!0,children:(0,s.jsx)("div",{className:"flex-grow",children:Z})}),(0,s.jsx)(x._v,{children:k})]}):Z,v&&(0,s.jsx)("p",{className:"text-destructive-foreground text-xs",children:v})]})});k.displayName="CredentialPicker";let w=e=>{let{parameter:t,parameters:r,declarationParameter:a,declaration:n,handleParameterChanges:o,error:d,isSuperNode:m,subNode:g,isDisabled:v,disabledTooltip:_}=e,{userProfile:j,idTokenRef:y}=(0,l.useContext)(h.f),{currentProject:w}=(0,l.useContext)(f.xI),{data:C,isFetching:I,refetch:T}=(0,i.jL)({userProfile:j,idToken:y.current,projectId:null==w?void 0:w.project_id},{skip:!w}),{data:E,isFetching:P,refetch:D}=(0,i.jL)({userProfile:j,idToken:y.current}),Z=I||P,S=()=>{w&&T(),D()},z=w?C:E,A=null==z?void 0:z.map(N(w?"Workspace Credential":"Personal Credential")),M=e=>r=>{var n;return o([{parameterName:a.name,newValue:{...null!==(n=null==t?void 0:t.value)&&void 0!==n?n:{},[e]:r}}])},F="secrets"in n?Object.keys(n.secrets).filter(e=>{var t;return!(null===(t=n.secret_conditions)||void 0===t?void 0:t[e])||(0,b.N)(n.secret_conditions[e],r,!!m,g)}):n.secret_types||[];return(0,s.jsx)("div",{className:"flex flex-col gap-2",children:F.map(e=>{var r;return A&&E&&!Z?(0,s.jsxs)("div",{className:"text-foreground flex items-center",children:[(0,s.jsx)(k,{secret:e,personalSecretTypes:E,projectId:null==w?void 0:w.project_id,options:A.filter(t=>(0,b.Dq)(e).includes(t.secretType.secret_type)),selectedCredential:null==t?void 0:null===(r=t.value)||void 0===r?void 0:r[e],onCredentialChange:M(e),error:d,disabled:v}),(0,s.jsxs)(x.u,{children:[(0,s.jsx)(x.aJ,{asChild:!0,children:(0,s.jsx)(p.zx,{className:"nodrag",onClick:v?void 0:S,disabled:v,variant:"ghost",size:"icon-sm",children:(0,s.jsx)(c.Z,{className:"text-muted-foreground"})})}),(0,s.jsx)(x._v,{children:v?_:"Changes? Click to refresh!"})]})]},e):(0,s.jsx)(u.Z,{className:"text-muted-foreground m-auto size-4 animate-spin"},e)})})};w.displayName="CredentialsPickerElement",t.ZP=(0,l.memo)(w)},4496:function(e,t,r){"use strict";var a=r(85893),n=r(67294),s=r(28900),i=r(42414);let l=e=>{let{description:t,className:r}=e,l=t?t.split("\n"):[],o=new RegExp(/(https?:\/\/[^\s]+)/g);return(0,a.jsxs)(i.u,{children:[(0,a.jsx)(i.aJ,{className:"nodrag text-muted-foreground cursor-pointer ".concat(r||""),children:(0,a.jsx)(s.Z,{className:"size-3 shrink-0 ".concat(r||"")})}),(0,a.jsx)(i._v,{side:"top",children:(0,a.jsx)("div",{children:l.map((e,t)=>{let r=e.match(o);return(0,a.jsx)(n.Fragment,{children:r?r.map((t,r)=>(0,a.jsxs)(n.Fragment,{children:[e.split(t)[0],(0,a.jsx)("a",{className:"text-pink-400",href:t,target:"_blank",rel:"noopener noreferrer",children:t}),e.split(t)[1],(0,a.jsx)("br",{})]},r)):(0,a.jsxs)(a.Fragment,{children:[e,(0,a.jsx)("br",{})]})},t)})})})]})};l.displayName="TooltipElement",t.Z=(0,n.memo)(l,(e,t)=>e.description===t.description&&e.className===t.className)},39397:function(e,t,r){"use strict";var a=r(85893),n=r(67294),s=r(18745),i=r(73864),l=r(62496),o=r(18998);t.Z=e=>{let{plConfig:t,plRun:r,runProgressPercentage:d,className:c,innerClassName:u}=e,m=(0,s.Z)(),g=(0,l.TV)(m.palette.mode),[p,x]=(0,n.useState)(0);return((0,n.useEffect)(()=>{if(d){x(d);return}if(!t)return;let e=t.pipeline.length,a=r.steps_completed?Object.keys(r.steps_completed).length:0;x("DONE"===r.state?100:a/e*100)},[t,r]),t||d)?(0,a.jsx)("div",{className:(0,o.cn)("bg-muted h-1.5 w-full rounded-full",c),children:(0,a.jsx)("div",{className:(0,o.cn)("FAILED"===r.state?"bg-destructive-foreground h-1.5 rounded-full":"TERMINATING"===r.state||"TERMINATED"===r.state?"bg-muted-foreground h-1.5 rounded-full":"bg-success-foreground h-1.5 rounded-full","RUNNING"===r.state&&"animate-pulse",u),style:{width:"".concat(p,"%")}})}):(0,a.jsx)(i.Z,{size:300,lineWeight:5,speed:1.4,color:g.greenAccent[500]})}},92647:function(e,t,r){"use strict";r.d(t,{Z:function(){return _}});var a=r(85893),n=r(2164),s=r(67294),i=r(33058),l=r(82606),o=r(56312),d=r(92458),c=r.n(d),u=r(87536),m=r(13472),g=r(29876),p=r(49200),x=r(64127);let f=e=>{let{disabled:t,interval:r=200}=e,[a,n]=(0,s.useState)("");return(0,s.useEffect)(()=>{if(t){n("");return}let e=!0,a=setInterval(()=>{e&&n(e=>"..."===e?"":e+".")},r);return()=>{e=!1,clearInterval(a)}},[t,r]),{ellipses:a}};var h=r(45837),v=r(18998);let b=(0,s.forwardRef)((e,t)=>{let{value:r,onChange:d,hideGenerateButton:b=!1,onGenerationStateChange:_,onDescriptionChange:j}=e,{userProfile:y,idTokenRef:N}=(0,h.H)(),[k,{isLoading:w,isError:C}]=(0,n.nL)(),I=(0,u.cI)({defaultValues:{description:""},resolver:(0,o.F)(m.z.object({description:m.z.string().min(1)})),mode:"onSubmit"}),T=(0,u.qo)({control:I.control,name:"description"});(0,s.useEffect)(()=>{null==_||_({isConvertingToCron:w,isCronError:C})},[w,C,_]),(0,s.useEffect)(()=>{let e=(T||"").trim().length>0;null==j||j(T||"",e)},[T,j]);let E=r.cron_expression,P=r.timezone||Intl.DateTimeFormat().resolvedOptions().timeZone,{ellipses:D}=f({disabled:!w}),Z=(0,s.useMemo)(()=>{if(E)try{return c().toString(E,{verbose:!0})}catch(e){return}},[E]),S=(0,s.useMemo)(()=>!!E&&!!Z,[E,Z]),z=async e=>{let t=await k({description:e,userProfile:y,idToken:N.current});if("error"in t)return;let[r,a,n,s,i]=t.data.cron_expression.split(" ");d({cron_expression:"".concat(r," ").concat(a," ").concat(n," ").concat(s," ").concat(i),timezone:P})},A=async e=>{await z(e.description)};return(0,s.useImperativeHandle)(t,()=>({generate:z,generateWithCurrentDescription:async()=>{let e=I.getValues("description");e.trim()&&await z(e)},getDescription:()=>I.getValues("description"),isDescriptionValid:()=>I.formState.isValid,isConvertingToCron:w,isCronError:C})),(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)(p.l0,{...I,children:(0,a.jsxs)("form",{className:"flex flex-row items-end gap-3",onSubmit:I.handleSubmit(A),children:[(0,a.jsx)(p.Wi,{control:I.control,name:"description",render:e=>{let{field:t}=e;return(0,a.jsx)(p.xJ,{className:"flex-grow",children:(0,a.jsx)(p.NI,{children:(0,a.jsx)(x.I,{...t,placeholder:"Every other day at 3PM"})})})}}),!b&&(0,a.jsxs)(g.zx,{type:"submit",disabled:!I.formState.isValid||w,variant:"secondary",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),"Generate"]})]})}),(w||C||S)&&(0,a.jsx)("div",{className:(0,v.cn)("bg-muted text-muted-foreground min-h-9 rounded-md border p-2 text-sm",C&&"border-destructive-foreground/50 bg-destructive text-destructive-foreground"),children:w?(0,a.jsxs)("span",{className:"flex items-center justify-between gap-2",children:[(0,a.jsxs)("span",{children:["Generating cron expression",D]}),(0,a.jsx)(l.Z,{className:"size-4 animate-spin"})]}):C?(0,a.jsx)("p",{children:"Invalid cron expression, please try again."}):(0,a.jsx)("p",{children:Z})})]})});b.displayName="TimeTriggerEventConfiguration";var _=b},84385:function(e,t,r){"use strict";var a=r(85893),n=r(25675),s=r.n(n),i=r(42414),l=r(68262),o=r(18998);let d=e=>{let{children:t,triggerType:r,count:n,className:s,hideTooltip:d,...c}=e;return d?(0,a.jsx)("div",{className:(0,o.cn)("flex items-center justify-center gap-2",s),...c,children:t}):(0,a.jsxs)(i.u,{children:[(0,a.jsx)(i.aJ,{asChild:!0,children:(0,a.jsx)("div",{className:(0,o.cn)("flex items-center justify-center gap-2",s),...c,children:t})}),(0,a.jsxs)(i._v,{children:[l.ZP[r]," ",n&&n>1?"(".concat(n,")"):""]})]})};t.Z=e=>{let{triggerType:t,count:r,size:n,className:i,noColour:c,fallbackIcon:u,hideTooltip:m,...g}=e,p=t||"manual",x=l.qT[p],f=l.RT[p];if(!x||!f){if(u)return u;let e=l.qT.manual,t=l.RT.manual;return(null==e?void 0:e.type)==="Icon"?(0,a.jsx)(d,{triggerType:p,count:r,className:(0,o.cn)(i),hideTooltip:m,...g,children:(0,a.jsx)(e.Icon,{width:n,height:n,className:c?"":null==t?void 0:t.color})}):null}return"Icon"===x.type?(0,a.jsx)(d,{triggerType:p,count:r,className:(0,o.cn)(i),hideTooltip:m,...g,children:(0,a.jsx)(x.Icon,{width:n,height:n,className:c?"":f.color})}):(0,a.jsx)(d,{triggerType:p,count:r,className:(0,o.cn)(i),hideTooltip:m,...g,children:(0,a.jsx)(s(),{src:x.image,alt:p,width:n,height:n,className:c?"":f.color})})}},73793:function(e,t,r){"use strict";r.d(t,{Z:function(){return F}});var a=r(85893),n=r(82141),s=r(22495),i=r(13889),l=r(94364),o=r(34376),d=r(57939),c=r(62685),u=r(77739),m=r(45788),g=r(67294),p=r(25675),x=r.n(p),f=r(29876),h=r(7161),v=r(97387),b=r(54178),_=r(22455),j=r(97257),y=r(45837),N=r(49230),k=r(1557),w=r(27801),C=r(8267),I=r(28979),T=r(74598),E=r(78865),P=r(62190),D=r(71424),Z=r(42414),S=r(35152),z=r(95470);let A=e=>{let{secretDeclaration:t,result:r,personalSecretTypes:n,projectSecretTypes:s,projectId:i,onAuthSuccess:l,declaration:o}=e,{credential:d,scopes:c,result:{missingScopes:u}}=r,m=!i||!!d.is_personal_credential,g=d.is_default||!d.secret_id,p=m?n:s,x=null==p?void 0:p.find(e=>(g?e.is_default:e.secret_id===d.secret_id)&&e.secret_type===t.secret_type),f=null==x?void 0:x.nickname,h=g?"Default ".concat(m?"personal":"workspace"):null!=f?f:"Unknown credential";return(0,a.jsxs)("div",{className:"flex w-full items-center justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex min-w-0 items-center gap-2 text-sm",children:[(0,a.jsxs)(Z.u,{children:[(0,a.jsx)(Z.aJ,{className:"bg-muted text-muted-foreground rounded-md border p-1.5",children:m?(0,a.jsx)(C.Z,{className:"h-4 w-4"}):(0,a.jsx)(I.Z,{className:"h-4 w-4"})}),(0,a.jsx)(Z._v,{children:m?"Personal credential":"Workspace credential"})]}),(0,a.jsxs)("div",{className:"flex min-w-0 flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"truncate font-medium",title:h,children:h}),(null==c?void 0:c.length)&&(null==u?void 0:u.length)&&(0,a.jsxs)(Z.u,{children:[(0,a.jsx)(Z.aJ,{className:"text-muted-foreground flex items-center justify-start gap-1 text-xs",children:(0,a.jsxs)(D.C,{variant:"warning",size:"sm",className:"flex items-center gap-1",children:[c.length-u.length,"/",c.length,(0,a.jsx)(T.Z,{})]})}),(0,a.jsxs)(Z._v,{className:"flex flex-col gap-0.5",children:[(0,a.jsx)("p",{className:"font-medium",children:"Needs the following scope(s):"}),c.length?(0,a.jsx)("ul",{children:c.map(e=>{var t;let{flag:r,displayName:n}=(0,w.Gx)(e);return(0,a.jsxs)("li",{className:"flex items-center gap-1",children:[(null==x?void 0:null===(t=x.scopes)||void 0===t?void 0:t.includes(e))?(0,a.jsx)(E.Z,{className:"text-success-foreground h-3 w-3"}):(0,a.jsx)(P.Z,{className:"text-destructive-foreground h-3 w-3"}),"user scope"===r?(0,a.jsx)(C.Z,{className:"h-3 w-3"}):"",n]},e)})}):(0,a.jsx)("span",{children:"Full access"})]})]})]}),g&&(0,a.jsxs)("span",{className:"text-muted-foreground truncate text-xs",title:null!=f?f:"none",children:["Currently ",null!=f?f:"none"]})]})]}),(0,a.jsxs)(Z.u,{children:[(0,a.jsx)(Z.aJ,{children:(0,a.jsx)(z.Z,{provider:t.secret_name,credentialsToUse:{[t.secret_type]:d},secretId:(null==x?void 0:x.secret_id)===d.secret_id?d.secret_id:void 0,secretType:t.secret_type,disabled:!x&&!g,declaration:o,scopesOverride:(0,S.G0)(null==x?void 0:x.scopes,c),onAuthSuccess:()=>l(m),children:x?"Reauthenticate":"Link"})}),!x&&!g&&(0,a.jsx)(Z._v,{className:"max-w-sm",children:"The flow is configured to use a specific credential that you do not have. If you are not the owner, please contact the flow owner to configure the flow to use default credentials."})]})]})};A.displayName="AuthRequiredCredentialRow";let M=(0,g.memo)(e=>{let{immediatePipelineEvaluationResult:t,immediateOnAuthSuccess:r,open:p,onOpenChange:C,children:I,declaration:T}=e,{userProfile:E,idTokenRef:P}=(0,y.H)(),{currentProject:D}=(0,j.d2)(),{data:Z,refetch:S}=(0,m.jL)({userProfile:E,idToken:P.current}),{data:z,refetch:M}=(0,m.jL)({userProfile:E,idToken:P.current,projectId:null==D?void 0:D.project_id},{skip:!(null==D?void 0:D.project_id)}),F=(0,s.TL)(),U=(0,s.CG)(l.X3),V=(0,s.CG)(l.iZ),O=(0,s.CG)(d.ts),L=(0,s.CG)(e=>(0,o.iP)(e,null!=O?O:"")),R=(0,s.CG)(o.L2),G=(0,s.CG)(o.cM),W=(0,s.CG)(n.HL),q=(0,s.CG)(i.SN.selectMCPDeclarationsMap),B=(0,s.CG)(u.b),H=(0,s.CG)(u.Gx),[J,K]=(0,b.P)({open:null!=p?p:H,onOpenChange:null!=C?C:e=>F((0,c.zD)(e))}),Y=null!=t?t:B;0===Object.keys(Y).length&&J&&K(!1);let X=async e=>{var t;let r=Z,a=z;e?r=(await S()).data:a=(await M()).data;let n=(0,k.qR)({operatorDeclarations:U,outdatedOperatorDeclarations:V,pipeline:null!==(t=null==L?void 0:L.pipeline)&&void 0!==t?t:[],flows:R,externalRequiredSecrets:G,gummies:W,mcpDeclarations:q}),s=(0,N.t)({pipelineRequiredSecrets:n,userSecretTypes:r||[],projectSecretTypes:a,projectId:null==D?void 0:D.project_id});F((0,c.yX)(s))};return(0,a.jsxs)(h.Vq,{open:J,onOpenChange:K,children:[I&&(0,a.jsx)(h.hg,{asChild:!0,children:I}),(0,a.jsxs)(h.cZ,{onOpenAutoFocus:e=>e.preventDefault(),children:[(0,a.jsxs)(h.a7,{children:[(0,a.jsxs)(h.fK,{children:[(0,a.jsx)(h.$N,{children:"Please link your accounts"}),(0,a.jsx)(h.Be,{children:"The following credentials need to be authenticated to run the flow:"})]}),Object.entries(Y).sort((e,t)=>{let[r]=e,[a]=t;return r.localeCompare(a)}).map((e,t)=>{let[n,s]=e,i=(0,w.Qm)(n),l=_.ZP.find(e=>e.secret_type===n);return l?(0,a.jsxs)(g.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x(),{alt:i,src:l.image_path,width:20,height:20}),(0,a.jsx)("h3",{className:"text-base font-semibold",children:i})]}),(0,a.jsx)("div",{className:"flex flex-col gap-2",children:[...s].sort((e,t)=>(e.credential.is_personal_credential?1:-1)*(e.credential.is_default?2:1)).map((e,t)=>(0,a.jsx)(A,{secretDeclaration:l,result:e,personalSecretTypes:Z,projectSecretTypes:z,projectId:null==D?void 0:D.project_id,onAuthSuccess:null!=r?r:X,declaration:T},"".concat(n,"-").concat(t)))})]}),t<Object.entries(Y).length-1&&(0,a.jsx)(v.Z,{})]},n):null})]}),(0,a.jsx)(h.cN,{children:(0,a.jsx)(h.hg,{children:(0,a.jsx)(f.zx,{variant:f.f1.OUTLINE,children:"Close"})})})]})]})});M.displayName="AuthRequiredDialog";var F=M},19079:function(e,t,r){"use strict";r.d(t,{$:function(){return o}});var a=r(85893);r(67294);var n=r(41664),s=r.n(n),i=r(18998),l=r(25294);function o(e){let{title:t,description:r,children:n,markHref:o,showSupportFooter:d=!0,className:c}=e;return(0,a.jsxs)("div",{className:(0,i.cn)("flex h-dvh w-full flex-grow flex-col items-center justify-center space-y-6 px-2 text-center",c),children:[(0,a.jsx)(l.Z,{size:96,className:"mx-auto",href:o}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-foreground mb-2 text-xl font-semibold",children:t}),(0,a.jsx)("p",{className:"text-muted-foreground text-sm text-pretty",children:r})]}),(0,a.jsx)("div",{className:"flex flex-row items-center gap-2",children:n}),d&&(0,a.jsx)("div",{className:"border-border border-t pt-4",children:(0,a.jsxs)("p",{className:"text-muted-foreground text-sm",children:["Need help? Email ",(0,a.jsx)(s(),{href:"mailto:support@gumloop.com",children:"support@gumloop.com"})]})})]})}},68262:function(e,t,r){"use strict";r.d(t,{RT:function(){return m},qT:function(){return g},sv:function(){return u}});var a=r(30036),n=r(86691),s=r(83691),i=r(25141),l=r(3192),o=r(15411),d=r(23229),c=r(60689);let u={time_based:"Schedule",incoming_email_gmail:"Incoming Email",incoming_file_gdrive:"Google Drive File Upload",incoming_message_slack:"Incoming Slack Message",incoming_message_teams:"Incoming Teams Message",incoming_record_airtable:"Airtable Record Creation",polling_record_airtable:"Airtable Record Creation or Update",polling_create_row_gsheets:"Google Sheets Row Creation",polling_create_or_update_row_gsheets:"Google Sheets Row Creation or Update",polling_hubspot_list:"HubSpot List Update",incoming_submission_typeform:"Typeform Submission",incoming_page_notion:"Notion Database Update",incoming_submission_gforms:"Google Form Submission",polling_page_notion:"Notion Database Update",polling_google_calendar:"Google Calendar Event",webhook:"Webhook",agent:"Agent",browser_extension:"Browser Extension",form:"Gumloop Interface",manual:"Manual",incoming_message_zendesk:"Zendesk Message",incoming_ticket_zendesk:"Zendesk Ticket",incoming_ticket_in_view_zendesk:"Zendesk Ticket in View",incoming_comment_in_view_zendesk:"Zendesk Comment in View",ticket_status_change_zendesk:"Zendesk Ticket Status Change",polling_incident_incident_io:"Incident.io Incident"},m={time_based:{background:"bg-indigo-100",border:"border-indigo-200",color:"text-indigo-600"},incoming_email_gmail:{background:"bg-accent",border:"border-accent-foreground/10",color:"text-accent-foreground"},incoming_file_gdrive:{background:"bg-blue-100",border:"border-blue-200",color:"text-blue-600"},incoming_message_slack:{background:"bg-red-100",border:"border-red-200",color:"text-red-700"},incoming_message_teams:{background:"bg-blue-100",border:"border-blue-200",color:"text-blue-700"},incoming_record_airtable:{background:"bg-muted",border:"border-border",color:"text-muted-foreground"},polling_record_airtable:{background:"bg-muted",border:"border-border",color:"text-muted-foreground"},incoming_page_notion:{background:"bg-muted",border:"border-border",color:"text-muted-foreground"},polling_page_notion:{background:"bg-muted",border:"border-border",color:"text-muted-foreground"},polling_google_calendar:{background:"bg-muted",border:"border-border",color:"text-muted-foreground"},polling_create_row_gsheets:{background:"bg-muted",border:"border-border",color:"text-muted-foreground"},polling_create_or_update_row_gsheets:{background:"bg-muted",border:"border-border",color:"text-muted-foreground"},incoming_submission_typeform:{background:"bg-muted",border:"border-border",color:"text-muted-foreground"},incoming_submission_gforms:{background:"bg-muted",border:"border-border",color:"text-muted-foreground"},webhook:{background:"bg-accent",border:"border-accent-foreground/10",color:"text-accent-foreground"},agent:{background:"bg-purple-100",border:"border-purple-200",color:"text-purple-500"},browser_extension:{background:"bg-teal-100",border:"border-teal-200",color:"text-teal-600"},form:{background:"bg-pink-100",border:"border-pink-200",color:"text-pink-600"},manual:{background:"bg-muted",border:"border-border",color:"text-muted-foreground"},polling_hubspot_list:{background:"bg-muted",border:"border-border",color:"text-muted-foreground"},incoming_message_zendesk:{background:"bg-muted",border:"border-border",color:"text-muted-foreground"},incoming_ticket_zendesk:{background:"bg-green-100",border:"border-green-200",color:"text-green-700"},ticket_status_change_zendesk:{background:"bg-green-100",border:"border-green-200",color:"text-green-700"},incoming_ticket_in_view_zendesk:{background:"bg-green-100",border:"border-green-200",color:"text-green-700"},incoming_comment_in_view_zendesk:{background:"bg-green-100",border:"border-green-200",color:"text-green-700"},polling_incident_incident_io:{background:"bg-amber-100",border:"border-amber-200",color:"text-amber-700"}};t.ZP=u;let g={time_based:{type:"Icon",Icon:a.Z},incoming_email_gmail:{type:"Icon",Icon:n.Z},incoming_file_gdrive:{type:"Icon",Icon:s.Z},incoming_message_slack:{type:"Image",image:"/images/slack.png"},incoming_message_teams:{type:"Image",image:"/images/teams.png"},incoming_record_airtable:{type:"Image",image:"/images/airtable_trigger.png"},polling_record_airtable:{type:"Image",image:"/images/airtable_trigger.png"},polling_hubspot_list:{type:"Image",image:"/images/hubspot.png"},incoming_page_notion:{type:"Image",image:"/images/notion.png"},polling_page_notion:{type:"Image",image:"/images/notion.png"},polling_google_calendar:{type:"Image",image:"/images/gcalendar.png"},polling_create_row_gsheets:{type:"Image",image:"/images/gsheets.png"},polling_create_or_update_row_gsheets:{type:"Image",image:"/images/gsheets.png"},incoming_submission_typeform:{type:"Image",image:"/images/typeform.png"},incoming_submission_gforms:{type:"Image",image:"/images/gforms.png"},incoming_message_zendesk:{type:"Image",image:"/images/zendesk.png"},incoming_ticket_zendesk:{type:"Image",image:"/images/zendesk.png"},ticket_status_change_zendesk:{type:"Image",image:"/images/zendesk.png"},incoming_ticket_in_view_zendesk:{type:"Image",image:"/images/zendesk.png"},incoming_comment_in_view_zendesk:{type:"Image",image:"/images/zendesk.png"},polling_incident_incident_io:{type:"Image",image:"/images/incident.png"},webhook:{type:"Icon",Icon:i.Z},agent:{type:"Icon",Icon:l.Z},browser_extension:{type:"Icon",Icon:o.Z},form:{type:"Icon",Icon:d.Z},manual:{type:"Icon",Icon:c.Z}}},73063:function(e,t,r){"use strict";var a=r(71613);t.Z=()=>{let e=(0,a.y)("flow-subscriptions-v0");return null!=e&&e}},62496:function(e,t,r){"use strict";r.d(t,{TV:function(){return n}});var a=r(67294);let n=e=>({..."dark"===e?{grey:{100:"#e0e0e0",200:"#c2c2c2",300:"#a3a3a3",400:"#858585",500:"#666666",600:"#525252",700:"#3d3d3d",800:"#292929",900:"#141414"},primary:{100:"#d0d1d5",200:"#a1a4ab",300:"#727681",400:"#181b20",500:"#0e1116",600:"#101624",700:"#0c101b",800:"#080b12",850:"#040508",900:"#040509"},greenAccent:{100:"#dbf5ee",200:"#b7ebde",300:"#94e2cd",400:"#70d8bd",500:"#4cceac",600:"#3da58a",700:"#2e7c67",800:"#1e5245",900:"#0f2922"},pinkAccent:{100:"#ffe0e9",200:"#ffb3c2",300:"#ff809a",400:"#ff4d72",500:"#ff1a4a",600:"#cc0038",700:"#99002a",800:"#66001c",900:"#33000e"},redAccent:{100:"#f8dcdb",200:"#f1b9b7",300:"#e99592",400:"#e2726e",500:"#db4f4a",600:"#af3f3b",700:"#832f2c",800:"#58201e",900:"#2c100f"},blueAccent:{100:"#e1e2fe",200:"#c3c6fd",300:"#a4a9fc",400:"#868dfb",500:"#8490f2",600:"#535ac8",700:"#3e4396",800:"#2a2d64",900:"#181b20"},yellowAccent:{100:"#FFFAA0"}}:{grey:{100:"#141414",200:"#292929",300:"#3d3d3d",400:"#525252",500:"#666666",600:"#858585",700:"#a3a3a3",800:"#c2c2c2",900:"#e0e0e0"},primary:{100:"#040509",200:"#080b12",300:"#0c101b",400:"#ffffff",500:"#141b2d",600:"#434957",700:"#727681",800:"#a1a4ab",850:"#c2c2c2",900:"#f6f8fa"},greenAccent:{100:"#0f2922",200:"#1e5245",300:"#2e7c67",400:"#3da58a",500:"#4cceac",600:"#70d8bd",700:"#94e2cd",800:"#b7ebde",900:"#dbf5ee"},pinkAccent:{100:"#ffe0e9",200:"#ffb3c2",300:"#ff809a",400:"#ff4d72",500:"#ff1a4a",600:"#cc0038",700:"#99002a",800:"#66001c",900:"#33000e"},redAccent:{100:"#2c100f",200:"#58201e",300:"#832f2c",400:"#af3f3b",500:"#db4f4a",600:"#e2726e",700:"#e99592",800:"#f1b9b7",900:"#f8dcdb"},blueAccent:{100:"#151632",200:"#2a2d64",300:"#3e4396",400:"#535ac8",500:"#6870fa",600:"#868dfb",700:"#a4a9fc",800:"#c3c6fd",900:"#e1e2fe"},yellowAccent:{100:"#FFFAA0"}}});(0,a.createContext)({toggleColorMode:()=>{}})},70452:function(e,t,r){"use strict";r.d(t,{W:function(){return i}});var a=r(85893),n=r(4496),s=r(18998);let i=function(e,t,r){let i,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4?arguments[4]:void 0,d=e.display_name||e.name;return i=(i=(null!=(i=t?d.split("-")[0]:d)?i:"").replace(/_/g," ")).charAt(0).toUpperCase()+i.slice(1),(0,a.jsxs)("div",{className:(0,s.cn)("flex items-center gap-x-2","boolean"!==e.data_type&&"pb-1",o),children:[!l.includes(e.data_type)&&(0,a.jsxs)("label",{className:(0,s.cn)(r?"text-sm":"text-md",!t&&!r&&"font-semibold"),children:[i,t&&":"]}),e.description&&(0,a.jsx)(n.Z,{description:e.description})]})}},16538:function(e,t,r){"use strict";r.d(t,{bb:function(){return l}});var a=r(91036),n=r.n(a);let s=["p","br","strong","em","u","s","h1","h2","h3","h4","h5","h6","ul","ol","li","a","blockquote","code","pre"],i={a:["href","target","rel"]};function l(e){return n()(e,{allowedTags:s,allowedAttributes:i,allowedSchemes:["http","https","mailto"]})}},75347:function(){},31777:function(){},34017:function(){},59905:function(){}}]);